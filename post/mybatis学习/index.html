<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-180310890-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-180310890-1');
</script>

  <meta charset="UTF-8">
  <title>MyBatiså­¦ä¹  - ä»£ç L</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="ä¸€ã€MyBatisç®€ä»‹ 0ã€MyBatiså®˜æ–¹ä¸­æ–‡æ–‡æ¡£ 1ã€MyBatis å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’ æŒä¹…åŒ–å±‚æ¡†æ¶ï¼ˆSQLæ˜ å°„æ¡†æ¶ï¼‰ åŠè‡ªåŠ¨æ¡†æ¶ å‰èº«æ˜¯iBat">
  
  <meta itemprop="name" content="MyBatiså­¦ä¹  - ä»£ç L">
  <meta itemprop="description" content="ä¸€ã€MyBatisç®€ä»‹ 0ã€MyBatiså®˜æ–¹ä¸­æ–‡æ–‡æ¡£ 1ã€MyBatis å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’ æŒä¹…åŒ–å±‚æ¡†æ¶ï¼ˆSQLæ˜ å°„æ¡†æ¶ï¼‰ åŠè‡ªåŠ¨æ¡†æ¶ å‰èº«æ˜¯iBat">
  <meta itemprop="image" content="https://qianlong98.github.io/img/author.jpg">
  
  
  <meta name="twitter:description" content="">
  
  <link rel="shortcut icon" href="https://qianlong98.github.io/img/favicon.ico"/>
  <link rel="apple-touch-icon" href="https://qianlong98.github.io/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="https://qianlong98.github.io/apple-touch-icon.png" />
  <link rel="stylesheet" href="https://qianlong98.github.io/highlight/styles/github.css">
  <script src="https://qianlong98.github.io/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  <link rel="stylesheet" href="https://qianlong98.github.io/font/hack/css/hack.min.css">
  <link rel="stylesheet" href="https://qianlong98.github.io/css/style.css">
</head>

<body>
  <header>
    <div>
  <div id="imglogo">
    <a href="https://qianlong98.github.io/"><img src='https://qianlong98.github.io/img/logo.svg' alt="ä»£ç L" title="ä»£ç L"/></a>
  </div>
  <div id="textlogo">
    <h1 class="site-name"><a href="https://qianlong98.github.io/" title="ä»£ç L">ä»£ç L</a></h1>
    <h2 class="blog-motto">ä¸€ä¸ªå‹‡æ•¢çš„å¿«ä¹boy</h2>
  </div>
  <div class="navbar"><a class="navbutton navmobile" href="#" title="menu"></a></div>
  <nav class="animated">
    <ul>
      
      
      <li><a href="/">é¦–é¡µ</a></li>
      
      <li><a href="/about">å…³äº</a></li>
      
      
      <li>
        <form class="search" method="get" action="https://www.google.com/search">
          <div>
            <input type="text" id="search" name="q" placeholder='æœç´¢'>
          </div>
        </form>
      </li>
    </ul>
  </nav>
</div>

  </header>
  <div id="container">
    <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody">
    <header class="article-info clearfix">
  <h1 itemprop="name">
      <a href="https://qianlong98.github.io/post/mybatis%E5%AD%A6%E4%B9%A0/" title="MyBatiså­¦ä¹ " itemprop="url">MyBatiså­¦ä¹ </a>
  </h1>
  <p class="article-author">By
    
      <a href="https://qianlong98.github.io/post/" title="è¤ç«">è¤ç«</a>
    
  </p>
  <p class="article-time">
    <time datetime="2020-12-09 16:00:25 &#43;0800 CST" itemprop="datePublished">2020å¹´12æœˆ09æ—¥</time>
  </p>
</header>

	<div class="article-content">
    
    <hr>
<h1 id="ä¸€mybatisç®€ä»‹">ä¸€ã€MyBatisç®€ä»‹</h1>
<h2 id="0mybatiså®˜æ–¹ä¸­æ–‡æ–‡æ¡£httpsmybatisorgmybatis-3zhindexhtml"><a href="https://mybatis.org/mybatis-3/zh/index.html">0ã€MyBatiså®˜æ–¹ä¸­æ–‡æ–‡æ¡£</a></h2>
<h2 id="1mybatis">1ã€MyBatis</h2>
<ul>
<li>å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’</li>
<li>æŒä¹…åŒ–å±‚æ¡†æ¶ï¼ˆSQLæ˜ å°„æ¡†æ¶ï¼‰</li>
<li>åŠè‡ªåŠ¨æ¡†æ¶</li>
<li>å‰èº«æ˜¯<strong>iBatis</strong></li>
</ul>
<hr>
<h2 id="2æŒä¹…åŒ–å±‚æŠ€æœ¯">2ã€æŒä¹…åŒ–å±‚æŠ€æœ¯</h2>
<ul>
<li>åŸå§‹çš„JDBC&ndash;&gt;dbutilsï¼ˆQueryRunnerï¼‰&ndash;&gt;JdbcTemplate&ndash;&gt;ç­‰ç­‰</li>
</ul>
<p>ç§°ä¸º<strong>å·¥å…·</strong></p>
<ul>
<li>ä¸€äº›åŠŸèƒ½çš„ç®€å•å°è£…</li>
</ul>
<p><strong>æ¡†æ¶</strong></p>
<ul>
<li>æŸäº›é¢†åŸŸçš„æ•´ä½“è§£å†³æ–¹æ¡ˆ
<ul>
<li>è¦è€ƒè™‘<strong>ç¼“å­˜</strong>ï¼Œå¼‚å¸¸å¤„ç†é—®é¢˜ï¼Œéƒ¨åˆ†å­—æ®µæ˜ å°„é—®é¢˜ç­‰</li>
</ul>
</li>
</ul>
<hr>
<h3 id="ä¸ç”¨åŸç”ŸjdbcåŸå› ">ä¸ç”¨åŸç”ŸJDBCåŸå› </h3>
<ul>
<li>
<p>éº»çƒ¦ï¼ˆä½¿ç”¨æµç¨‹ï¼‰</p>
<p><img src="https://i.loli.net/2020/12/14/aFd2ImhOsgvEDGt.png" alt="image-20201214103213154"></p>
<hr>
</li>
<li>
<p><strong>sqlè¯­å¥æ˜¯ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­çš„</strong></p>
<ul>
<li>è€¦åˆï¼ˆæ•°æ®åº“å±‚å’Œjavaç¼–ç è€¦åˆï¼‰</li>
</ul>
</li>
</ul>
<hr>
<h2 id="3hibernate">3ã€Hibernate</h2>
<ul>
<li>æ•°æ®åº“åº“äº¤äº’çš„æ¡†æ¶ï¼ˆ<strong>ORM</strong>æ¡†æ¶ï¼‰
<ul>
<li><strong>ORM</strong>ï¼ˆObject Relation Mappingï¼‰å¯¹è±¡å…³ç³»æ˜ å°„</li>
<li>å…¨è‡ªåŠ¨çš„æ¡†æ¶</li>
</ul>
</li>
</ul>
<h3 id="1ä¼˜ç‚¹">1.ä¼˜ç‚¹</h3>
<ul>
<li>æ–¹ä¾¿</li>
</ul>
<p><img src="https://i.loli.net/2020/12/14/A6XJtGTwr8u3yxK.png" alt="image-20201214104326397"></p>
<hr>
<h3 id="2ç¼ºç‚¹">2.ç¼ºç‚¹</h3>
<ol>
<li>æ— æ³•å®šåˆ¶sqlï¼ˆäºŒå…«ç†è®ºï¼‰</li>
<li>è¦å­¦<strong>HQL</strong>ï¼ˆHibernate Query Languageï¼‰ï¼ˆåæ¨¡å¼ï¼‰</li>
<li>å…¨æ˜ å°„æ¡†æ¶ï¼ˆåšéƒ¨åˆ†å­—æ®µæ˜ å°„å¾ˆéš¾ï¼‰</li>
</ol>
<hr>
<p><strong>å¸Œæœ›</strong></p>
<ul>
<li>æœ€å¥½æœ‰ä¸€ä¸ªæ¡†æ¶
<ul>
<li>æ”¯æŒå®šåˆ¶åŒ–sql</li>
<li>åŠŸèƒ½å¼ºå¤§</li>
<li>sqlä¹Ÿä¸è¦ç¡¬ç¼–ç åœ¨javaæ–‡ä»¶ä¸­ï¼ˆå¯¼è‡´ç»´æŠ¤ä¿®æ”¹èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼‰</li>
</ul>
</li>
</ul>
<h2 id="4mybatisåº”è¿è€Œç”Ÿ">4ã€MyBatisåº”è¿è€Œç”Ÿ</h2>
<ol>
<li>
<p>MyBatiså°†é‡è¦çš„æ­¥éª¤æŠ½å–å‡ºæ¥å¯ä»¥äººå·¥å®šåˆ¶ï¼Œå…¶ä»–æ­¥éª¤è‡ªåŠ¨åŒ–</p>
<p><img src="https://i.loli.net/2020/12/14/lLSeVmBpXkYsPTU.png" alt="image-20201214110226659"></p>
<hr>
</li>
<li>
<p>é‡è¦æ­¥éª¤éƒ½æ˜¯å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼ˆå¥½ç»´æŠ¤ï¼‰</p>
</li>
<li>
<p>å®Œå…¨è§£å†³æ•°æ®åº“çš„ä¼˜åŒ–é—®é¢˜</p>
</li>
<li>
<p><strong>MyBatis</strong>åº•å±‚å°±æ˜¯å¯¹åŸç”Ÿ<strong>JDBC</strong>çš„ä¸€ä¸ªç®€å•å°è£…</p>
</li>
<li>
<p>æ—¢å°†javaç¼–ç ä¸sqlæŠ½å–äº†å‡ºæ¥ï¼Œè¿˜ä¸ä¼šå¤±å»è‡ªåŠ¨åŒ–åŠŸèƒ½ï¼ˆ<strong>åŠè‡ªåŠ¨åŒ–çš„æŒä¹…åŒ–å±‚æ¡†æ¶</strong>ï¼‰</p>
</li>
<li>
<p><strong>mybatis</strong>æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ¡†æ¶</p>
</li>
</ol>
<hr>
<h1 id="äºŒhelloworld">äºŒã€HelloWorld</h1>
<h2 id="1ç¯å¢ƒæ­å»º">1ã€ç¯å¢ƒæ­å»º</h2>
<h3 id="1åˆ›å»ºä¸€ä¸ªjavaå·¥ç¨‹">1.åˆ›å»ºä¸€ä¸ªjavaå·¥ç¨‹</h3>
<h3 id="2åˆ›å»ºæµ‹è¯•åº“">2.åˆ›å»ºæµ‹è¯•åº“</h3>
<ul>
<li>æµ‹è¯•è¡¨ï¼Œå°è£…æ•°æ®çš„javaBeanå’Œæ“ä½œæ•°æ®åº“çš„daoæ¥å£</li>
</ul>
<h3 id="3ç”¨mybatisæ“ä½œæ•°æ®åº“">3.ç”¨MyBatisæ“ä½œæ•°æ®åº“</h3>
<h4 id="1å¯¼åŒ…å»ºè®®å¯¼å…¥æ—¥å¿—åŒ…">1ã€å¯¼åŒ…ï¼ˆå»ºè®®å¯¼å…¥æ—¥å¿—åŒ…ï¼‰</h4>
<blockquote>
<p>mybatis-3.5.6.jar</p>
<p>mysql-connector-java-8.0.22.jar</p>
<p>log4j-1.2.17.jarï¼ˆå¯é€‰ï¼‰</p>
</blockquote>
<ul>
<li>log4jï¼ˆæ—¥å¿—æ¡†æ¶ï¼‰ï¼šä¾èµ–ç±»è·¯å¾„ä¸‹ä¸€ä¸ªlog4j.xmlé…ç½®æ–‡ä»¶</li>
</ul>
<hr>
<h4 id="2å†™é…ç½®">2ã€å†™é…ç½®</h4>
<ol>
<li>
<p>ç¬¬ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆ==å…¨å±€é…ç½®æ–‡ä»¶==ï¼‰ï¼ˆ<strong>mybatis-config.xml</strong>ï¼‰</p>
<ul>
<li>==æŒ‡å¯¼mybatis==æ­£ç¡®==è¿è¡Œ==çš„ä¸€äº›å…¨å±€è®¾ç½®ï¼ˆæ¯”å¦‚è¿æ¥å“ªä¸ªæ•°æ®åº“ï¼‰</li>
</ul>
</li>
<li>
<p>ç¬¬äºŒä¸ªé…ç½®æ–‡ä»¶ï¼ˆ==SQLæ˜ å°„æ–‡ä»¶==ï¼‰ï¼ˆ<strong>EmployeeDao.xml</strong>ï¼‰</p>
<ul>
<li>
<p>ç¼–å†™æ¯ä¸€ä¸ªæ–¹æ³•å¦‚ä½•å‘æ•°æ®åº“å‘é€sqlè¯­å¥ï¼Œå¦‚ä½•æ‰§è¡Œï¼ˆç›¸å½“äº==å¯¹Daoæ¥å£çš„ä¸€ä¸ªå®ç°æè¿°==ï¼‰</p>
<ol>
<li>
<p>å°†<strong>mapper</strong>çš„<strong>namespace</strong>å±æ€§æ”¹ä¸ºæ¥å£çš„å…¨ç±»å</p>
</li>
<li>
<p>é…ç½®ç»†èŠ‚</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- namespaceï¼šåç§°ç©ºé—´ï¼Œå†™æ¥å£çš„å…¨ç±»åï¼›ç›¸å½“äºå‘Šè¯‰MyBatisè¿™ä¸ªé…ç½®æ–‡ä»¶æ˜¯å®ç°å“ªä¸ªæ¥å£çš„ --&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
        
    <span class="c">&lt;!-- public Employee getEmpById(Integer id); --&gt;</span>
    <span class="c">&lt;!-- selectï¼šç”¨æ¥å®šä¹‰ä¸€ä¸ªæŸ¥è¯¢æ“ä½œï¼›
</span><span class="c">    idï¼šæ–¹æ³•åï¼Œç›¸å½“äºè¿™ä¸ªé…ç½®æ˜¯å¯¹äºæŸä¸ªæ–¹æ³•çš„å®ç°
</span><span class="c">    resultTypeï¼šæŒ‡å®šæ–¹æ³•è¿è¡Œåçš„è¿”å›å€¼ç±»å‹ï¼ˆæŸ¥è¯¢æ“ä½œå¿…é¡»æŒ‡å®šçš„ï¼‰
</span><span class="c">    #{å±æ€§å}ï¼šä»£è¡¨å–å‡ºä¼ é€’è¿‡æ¥çš„æŸä¸ªå‚æ•°çš„å€¼
</span><span class="c">     --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
    select * from employee where id = #{id}
  <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div></li>
<li>
<p>æˆ‘ä»¬å†™çš„daoæ¥å£çš„å®ç°æ–‡ä»¶ï¼Œmybatisé»˜è®¤æ˜¯ä¸çŸ¥é“çš„ï¼Œéœ€è¦<strong>åœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- å¼•å…¥æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„æ¯ä¸€ä¸ªæ¥å£çš„å®ç°æ–‡ä»¶ --&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
    <span class="c">&lt;!-- resourceï¼šè¡¨ç¤ºä»ç±»è·¯å¾„ä¸‹æ‰¾èµ„æº --&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;mybatis/EmployeeDao.xml&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></div></li>
</ol>
</li>
</ul>
</li>
</ol>
<hr>
<h4 id="3æµ‹è¯•">3ã€æµ‹è¯•</h4>
<ol>
<li>
<p>æ ¹æ®å…¨å±€é…ç½®æ–‡ä»¶å…ˆåˆ›å»ºä¸€ä¸ª<strong>SqlSessionFactory</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//1ã€æ ¹æ®å…¨å±€é…ç½®æ–‡ä»¶åˆ›å»ºå‡ºä¸€ä¸ªSqlSessionFactory
</span><span class="c1">//SqlSessionFactoryï¼šæ˜¯SqlSessionå·¥å‚ï¼Œè´Ÿè´£åˆ›å»ºSqlSessionå¯¹è±¡
</span><span class="c1">//SqlSessionï¼šsqlä¼šè¯ï¼ˆä»£è¡¨å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯ï¼‰
</span><span class="c1"></span><span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
</code></pre></div><hr>
</li>
<li>
<p><strong>sqlSessionFactory</strong>ä¸­è·å–<strong>sqlSession</strong>å¯¹è±¡æ“ä½œæ•°æ®åº“å³å¯</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//2ã€è·å–å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯ï¼šgetConnection();
</span><span class="c1"></span><span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
<span class="c1">//3ã€ä½¿ç”¨SqlSessionæ“ä½œæ•°æ®åº“ï¼Œå…ˆè·å–åˆ°daoæ¥å£çš„å®ç°
</span><span class="c1"></span><span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">//4ã€è°ƒç”¨ä¹‹å‰çš„æ–¹æ³•
</span><span class="c1"></span><span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
</code></pre></div><hr>
</li>
<li>
<p>==æ³¨æ„==ï¼šæµ‹è¯•å¯èƒ½ä¼šå‡ºç°æ—¶åŒºé”™è¯¯ï¼Œæ˜¯æ•°æ®åº“ç‰ˆæœ¬çš„é—®é¢˜ï¼Œå¯å‚è€ƒ<a href="https://blog.csdn.net/iiiiiilikangshuai/article/details/98459941"><strong>è§£å†³åŠæ³•</strong></a></p>
</li>
</ol>
<hr>
<h3 id="4æ€»ä½“æ¶æ„">4ã€æ€»ä½“æ¶æ„ï¼š</h3>
<p><img src="https://i.loli.net/2020/12/20/Qjw3NxR6balyumO.png" alt="image-20201220213612329"></p>
<hr>
<h3 id="5mybatis-configxml">5ã€mybatis-config.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
      <span class="c">&lt;!-- é…ç½®è¿æ¥æ±  --&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/test?serverTimezone=UTC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  
  <span class="c">&lt;!-- å¼•å…¥æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„æ¯ä¸€ä¸ªæ¥å£çš„å®ç°æ–‡ä»¶ --&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
  	<span class="c">&lt;!-- resourceï¼šè¡¨ç¤ºä»ç±»è·¯å¾„ä¸‹æ‰¾èµ„æº --&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;mybatis/EmployeeDao.xml&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<h3 id="6log4jxml">6ã€log4j.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE log4j:configuration SYSTEM &#34;log4j.dtd&#34;&gt;</span>
 
<span class="nt">&lt;log4j:configuration</span> <span class="na">xmlns:log4j=</span><span class="s">&#34;http://jakarta.apache.org/log4j/&#34;</span><span class="nt">&gt;</span>
 
 <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">&#34;STDOUT&#34;</span> <span class="na">class=</span><span class="s">&#34;org.apache.log4j.ConsoleAppender&#34;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;Encoding&#34;</span> <span class="na">value=</span><span class="s">&#34;UTF-8&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">&#34;org.apache.log4j.PatternLayout&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;ConversionPattern&#34;</span> <span class="na">value=</span><span class="s">&#34;%-5p %d{MM-dd HH:mm:ss,SSS} %m  (%F:%L) \n&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/layout&gt;</span>
 <span class="nt">&lt;/appender&gt;</span>
 <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&#34;java.sql&#34;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&#34;debug&#34;</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/logger&gt;</span>
 <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&#34;org.apache.ibatis&#34;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&#34;info&#34;</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/logger&gt;</span>
 <span class="nt">&lt;root&gt;</span>
   <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&#34;debug&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&#34;STDOUT&#34;</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/log4j:configuration&gt;</span>
</code></pre></div><hr>
<h3 id="7employeedaoxml">7ã€EmployeeDao.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="c">&lt;!-- namespaceï¼šåç§°ç©ºé—´ï¼Œå†™æ¥å£çš„å…¨ç±»åï¼›ç›¸å½“äºå‘Šè¯‰MyBatisè¿™ä¸ªé…ç½®æ–‡ä»¶æ˜¯å®ç°å“ªä¸ªæ¥å£çš„ --&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>

	<span class="c">&lt;!-- public Employee getEmpById(Integer id); --&gt;</span>
	<span class="c">&lt;!-- selectï¼šç”¨æ¥å®šä¹‰ä¸€ä¸ªæŸ¥è¯¢æ“ä½œï¼›
</span><span class="c">	idï¼šæ–¹æ³•åï¼Œç›¸å½“äºè¿™ä¸ªé…ç½®æ˜¯å¯¹äºæŸä¸ªæ–¹æ³•çš„å®ç°
</span><span class="c">	resultTypeï¼šæŒ‡å®šæ–¹æ³•è¿è¡Œåçš„è¿”å›å€¼ç±»å‹ï¼ˆæŸ¥è¯¢æ“ä½œå¿…é¡»æŒ‡å®šçš„ï¼‰
</span><span class="c">	#{å±æ€§å}ï¼šä»£è¡¨å–å‡ºä¼ é€’è¿‡æ¥çš„æŸä¸ªå‚æ•°çš„å€¼
</span><span class="c">	 --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
    select * from employee where emp_id = #{emp_id}
  <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h3 id="8mybatistestjava">8ã€MyBatisTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisTest</span> <span class="o">{</span>

	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
		<span class="c1">//1ã€æ ¹æ®å…¨å±€é…ç½®æ–‡ä»¶åˆ›å»ºå‡ºä¸€ä¸ªSqlSessionFactory
</span><span class="c1"></span>		<span class="c1">//SqlSessionFactoryï¼šæ˜¯SqlSessionå·¥å‚ï¼Œè´Ÿè´£åˆ›å»ºSqlSessionå¯¹è±¡
</span><span class="c1"></span>		<span class="c1">//SqlSessionï¼šsqlä¼šè¯ï¼ˆä»£è¡¨å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯ï¼‰
</span><span class="c1"></span>		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
		
		<span class="c1">//4ã€è°ƒç”¨ä¹‹å‰çš„æ–¹æ³•
</span><span class="c1"></span>		<span class="n">Employee</span> <span class="n">employee</span><span class="o">;</span>
		<span class="c1">//2ã€è·å–å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯ï¼šgetConnection();
</span><span class="c1"></span>		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			
			<span class="c1">//3ã€ä½¿ç”¨SqlSessionæ“ä½œæ•°æ®åº“ï¼Œå…ˆè·å–åˆ°daoæ¥å£çš„å®ç°
</span><span class="c1"></span>			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">employee</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
		
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div><hr>
<h3 id="9employeedaojava">9ã€EmployeeDao.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDao</span> <span class="o">{</span>

	<span class="c1">//æ•°æ®åº“é©±åŠ¨
</span><span class="c1"></span>	<span class="c1">//mysql-connector-java-8.0.22.jar
</span><span class="c1"></span>	<span class="c1">//mybatis-3.5.6.jar
</span><span class="c1"></span>	<span class="c1">//log4j-1.2.17.jar
</span><span class="c1"></span>	<span class="c1">//æŒ‰ç…§å‘˜å·¥idæŸ¥è¯¢å‘˜å·¥
</span><span class="c1"></span>	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="10employeejava">10ã€Employee.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">emp_id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">emp_name</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">emp_email</span><span class="o">;</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getEmp_id</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_id</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_id</span> <span class="o">=</span> <span class="n">emp_id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmp_name</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_name</span><span class="o">(</span><span class="n">String</span> <span class="n">emp_name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_name</span> <span class="o">=</span> <span class="n">emp_name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getEmp_gender</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_gender</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_gender</span> <span class="o">=</span> <span class="n">emp_gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmp_email</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_email</span><span class="o">(</span><span class="n">String</span> <span class="n">emp_email</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_email</span> <span class="o">=</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Employee [emp_id=&#34;</span> <span class="o">+</span> <span class="n">emp_id</span> <span class="o">+</span> <span class="s">&#34;, emp_name=&#34;</span> <span class="o">+</span> <span class="n">emp_name</span> <span class="o">+</span> <span class="s">&#34;, emp_gender=&#34;</span> <span class="o">+</span> <span class="n">emp_gender</span> <span class="o">+</span> <span class="s">&#34;, emp_email=&#34;</span>
				<span class="o">+</span> <span class="n">emp_email</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>

	
<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h2 id="2å¦‚ä½•å†™xmlæœ‰æç¤º">2ã€å¦‚ä½•å†™xmlæœ‰æç¤º</h2>
<h3 id="è®©eclipseæ‰¾åˆ°dtdçº¦æŸæ–‡ä»¶çš„ä½ç½®">è®©eclipseæ‰¾åˆ°dtdçº¦æŸæ–‡ä»¶çš„ä½ç½®</h3>
<ul>
<li>
<p><strong>dtdçº¦æŸæ–‡ä»¶</strong>ï¼ˆ<strong>mybatis</strong> jaråŒ…ä¸­è§£å‹å¤åˆ¶å‡ºæ¥ï¼‰</p>
<p><img src="https://i.loli.net/2020/12/20/yGVek4PUXaZ5mDq.png" alt="image-20201220212420081"></p>
<hr>
</li>
<li>
<p><strong>ç»‘å®šçº¦æŸæ–‡ä»¶çš„ä½ç½®</strong></p>
</li>
</ul>
<ol>
<li>å¤åˆ¶dtdçš„å¼•ç”¨ç½‘å€
<ul>
<li><a href="http://mybatis.org/dtd/mybatis-3-config.dtd">http://mybatis.org/dtd/mybatis-3-config.dtd</a></li>
</ul>
</li>
<li>eclipseè¿›å…¥window&ndash;ã€‹perferences&ndash;ã€‹XML&ndash;ã€‹XML Catalog</li>
<li>ç‚¹å‡»Addï¼ŒLocationå†™dtdçº¦æŸæ–‡ä»¶çš„ä½ç½®ï¼ŒKey type é€‰URIï¼ŒKeyå¡«å¤åˆ¶çš„å¼•ç”¨ç½‘å€</li>
<li>ç‚¹å‡»ğŸ†—ï¼Œå®Œäº‹ã€‚</li>
</ol>
<hr>
<p><img src="https://i.loli.net/2020/12/15/bMcZ5zBxSg9luH3.png" alt="image-20201215084850196"></p>
<hr>
<h2 id="3ç»†èŠ‚">3ã€ç»†èŠ‚</h2>
<h3 id="1è·å–åˆ°çš„æ˜¯æ¥å£çš„ä»£ç†å¯¹è±¡">1.è·å–åˆ°çš„æ˜¯æ¥å£çš„ä»£ç†å¯¹è±¡</h3>
<ul>
<li>mybatisè‡ªåŠ¨åˆ›å»ºçš„</li>
</ul>
<h3 id="2sqlsessionfactoryå’Œsqlsession">2.SqlSessionFactoryå’ŒSqlSession</h3>
<ul>
<li>SqlSessionFactoryåˆ›å»ºSqlSessionå¯¹è±¡ï¼ŒFactoryåªnewä¸€æ¬¡å°±è¡Œ</li>
<li>SqlSessionç›¸å½“äºconnectionå’Œæ•°æ®åº“è¿›è¡Œäº¤äº’
<ul>
<li>å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯</li>
<li>åº”è¯¥åˆ›å»ºä¸€ä¸ªæ–°çš„sqlSession</li>
</ul>
</li>
</ul>
<hr>
<h1 id="ä¸‰å…¨å±€é…ç½®æ–‡ä»¶">ä¸‰ã€å…¨å±€é…ç½®æ–‡ä»¶</h1>
<h2 id="1mybatis-configxml5mybatis-configxml">1ã€<a href="#5%E3%80%81mybatis-config.xml">mybatis-config.xml</a></h2>
<h2 id="2é…ç½®æ–‡æ¡£çš„é¡¶å±‚ç»“æ„">2ã€é…ç½®æ–‡æ¡£çš„é¡¶å±‚ç»“æ„</h2>
<ul>
<li>
<p>configurationï¼ˆé…ç½®ï¼‰</p>
<ul>
<li>propertiesï¼ˆå±æ€§ï¼‰</li>
<li>settingsï¼ˆè®¾ç½®ï¼‰</li>
<li>typeAliasesï¼ˆç±»å‹åˆ«åï¼‰</li>
<li>typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</li>
<li>objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</li>
<li>pluginsï¼ˆæ’ä»¶ï¼‰</li>
<li>environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰
<ul>
<li>environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰
<ul>
<li>transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</li>
<li>dataSourceï¼ˆæ•°æ®æºï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰</li>
<li>mappersï¼ˆæ˜ å°„å™¨ï¼‰</li>
</ul>
</li>
<li>
<p><strong>å»ºè®®å‚è€ƒ<a href="https://mybatis.org/mybatis-3/zh/index.html">MyBatiså®˜æ–¹ä¸­æ–‡æ–‡æ¡£</a></strong></p>
</li>
</ul>
<hr>
<h2 id="3åŸç”Ÿjdbcæ‰§è¡Œsql">3ã€åŸç”Ÿjdbcæ‰§è¡Œsql</h2>
<ul>
<li>æˆ–è€…å°è£…ç»“æœé›†</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">dataSource</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>

<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into employee(emp_name,emp_email,emp_gender) values(?,?,?)&#34;</span><span class="o">;</span>

<span class="n">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
<span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">0</span><span class="o">,</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
<span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="s">&#34;aaa@qq.com&#34;</span><span class="o">);</span>
<span class="n">ps</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">2</span><span class="o">,</span><span class="n">1</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
<span class="c1">//ps.close();connection.close();
</span><span class="c1"></span>
</code></pre></div><hr>
<h2 id="4å¢åˆ æ”¹æŸ¥æµ‹è¯•">4ã€å¢åˆ æ”¹æŸ¥æµ‹è¯•</h2>
<h3 id="1employeedaojava">1.EmployeeDao.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDao</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">updateEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">deleteEmployee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">insertEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="2employeedaoxml">2.EmployeeDao.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- public Employee getEmpById(Integer emp_id);å‚æ•°ç±»å‹ä¸ç”¨å†™ --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
  		<span class="c">&lt;!-- sqlè¯­å¥ä¸è¦å†™åˆ†å· --&gt;</span>
  		select * from employee where emp_id=#{emp_id}
  <span class="nt">&lt;/select&gt;</span>
  
<span class="c">&lt;!-- public int updateEmployee(Employee employee);
</span><span class="c">å¢åˆ æ”¹ä¸ç”¨å†™è¿”å›å€¼ç±»å‹ï¼›å¢åˆ æ”¹æ˜¯è¿”å›å½±å“å¤šå°‘è¡Œ
</span><span class="c">mybatisè‡ªåŠ¨åˆ¤æ–­ï¼Œå¦‚æœæ˜¯æ•°å­—ï¼ˆintï¼Œlongï¼‰
</span><span class="c">å¦‚æœæ˜¯booleanï¼ˆå½±å“0è¡Œè‡ªåŠ¨å°è£…falseï¼Œå¦åˆ™trueï¼‰
</span><span class="c">#{å±æ€§å}ï¼šä»ä¼ å…¥çš„å‚æ•°å¯¹è±¡ä¸­å–å‡ºå¯¹åº”å±æ€§çš„å€¼
</span><span class="c">--&gt;</span>
<span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateEmployee&#34;</span><span class="nt">&gt;</span>
	UPDATE employee 
	SET emp_name=#{emp_name},emp_gender=#{emp_gender},emp_email=#{emp_email} 
	WHERE emp_id=#{emp_id}
<span class="nt">&lt;/update&gt;</span>

<span class="c">&lt;!-- public int deleteEmployee(Integer emp_id); --&gt;</span>
<span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteEmployee&#34;</span><span class="nt">&gt;</span>
	DELETE FROM employee WHERE emp_id=#{emp_id}
<span class="nt">&lt;/delete&gt;</span>

<span class="c">&lt;!-- public int insertEmployee(Employee employee);--&gt;</span>
<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertEmployee&#34;</span><span class="nt">&gt;</span>
	INSERT INTO employee(emp_name,emp_gender,emp_email) 
	VALUES(#{emp_name},#{emp_gender},#{emp_email})
<span class="nt">&lt;/insert&gt;</span>

  <span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h3 id="3mybatiscrudtestjava">3.MyBatisCRUDTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisCRUDTest</span> <span class="o">{</span>
	
	<span class="c1">//å·¥å‚ä¸€ä¸ª
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
	
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="cm">/**
</span><span class="cm">	 * æµ‹è¯•æ·»åŠ 
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInsert</span><span class="o">(){</span>
		<span class="c1">//1ã€è·å–å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯
</span><span class="c1"></span>		<span class="c1">//trueï¼šä»£è¡¨è‡ªåŠ¨æäº¤
</span><span class="c1"></span>		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">//2ã€è·å–åˆ°æ¥å£çš„æ˜ å°„å™¨
</span><span class="c1"></span>			<span class="n">EmployeeDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="c1">//3ã€æµ‹è¯•
</span><span class="c1"></span>			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">insertEmployee</span><span class="o">(</span><span class="k">new</span> <span class="n">Employee</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&#34;tomcat&#34;</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="s">&#34;tomcat@qq.com&#34;</span><span class="o">));</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="c1">//æ‰‹åŠ¨æäº¤
</span><span class="c1"></span>			<span class="c1">//openSession.commit();
</span><span class="c1"></span>			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * æµ‹è¯•åˆ é™¤
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDelete</span><span class="o">(){</span>
		<span class="c1">//1ã€è·å–å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯
</span><span class="c1"></span>		<span class="c1">//trueï¼šä»£è¡¨è‡ªåŠ¨æäº¤
</span><span class="c1"></span>		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">//2ã€è·å–åˆ°æ¥å£çš„æ˜ å°„å™¨
</span><span class="c1"></span>			<span class="n">EmployeeDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="c1">//3ã€æµ‹è¯•
</span><span class="c1"></span>			<span class="n">mapper</span><span class="o">.</span><span class="na">deleteEmployee</span><span class="o">(</span><span class="n">4</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="c1">//æ‰‹åŠ¨æäº¤
</span><span class="c1"></span>			<span class="c1">//openSession.commit();
</span><span class="c1"></span>			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * æµ‹è¯•ä¿®æ”¹
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUpdate</span><span class="o">(){</span>
		<span class="c1">//1ã€è·å–å’Œæ•°æ®åº“çš„ä¸€æ¬¡ä¼šè¯
</span><span class="c1"></span>		<span class="c1">//trueï¼šä»£è¡¨è‡ªåŠ¨æäº¤
</span><span class="c1"></span>		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">//2ã€è·å–åˆ°æ¥å£çš„æ˜ å°„å™¨
</span><span class="c1"></span>			<span class="n">EmployeeDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="c1">//3ã€æµ‹è¯•
</span><span class="c1"></span>			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">updateEmployee</span><span class="o">(</span><span class="k">new</span> <span class="n">Employee</span><span class="o">(</span><span class="n">5</span><span class="o">,</span> <span class="s">&#34;tom&#34;</span><span class="o">,</span> <span class="n">1</span><span class="o">,</span> <span class="s">&#34;tom@qq.com&#34;</span><span class="o">));</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="c1">//æ‰‹åŠ¨æäº¤
</span><span class="c1"></span>			<span class="c1">//openSession.commit();
</span><span class="c1"></span>			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * æµ‹è¯•æŸ¥è¯¢
</span><span class="cm">	 * @throws IOException
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
		<span class="c1">//1ã€æ ¹æ®å…¨å±€é…ç½®æ–‡ä»¶å¾—åˆ°SqlSessionFactoryå¯¹è±¡
</span><span class="c1"></span>		<span class="c1">//initSqlSessionFactory();
</span><span class="c1"></span>		<span class="c1">//2ã€å¾—åˆ°SqlSessionå¯¹è±¡ï¼›
</span><span class="c1"></span>		
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		
		<span class="c1">//3ã€è·å–åˆ°daoæ¥å£çš„å®ç°ï¼ˆæ˜ å°„å™¨ï¼‰
</span><span class="c1"></span>		<span class="n">EmployeeDao</span> <span class="n">dao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="c1">//class com.sun.proxy.$Proxy7
</span><span class="c1"></span>		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dao</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="n">dao</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div><h2 id="5mybatis_configå·¥ç¨‹">5ã€MyBatis_configå·¥ç¨‹</h2>
<ul>
<li>==æ³¨è§£é…ç½®é…åˆä½¿ç”¨==ï¼ˆ<strong>é‡è¦çš„daoå†™é…ç½®ï¼Œç®€å•çš„daoå°±ç›´æ¥æ ‡æ³¨è§£</strong>ï¼‰</li>
</ul>
<h3 id="1æ€»ä½“æ¶æ„">1.æ€»ä½“æ¶æ„ï¼š</h3>
<p><img src="https://i.loli.net/2020/12/20/a5xiLHBC2YmftTR.png" alt="image-20201220225300510"></p>
<hr>
<h3 id="2mybatis-configxml">2.mybatis-config.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

<span class="c">&lt;!-- 1ã€å’ŒSpringçš„context:property-placeholderï¼ˆå¼•ç”¨é…ç½®æ–‡ä»¶ï¼‰ç›¸åŒ --&gt;</span>
	<span class="c">&lt;!-- 
</span><span class="c">	resourceï¼šä»ç±»è·¯å¾„ä¸‹å¼€å§‹å¼•ç”¨
</span><span class="c">	urlï¼šå¼•ç”¨ç£ç›˜è·¯å¾„æˆ–è€…ç½‘ç»œè·¯å¾„çš„èµ„æº
</span><span class="c"> 	--&gt;</span>
	<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;dbconfig.properties&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;org.apache.ibatis.parsing.PropertyParser.enable-default-value&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/properties&gt;</span>
	
	<span class="c">&lt;!-- 2ã€settingsæ˜¯ MyBatis ä¸­æä¸ºé‡è¦çš„è°ƒæ•´è®¾ç½®ï¼Œå®ƒä»¬ä¼šæ”¹å˜ MyBatis çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚  --&gt;</span>
	<span class="nt">&lt;settings&gt;</span>
		<span class="c">&lt;!-- nameï¼šé…ç½®é¡¹çš„keyï¼Œvalueï¼šé…ç½®é¡¹çš„å€¼ --&gt;</span>
		<span class="c">&lt;!-- loginAccount ==ã€‹login_account --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;mapUnderscoreToCamelCase&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/settings&gt;</span>
	
	<span class="c">&lt;!-- 3ã€ç±»å‹åˆ«å,ä¸ºå¸¸ç”¨çš„ç±»å‹ï¼ˆjavaBeanï¼‰èµ·åˆ«å --&gt;</span>
	<span class="nt">&lt;typeAliases&gt;</span>
		<span class="c">&lt;!-- typeAliasï¼šå°±æ˜¯ä¸ºä¸€ä¸ªJavaBeanèµ·åˆ«åï¼Œåˆ«åé»˜è®¤å°±æ˜¯ç±»åï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œé…ç½®æ–‡ä»¶ä¸­å°±å¯ä»¥ç”¨åˆ«åäº† --&gt;</span>
		<span class="c">&lt;!-- alias=&#34;&#34;ï¼šæŒ‡å®šä¸€ä¸ªåˆ«å --&gt;</span>
		<span class="c">&lt;!-- &lt;typeAlias type=&#34;com.lql.bean.Employee&#34; alias=&#34;emp&#34;/&gt; --&gt;</span>
		
		<span class="c">&lt;!-- æ‰¹é‡èµ·åˆ«å;name=&#34;&#34;æŒ‡å®šåŒ…åï¼Œé»˜è®¤åˆ«åå°±æ˜¯ç±»å --&gt;</span>
		<span class="c">&lt;!-- &lt;package name=&#34;com.lql.bean&#34;/&gt; --&gt;</span>
		<span class="c">&lt;!-- æˆ‘ä»¬æ¨èå°±ç”¨å…¨ç±»å --&gt;</span>
	<span class="nt">&lt;/typeAliases&gt;</span>
	
	<span class="c">&lt;!-- 4ã€ç±»å‹å¤„ç†å™¨ï¼Œä½œç”¨ï¼š --&gt;</span>
	<span class="c">&lt;!-- &lt;typeHandlers&gt;
</span><span class="c">		è‡ªå®šä¹‰å¥½çš„ç±»å‹å¤„ç†å™¨å°±è¿™ä¹ˆé…ç½®ä¸Šå°±è¡Œäº†
</span><span class="c">		&lt;typeHandler handler=&#34;&#34;/&gt;
</span><span class="c">	&lt;/typeHandlers&gt; --&gt;</span>
	
	<span class="c">&lt;!-- 5ã€æ’ä»¶æ˜¯mybatisä¸­çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½ --&gt;</span>

	<span class="c">&lt;!-- 6ã€environmentsé…ç½®ç¯å¢ƒâ€œä»¬â€
</span><span class="c">		environmentï¼šé…ç½®ä¸€ä¸ªå…·ä½“çš„ç¯å¢ƒï¼Œéƒ½éœ€è¦ä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨å’Œä¸€ä¸ªæ•°æ®æº
</span><span class="c">			transactionManger
</span><span class="c">		åæ¥çš„æ•°æ®æºå’Œäº‹åŠ¡ç®¡ç†éƒ½æ˜¯Springæ¥ç®¡ç†
</span><span class="c">	 --&gt;</span>
  <span class="c">&lt;!-- default=&#34;development&#34;ï¼šé»˜è®¤ä½¿ç”¨å“ªä¸ªç¯å¢ƒ --&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- id=&#34;testEnv&#34;æ˜¯å½“å‰ç¯å¢ƒçš„å”¯ä¸€æ ‡è¯† --&gt;</span>
  <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;testEnv&#34;</span><span class="nt">&gt;</span>
  	<span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;&#34;</span><span class="nt">/&gt;</span>
  	<span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;&#34;</span><span class="nt">&gt;</span>
  		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://47.110.152.31:3333/user_db&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbcurl}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
  	<span class="nt">&lt;/dataSource&gt;</span>
  <span class="nt">&lt;/environment&gt;</span>
  
  
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
      <span class="c">&lt;!-- é…ç½®è¿æ¥æ±  --&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
      	<span class="c">&lt;!-- ${}å–å‡ºé…ç½®æ–‡ä»¶ä¸­çš„å€¼ --&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driverclass}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbcurl}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username:root}&#34;</span><span class="nt">/&gt;</span><span class="c">&lt;!-- å¦‚æœå±æ€§ &#39;username&#39; æ²¡æœ‰è¢«é…ç½®ï¼Œ&#39;username&#39; å±æ€§çš„å€¼å°†ä¸º &#39;root&#39; --&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password:123456}&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  
  <span class="c">&lt;!-- 7ã€mybatisç”¨æ¥è€ƒè™‘æ•°æ®åº“ç§»æ¤æ€§çš„ --&gt;</span>
  <span class="nt">&lt;databaseIdProvider</span> <span class="na">type=</span><span class="s">&#34;DB_VENDOR&#34;</span><span class="nt">&gt;</span>
  	<span class="c">&lt;!-- name=&#34;&#34;ï¼šæ•°æ®åº“å‚å•†æ ‡è¯†ï¼›value=&#34;&#34;ï¼šç»™è¿™ä¸ªæ ‡è¯†èµ·ä¸€ä¸ªå¥½ç”¨çš„åå­—
</span><span class="c">  		MySQLã€Oracleã€SQL Server
</span><span class="c">  	 --&gt;</span>
  	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;MySQL&#34;</span> <span class="na">value=</span><span class="s">&#34;mysql&#34;</span><span class="nt">/&gt;</span>
  	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;SQL Server&#34;</span> <span class="na">value=</span><span class="s">&#34;sqlserver&#34;</span><span class="nt">/&gt;</span>
  	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;Oracle&#34;</span> <span class="na">value=</span><span class="s">&#34;oracle&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/databaseIdProvider&gt;</span>
  
  <span class="c">&lt;!-- 8ã€å†™å¥½çš„sqlæ˜ å°„æ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨mappersæ³¨å†Œè¿›æ¥ --&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
  	<span class="c">&lt;!-- 
</span><span class="c">  	urlï¼šå¯ä»¥ä»ç£ç›˜æˆ–è€…ç½‘ç»œè·¯å¾„å¼•ç”¨
</span><span class="c">  	resourceï¼šåœ¨ç±»è·¯å¾„ä¸‹æ‰¾sqlæ˜ å°„æ–‡ä»¶
</span><span class="c">  	classï¼šç›´æ¥å¼•ç”¨æ¥å£çš„å…¨ç±»å
</span><span class="c">  		å¯ä»¥å°†xmlæ”¾åœ¨å’Œdaoæ¥å£åŒç›®å½•ä¸‹ï¼Œè€Œä¸”æ–‡ä»¶åå’Œæ¥å£åä¸€è‡´ï¼›
</span><span class="c">  		classçš„å¦ä¸€ç§ç”¨æ³•
</span><span class="c">  	 --&gt;</span>
  	 
     <span class="c">&lt;!-- &lt;mapper class=&#34;com.lql.dao.EmployeeDao&#34;/&gt; --&gt;</span>
     <span class="c">&lt;!-- &lt;mapper class=&#34;com.lql.dao.EmployeeDaoAnnotation&#34;/&gt;
</span><span class="c">     &lt;mapper resource=&#34;mybatis/EmployeeDao.xml&#34;/&gt;  --&gt;</span>
     <span class="c">&lt;!-- é…åˆä½¿ç”¨ï¼šé‡è¦çš„daoå¯ä»¥å†™é…ç½®ï¼›
</span><span class="c">     	ç®€å•çš„daoå°±ç›´æ¥æ ‡æ³¨è§£ï¼›
</span><span class="c">      --&gt;</span>
      
      <span class="c">&lt;!-- æ‰¹é‡æ³¨å†Œ name=&#34;&#34;ï¼šdaoæ‰€åœ¨çš„åŒ…å --&gt;</span>
      <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<h3 id="3dbconfigproperties">3.dbconfig.properties</h3>
<pre><code class="language-properties" data-lang="properties">username=root
password=123456
jdbcurl=jdbc:mysql://localhost:3306/test?serverTimezone=UTC
driverclass=com.mysql.cj.jdbc.Driver
</code></pre><hr>
<p>4.EmployeeDao.xml</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- public Employee getEmpById(Integer emp_id);å‚æ•°ç±»å‹ä¸ç”¨å†™ --&gt;</span>
  <span class="c">&lt;!-- é»˜è®¤è¿™ä¸ªæŸ¥è¯¢æ˜¯ä¸åŒºåˆ†ç¯å¢ƒ --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
  		<span class="c">&lt;!-- sqlè¯­å¥ä¸è¦å†™åˆ†å· --&gt;</span>
  		select * from employee where emp_id=#{emp_id}
  <span class="nt">&lt;/select&gt;</span>
  
  <span class="c">&lt;!-- å¦‚æœèƒ½ç²¾ç¡®åŒ¹é…å°±ç²¾ç¡®ï¼Œä¸èƒ½å°±ç”¨æ¨¡ç³Šçš„ --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span> <span class="na">databaseId=</span><span class="s">&#34;mysql&#34;</span><span class="nt">&gt;</span>
  		<span class="c">&lt;!-- sqlè¯­å¥ä¸è¦å†™åˆ†å· --&gt;</span>
  		select * from employee where emp_id=#{emp_id}
  <span class="nt">&lt;/select&gt;</span>
  
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span> <span class="na">databaseId=</span><span class="s">&#34;oracle&#34;</span><span class="nt">&gt;</span>
  		<span class="c">&lt;!-- sqlè¯­å¥ä¸è¦å†™åˆ†å· --&gt;</span>
  		select * from employee where emp_id=#{emp_id}
  <span class="nt">&lt;/select&gt;</span>
  
<span class="c">&lt;!-- public int updateEmployee(Employee employee);
</span><span class="c">å¢åˆ æ”¹ä¸ç”¨å†™è¿”å›å€¼ç±»å‹ï¼›å¢åˆ æ”¹æ˜¯è¿”å›å½±å“å¤šå°‘è¡Œ
</span><span class="c">mybatisè‡ªåŠ¨åˆ¤æ–­ï¼Œå¦‚æœæ˜¯æ•°å­—ï¼ˆintï¼Œlongï¼‰
</span><span class="c">å¦‚æœæ˜¯booleanï¼ˆå½±å“0è¡Œè‡ªåŠ¨å°è£…falseï¼Œå¦åˆ™trueï¼‰
</span><span class="c">#{å±æ€§å}ï¼šä»ä¼ å…¥çš„å‚æ•°å¯¹è±¡ä¸­å–å‡ºå¯¹åº”å±æ€§çš„å€¼
</span><span class="c">--&gt;</span>
<span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateEmployee&#34;</span><span class="nt">&gt;</span>
	UPDATE employee 
	SET emp_name=#{emp_name},emp_gender=#{emp_gender},emp_email=#{emp_email}
	WHERE emp_id=#{emp_id}
<span class="nt">&lt;/update&gt;</span>

<span class="c">&lt;!-- public int deleteEmployee(Integer emp_id); --&gt;</span>
<span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteEmployee&#34;</span><span class="nt">&gt;</span>
	DELETE FROM employee WHERE emp_id=#{emp_id}
<span class="nt">&lt;/delete&gt;</span>

<span class="c">&lt;!-- public int insertEmployee(Employee employee);--&gt;</span>
<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertEmployee&#34;</span><span class="nt">&gt;</span>
	INSERT INTO employee(emp_name,emp_gender,emp_email) 
	VALUES(#{emp_name},#{emp_gender},#{emp_email})
<span class="nt">&lt;/insert&gt;</span>

  <span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h3 id="4mybatiscrudtestjava">4.MyBatisCRUDTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDaoAnnotation</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisCRUDTest</span> <span class="o">{</span>
	
	<span class="c1">//å·¥å‚ä¸€ä¸ª
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
	
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testAnnotation</span><span class="o">(){</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">EmployeeDaoAnnotation</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDaoAnnotation</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">Employee</span> <span class="n">empById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">5</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">empById</span><span class="o">);</span>
		
		<span class="n">EmployeeDao</span> <span class="n">mapper2</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mapper2</span><span class="o">);</span>
		<span class="n">Employee</span> <span class="n">empById2</span> <span class="o">=</span> <span class="n">mapper2</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">empById2</span><span class="o">);</span>
		
	<span class="o">}</span>
</code></pre></div><hr>
<h3 id="5employeedaoannotationjava">5.EmployeeDaoAnnotation.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Delete</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Insert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Select</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Update</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDaoAnnotation</span> <span class="o">{</span>

	<span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from employee where emp_id=#{emp_id}&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	
	<span class="nd">@Update</span><span class="o">(</span><span class="s">&#34;UPDATE employee &#34;</span>
			<span class="o">+</span> <span class="s">&#34;SET emp_name=#{emp_name},emp_gender=#{emp_gender},emp_email=#{emp_email}&#34;</span>
			<span class="o">+</span> <span class="s">&#34; WHERE emp_id=#{emp_id}&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">updateEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
	
	<span class="nd">@Delete</span><span class="o">(</span><span class="s">&#34;DELETE FROM employee WHERE emp_id=#{emp_id}&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">deleteEmployee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	
	<span class="nd">@Insert</span><span class="o">(</span><span class="s">&#34;INSERT INTO employee(emp_name,emp_gender,emp_email) &#34;</span>
			<span class="o">+</span> <span class="s">&#34;VALUES(#{emp_name},#{emp_gender},#{emp_email})&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">insertEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h1 id="å››sqlæ˜ å°„æ–‡ä»¶">å››ã€SQLæ˜ å°„æ–‡ä»¶</h1>
<ul>
<li>æ˜ å°„æ–‡ä»¶æŒ‡å¯¼ç€MyBatiså¦‚ä½•è¿›è¡Œæ•°æ®åº“å¢åˆ æ”¹æŸ¥ï¼Œæœ‰ç€éå¸¸é‡è¦çš„æ„ä¹‰</li>
</ul>
<h2 id="1å¢åˆ æ”¹å…ƒç´ ">1ã€å¢åˆ æ”¹å…ƒç´ </h2>
<p><img src="https://i.loli.net/2020/12/15/ya7GkVA6gHOSunt.png" alt="image-20201215161245376"></p>
<hr>
<h2 id="2å„ç§é…ç½®3mybatis_sqlmapper"><a href="#3%E3%80%81MyBatis_sqlMapper">2ã€å„ç§é…ç½®</a></h2>
<h2 id="3mybatis_sqlmapper">3ã€MyBatis_sqlMapper</h2>
<h3 id="1æ€»ä½“æ¶æ„-1">1.æ€»ä½“æ¶æ„ï¼š</h3>
<p><img src="https://i.loli.net/2020/12/21/qj9b1az4emXPvf5.png" alt="Snipaste_2020-12-21_08-45-46"></p>
<hr>
<h3 id="2bean">2.bean</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>

	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">gender</span><span class="o">;</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getGender</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGender</span><span class="o">(</span><span class="n">Integer</span> <span class="n">gender</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getAge</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">age</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAge</span><span class="o">(</span><span class="n">Integer</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Cat [id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34;, name=&#34;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#34;, age=&#34;</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span> <span class="s">&#34;, gender=&#34;</span> <span class="o">+</span> <span class="n">gender</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>
		
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.type.Alias</span><span class="o">;</span>

<span class="nd">@Alias</span><span class="o">(</span><span class="s">&#34;emp&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">emp_id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">emp_name</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">emp_email</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nf">Employee</span><span class="o">()</span> <span class="o">{</span>
		<span class="kd">super</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="nf">Employee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">,</span> <span class="n">String</span> <span class="n">emp_name</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">,</span> <span class="n">String</span> <span class="n">emp_email</span><span class="o">)</span> <span class="o">{</span>
		<span class="kd">super</span><span class="o">();</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_id</span> <span class="o">=</span> <span class="n">emp_id</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_name</span> <span class="o">=</span> <span class="n">emp_name</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_gender</span> <span class="o">=</span> <span class="n">emp_gender</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_email</span> <span class="o">=</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getEmp_id</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_id</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_id</span> <span class="o">=</span> <span class="n">emp_id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmp_name</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_name</span><span class="o">(</span><span class="n">String</span> <span class="n">emp_name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_name</span> <span class="o">=</span> <span class="n">emp_name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getEmp_gender</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_gender</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_gender</span> <span class="o">=</span> <span class="n">emp_gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmp_email</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_email</span><span class="o">(</span><span class="n">String</span> <span class="n">emp_email</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_email</span> <span class="o">=</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Employee [emp_id=&#34;</span> <span class="o">+</span> <span class="n">emp_id</span> <span class="o">+</span> <span class="s">&#34;, emp_name=&#34;</span> <span class="o">+</span> <span class="n">emp_name</span> <span class="o">+</span> <span class="s">&#34;, emp_gender=&#34;</span> <span class="o">+</span> <span class="n">emp_gender</span> <span class="o">+</span> <span class="s">&#34;, emp_email=&#34;</span>
				<span class="o">+</span> <span class="n">emp_email</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>
	
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * ğŸ”‘è¡¨
</span><span class="cm"> * @author é™†ä¹¾é¾™
</span><span class="cm"> *
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Key</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span><span class="c1">//é’¥åŒ™çš„id
</span><span class="c1"></span>	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">keyName</span><span class="o">;</span><span class="c1">//é’¥åŒ™å
</span><span class="c1"></span>	
	<span class="kd">private</span> <span class="n">Lock</span> <span class="n">lock</span><span class="o">;</span><span class="c1">//å½“å‰é’¥åŒ™èƒ½å¼€å“ªä¸ªé”
</span><span class="c1"></span>	
	

	<span class="kd">public</span> <span class="n">Lock</span> <span class="nf">getLock</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">lock</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLock</span><span class="o">(</span><span class="n">Lock</span> <span class="n">lock</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">lock</span> <span class="o">=</span> <span class="n">lock</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getKeyName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">keyName</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setKeyName</span><span class="o">(</span><span class="n">String</span> <span class="n">keyName</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">keyName</span> <span class="o">=</span> <span class="n">keyName</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Key [id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34;, keyName=&#34;</span> <span class="o">+</span> <span class="n">keyName</span> <span class="o">+</span> <span class="s">&#34;, lock=&#34;</span> <span class="o">+</span> <span class="n">lock</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>	
	
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * ğŸ”’è¡¨
</span><span class="cm"> * @author é™†ä¹¾é¾™
</span><span class="cm"> *
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Lock</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">lockName</span><span class="o">;</span>
	
	<span class="c1">//æŸ¥ğŸ”’çš„æ—¶å€™æŠŠæ‰€æœ‰çš„ğŸ”‘ä¹ŸæŸ¥å‡ºæ¥
</span><span class="c1"></span>	<span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span><span class="o">;</span>
	<span class="c1">//1-1å…³è”  1-nå…³è”  n-nå…³è”
</span><span class="c1"></span>	<span class="cm">/**
</span><span class="cm">	 * ä¸€ä¸ªkeyå¼€ä¸€æŠŠlockï¼š1-1
</span><span class="cm">	 * ä¸€ä¸ªlockæœ‰å¤šæŠŠkeyï¼š1-n
</span><span class="cm">	 * ä»keyè¡¨çœ‹lockï¼šn-1
</span><span class="cm">	 * 1-n,n-1,n-nï¼šå¤–é”®åº”è¯¥æ”¾åœ¨å“ªä¸ªè¡¨?
</span><span class="cm">	 * ä¸€å¯¹å¤šï¼šå¤–é”®ä¸€å®šæ”¾åœ¨å¤šçš„ä¸€ç«¯
</span><span class="cm">	 * å¤šå¯¹å¤šï¼šä¸­é—´è¡¨å­˜å‚¨å¯¹åº”å…³ç³»
</span><span class="cm">	 */</span>
	
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="nf">getKeys</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">keys</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setKeys</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">keys</span> <span class="o">=</span> <span class="n">keys</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getLockName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">lockName</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLockName</span><span class="o">(</span><span class="n">String</span> <span class="n">lockName</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">lockName</span> <span class="o">=</span> <span class="n">lockName</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Lock [id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34;, lockName=&#34;</span> <span class="o">+</span> <span class="n">lockName</span> <span class="o">+</span> <span class="s">&#34;, keys=&#34;</span> <span class="o">+</span> <span class="n">keys</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>
	
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="3dao">3.dao</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Cat</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CatDao</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="n">Cat</span> <span class="nf">getCatById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.MapKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDao</span> <span class="o">{</span>

	<span class="c1">//åˆ—åä½œä¸ºkeyï¼Œå€¼ä½œä¸ºvalue
</span><span class="c1"></span>	<span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getEmpByIdReturnMap</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="nf">getAllEmps</span><span class="o">();</span>
	
	<span class="cm">/**
</span><span class="cm">	 * keyå°±æ˜¯è¿™ä¸ªè®°å½•çš„ä¸»é”®ï¼Œvalueå°±æ˜¯è¿™æ¡è®°å½•å°è£…å¥½çš„å¯¹è±¡ï¼›
</span><span class="cm">	 * @return
</span><span class="cm">	 * 
</span><span class="cm">	 * æŠŠæŸ¥è¯¢çš„è®°å½•çš„idçš„å€¼ä½œä¸ºkeyå°è£…è¿™ä¸ªmap:
</span><span class="cm">	 * @MapKey(&#34;emp_id&#34;)
</span><span class="cm">	 */</span>
	<span class="nd">@MapKey</span><span class="o">(</span><span class="s">&#34;emp_id&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Employee</span><span class="o">&gt;</span> <span class="nf">getAllEmpsReturnMap</span><span class="o">();</span>
	
	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpByIdAndEmpName</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;emp_id&#34;</span><span class="o">)</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">,</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;emp_name&#34;</span><span class="o">)</span><span class="n">String</span> <span class="n">emp_name</span><span class="o">);</span>
	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpByIdAndEmpName1</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">updateEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">deleteEmployee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">insertEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">insertEmployee2</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Key</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">KeyDao</span> <span class="o">{</span>

	<span class="cm">/**
</span><span class="cm">	 * å°†ğŸ”‘å’ŒğŸ”’â„¹ä¸€èµ·æŸ¥å‡º
</span><span class="cm">	 * @param id
</span><span class="cm">	 * @return
</span><span class="cm">	 */</span>
	<span class="kd">public</span> <span class="n">Key</span> <span class="nf">getKeyById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">Key</span> <span class="nf">getKeyByIdSimple</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="nf">getKeysByLockId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Lock</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">LockDao</span> <span class="o">{</span>

	<span class="c1">//æŸ¥ğŸ”’çš„æ—¶å€™å°†æ‰€æœ‰ğŸ”‘ä¹ŸæŸ¥å‡ºæ¥
</span><span class="c1"></span>	<span class="kd">public</span> <span class="n">Lock</span> <span class="nf">getLockById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">Lock</span> <span class="nf">getLockByIdSimple</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">Lock</span> <span class="nf">getLockByIdByStep</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="4daoxml">4.dao.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span> CatDao.xml <span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span>

<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.CatDao&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!-- getCatById(Integer)
</span><span class="c">	resultType=&#34;com.lql.bean.Cat&#34;ï¼šä½¿ç”¨é»˜è®¤è§„åˆ™ï¼šå±æ€§åˆ—åä¸€ä¸€å¯¹åº”
</span><span class="c">	resultMap=&#34;mycat&#34;ï¼šæŸ¥å‡ºæ•°æ®å°è£…ç»“æœçš„æ—¶å€™ï¼Œä½¿ç”¨mycatè‡ªå®šä¹‰çš„è§„åˆ™
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getCatById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mycat&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- select id,cname name,cage age,cgender gender from t_cat where id=#{id}  --&gt;</span>
		select * from t_cat where id=#{id} 
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- è‡ªå®šä¹‰ç»“æœé›†ï¼šè‡ªå·±å®šä¹‰æ¯ä¸€åˆ—æ•°æ®å’ŒjavaBeançš„æ˜ å°„è§„åˆ™
</span><span class="c">	type=&#34;&#34;ï¼šæŒ‡å®šä¸ºå“ªä¸ªjavaBeanè‡ªå®šä¹‰å°è£…è§„åˆ™ï¼›å…¨ç±»å
</span><span class="c">	id=&#34;&#34;ï¼šå”¯ä¸€æ ‡è¯†ï¼Œè®©åˆ«ååœ¨åé¢å¼•ç”¨
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Cat&#34;</span> <span class="na">id=</span><span class="s">&#34;mycat&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- æŒ‡å®šä¸»é”®åˆ—çš„å¯¹åº”è§„åˆ™ï¼š
</span><span class="c">		column=&#34;id&#34;ï¼šæŒ‡å®šé‚£ä¸€åˆ—æ˜¯ä¸»é”®åˆ—
</span><span class="c">		property=&#34;&#34;ï¼šæŒ‡å®šcatçš„å“ªä¸ªå±æ€§å°è£…idè¿™ä¸€åˆ—æ•°æ®
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- æ™®é€šåˆ— --&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;cname&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;age&#34;</span> <span class="na">column=</span><span class="s">&#34;cage&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;gender&#34;</span> <span class="na">column=</span><span class="s">&#34;cgender&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>


<span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span> EmployeeDao.xml <span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span>

<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- namespace=&#34;com.lql.dao.EmployeeDao&#34;ï¼šå†™daoæ¥å£çš„å…¨ç±»å --&gt;</span>
<span class="c">&lt;!-- è¿™ä¸ªæ–‡ä»¶ä¸­èƒ½å†™çš„æ‰€æœ‰æ ‡ç­¾ï¼š
</span><span class="c">cacheï¼šå’Œç¼“å­˜æœ‰å…³
</span><span class="c">cache-refï¼šå’Œç¼“å­˜æœ‰å…³
</span><span class="c">parameterMapï¼šå‚æ•°mapï¼›åºŸå¼ƒçš„ã€‚ã€‚ã€‚åŸæœ¬æ˜¯æ¥åšå¤æ‚å‚æ•°æ˜ å°„çš„ï¼›
</span><span class="c">resultMapï¼šç»“æœé›†æ˜ å°„ï¼›è‡ªå®šä¹‰ç»“æœé›†çš„å°è£…è§„åˆ™
</span><span class="c">sqlï¼šæŠ½å–å¯é‡ç”¨çš„sqlï¼›
</span><span class="c">
</span><span class="c">deleteã€updateã€insertã€selectï¼šå¢åˆ æ”¹æŸ¥ï¼›
</span><span class="c">databaseIdï¼šæŒ‡å®šè¿™ä¸ªCRUDå±äºå“ªä¸ªæ•°æ®åº“çš„
</span><span class="c"> --&gt;</span>
 
 	<span class="c">&lt;!-- public int insertEmployee(Employee employee);--&gt;</span>
 	<span class="c">&lt;!-- 
</span><span class="c"> 	è®©MyBatisè‡ªåŠ¨çš„å°†è‡ªå¢idèµ‹å€¼ç»™ä¼ å…¥çš„employeeå¯¹è±¡çš„idå±æ€§
</span><span class="c"> 		useGeneratedKeys=&#34;true&#34;ï¼šåŸç”Ÿjdbcè·å–è‡ªå¢ä¸»é”®çš„æ–¹æ³•ï¼›
</span><span class="c"> 		keyProperty=&#34;&#34;ï¼šå°†åˆšæ‰è‡ªå¢çš„idå°è£…ç»™å“ªä¸ªå±æ€§
</span><span class="c"> 	 --&gt;</span>
	<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertEmployee&#34;</span> <span class="na">useGeneratedKeys=</span><span class="s">&#34;true&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;emp_id&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- æŸ¥è¯¢ä¸»é”®
</span><span class="c">		order=&#34;BEFORE&#34;:
</span><span class="c">			åœ¨æ ¸å¿ƒsqlè¯­å¥ä¹‹å‰å…ˆè¿è¡Œä¸€ä¸ªæŸ¥è¯¢sqlæŸ¥åˆ°idï¼›å°†æŸ¥åˆ°çš„idèµ‹å€¼ç»™javaBeançš„å“ªä¸ªå±æ€§
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;selectKey</span> <span class="na">order=</span><span class="s">&#34;BEFORE&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;emp_id&#34;</span><span class="nt">&gt;</span>
			select max(emp_id) from employee
		<span class="nt">&lt;/selectKey&gt;</span>
		INSERT INTO employee(emp_name,emp_gender,emp_email) 
		VALUES(#{emp_name},#{emp_gender},#{emp_email})
	<span class="nt">&lt;/insert&gt;</span>
	
	<span class="c">&lt;!-- public int insertEmployee2(Employee employee); --&gt;</span>
	<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertEmployee2&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- æŸ¥è¯¢ä¸»é”®
</span><span class="c">		order=&#34;BEFORE&#34;:
</span><span class="c">			åœ¨æ ¸å¿ƒsqlè¯­å¥ä¹‹å‰å…ˆè¿è¡Œä¸€ä¸ªæŸ¥è¯¢sqlæŸ¥åˆ°idï¼›å°†æŸ¥åˆ°çš„idèµ‹å€¼ç»™javaBeançš„å“ªä¸ªå±æ€§
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;selectKey</span> <span class="na">order=</span><span class="s">&#34;BEFORE&#34;</span> <span class="na">resultType=</span><span class="s">&#34;integer&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;emp_id&#34;</span><span class="nt">&gt;</span>
			select max(emp_id)+1 from employee
		<span class="nt">&lt;/selectKey&gt;</span>
		INSERT INTO employee(emp_id,emp_name,emp_gender,emp_email) 
		VALUES(#{emp_id},#{emp_name},#{emp_gender},#{emp_email})
	<span class="nt">&lt;/insert&gt;</span>

    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateEmployee&#34;</span> <span class="nt">&gt;</span>
	UPDATE employee 
	SET emp_name=#{emp_name},emp_gender=#{emp_gender},emp_email=#{emp_email}
	WHERE emp_id=#{emp_id}
    <span class="nt">&lt;/update&gt;</span>

	<span class="c">&lt;!-- public int deleteEmployee(Integer emp_id); --&gt;</span>
	<span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteEmployee&#34;</span> <span class="nt">&gt;</span>
		DELETE FROM employee WHERE emp_id=#{emp_id}
	<span class="nt">&lt;/delete&gt;</span>
	
	<span class="c">&lt;!-- ä¼ å‚åˆ°åº•èƒ½ä¼ å“ªäº› --&gt;</span>
	<span class="c">&lt;!-- public Employee getEmpById(Integer emp_id); --&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span> <span class="nt">&gt;</span>
  		select * from employee where emp_id=#{hahaha}
    <span class="nt">&lt;/select&gt;</span>
    
    <span class="c">&lt;!-- Caused by: org.apache.ibatis.binding.BindingException:
</span><span class="c">     Parameter &#39;emp_id&#39; not found. 
</span><span class="c">     Available parameters are [arg1, arg0, param1, param2]
</span><span class="c">     --&gt;</span>
    
    <span class="c">&lt;!-- public Employee getEmpByIdAndEmpName(Integer emp_id,String emp_name); --&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpByIdAndEmpName&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
    	select * from employee where emp_id=#{emp_id} and emp_name=#{emp_name}
    <span class="nt">&lt;/select&gt;</span>
    
    <span class="c">&lt;!-- public Employee getEmpByIdAndEmpName1(Map&lt;String, Object&gt; map); --&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpByIdAndEmpName1&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
    	select * from ${tableName} where emp_id=#{emp_id,jdbcType=INTEGER} and emp_name=#{emp_name}
    <span class="nt">&lt;/select&gt;</span>
    
    <span class="c">&lt;!-- ç°è±¡ï¼š
</span><span class="c">    	1ï¼‰ã€å•ä¸ªå‚æ•°
</span><span class="c">    		åŸºæœ¬ç±»å‹ï¼š
</span><span class="c">    			å–å€¼ï¼š#{éšä¾¿å†™}
</span><span class="c">    		ä¼ å…¥Pojo
</span><span class="c">    	2ï¼‰ã€å¤šä¸ªå‚æ•°
</span><span class="c">    		public Employee getEmpByIdAndEmpName(Integer emp_id,String emp_name)
</span><span class="c">    		å–å€¼ï¼š#{å‚æ•°å}æ˜¯æ— æ•ˆäº†ï¼›
</span><span class="c">    		å¯ç”¨ï¼šarg0ï¼Œarg1æˆ–è€…param1ï¼Œparam2
</span><span class="c">    		åŸå› ï¼šåªè¦æ˜¯ä¼ å…¥äº†å¤šä¸ªå‚æ•°ï¼›mybatisä¼šè‡ªåŠ¨çš„å°†è¿™äº›å‚æ•°å°è£…åœ¨ä¸€ä¸ªmapä¸­ï¼Œ
</span><span class="c">    			å°è£…æ—¶ä½¿ç”¨çš„keyå°±æ˜¯å‚æ•°çš„ç´¢å¼•å’Œå‚æ•°çš„ç¬¬å‡ ä¸ªè¡¨ç¤º
</span><span class="c">    			Map&lt;String,Object&gt; map = new HashMap&lt;&gt;();
</span><span class="c">    			map.put(&#34;1&#34;,ä¼ å…¥çš„å€¼);map.put(&#34;2&#34;,ä¼ å…¥çš„å€¼);
</span><span class="c">    		#{key}å°±æ˜¯ä»è¿™å‡ ä¸ªmapä¸­å–å€¼ï¼›
</span><span class="c">    	3)ã€@Param(&#34;&#34;)ä¸ºå‚æ•°æŒ‡å®škeyï¼Œå‘½åå‚æ•°ï¼Œæˆ‘ä»¬ä»¥åä¹Ÿæ¨èè¿™ä¹ˆåšï¼›
</span><span class="c">    		æˆ‘ä»¬å¯ä»¥å‘Šè¯‰mybatisï¼Œå°è£…å‚æ•°mapçš„æ—¶å€™åˆ«ä¹±æ¥ï¼Œä½¿ç”¨æˆ‘ä»¬æŒ‡å®šçš„key
</span><span class="c">    	
</span><span class="c">    	4ï¼‰ã€ä¼ å…¥äº†pojoï¼ˆjavaBeanï¼‰
</span><span class="c">    		å–å€¼ï¼š#{pojoçš„å±æ€§å}
</span><span class="c">    	
</span><span class="c">    	5ï¼‰ã€ä¼ å…¥äº†map;å°†å¤šä¸ªè¦ä½¿ç”¨çš„å‚æ•°å°è£…èµ·æ¥
</span><span class="c">    		å–å€¼ï¼š#{key}
</span><span class="c">    	
</span><span class="c">    	æ‰©å±•ï¼šå¤šä¸ªå‚æ•°ï¼šè‡ªåŠ¨å°è£…mapï¼›
</span><span class="c">    	method01(@Param(&#34;emp_id&#34;)Integer emp_id,String emp_name,Employee employee);
</span><span class="c">    	Integer id -&gt; #{emp_id}
</span><span class="c">    	String emp_name -&gt; #{param2}
</span><span class="c">    	Employee employee(å–å‡ºè¿™é‡Œé¢çš„email) -&gt; #{param3.email}
</span><span class="c">    	
</span><span class="c">    	æ— è®ºä¼ å…¥ä»€ä¹ˆå‚æ•°éƒ½è¦èƒ½æ­£ç¡®çš„å–å‡ºå€¼ï¼›
</span><span class="c">    	#{key/å±æ€§å}
</span><span class="c">    	1)ã€#{key,jdbcType=INTEGER}ï¼›
</span><span class="c">    	javaTypeã€jdbcTypeã€modeã€numericScaleã€resultMapã€typeHandlerã€jdbcTypeNameã€expression
</span><span class="c">    	åªæœ‰jdbcTypeæ‰å¯èƒ½æ˜¯éœ€è¦è¢«æŒ‡å®šçš„ï¼›
</span><span class="c">    		é»˜è®¤ä¸æŒ‡å®šjdbcTypeï¼šmysqlæ²¡é—®é¢˜ï¼Œoracleæ²¡é—®é¢˜ï¼›
</span><span class="c">    		ä¸‡ä¸€ä¼ å…¥çš„æ•°æ®æ˜¯nullï¼šmysqlæ’å…¥nullæ²¡é—®é¢˜ï¼Œã€oracleä¸çŸ¥é“nullåˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹ã€‘
</span><span class="c">    	
</span><span class="c">    	å®é™…ä¸Šåœ¨mybatisä¸­ï¼Œæœ‰ä¸¤ç§å–å€¼æ–¹å¼ï¼š
</span><span class="c">    	#{å±æ€§å}ï¼šæ˜¯é¢„ç¼–è¯‘çš„æ–¹å¼ï¼Œå‚æ•°çš„ä½ç½®éƒ½æ˜¯ï¼Ÿæ›¿ä»£ï¼Œå‚æ•°åæ¥éƒ½æ˜¯é¢„ç¼–è¯‘è®¾ç½®è¿›å»çš„ï¼›å®‰å…¨ï¼Œä¸ä¼šæœ‰sqlæ³¨å…¥é—®é¢˜
</span><span class="c">    	${å±æ€§å}ï¼šä¸æ˜¯å‚æ•°é¢„ç¼–è¯‘ï¼Œè€Œæ˜¯ç›´æ¥å’Œsqlè¯­å¥è¿›è¡Œæ‹¼ä¸²ï¼›ä¸å®‰å…¨:
</span><span class="c">    		//emp_id=1 or 1=1 or and emp_name=
</span><span class="c">    		ä¼ å…¥ä¸€ä¸ª&#39;1 or 1=1 or&#39;
</span><span class="c">    		æœ‰ä½¿ç”¨åœºæ™¯ï¼šsqlè¯­å¥åªæœ‰å‚æ•°ä½ç½®æ˜¯æ”¯æŒé¢„ç¼–è¯‘çš„ï¼š
</span><span class="c">    		log_2020_12ã€log_2021_1(åŠ¨æ€è¡¨å)
</span><span class="c">    		select * from log_2021_1 where emp_id=1 and emp_name=?
</span><span class="c">    	
</span><span class="c">    	
</span><span class="c">    	emp_id=${emp_id} and emp_name=#{emp_name}
</span><span class="c">    	select * from employee where emp_id=1 and emp_name=?
</span><span class="c">    	
</span><span class="c">    	emp_id=#{emp_id} and emp_name=#{emp_name}
</span><span class="c">    	select * from employee where emp_id=? and emp_name=?
</span><span class="c">    	
</span><span class="c">    	ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨#{}ï¼›å®‰å…¨ï¼›åœ¨ä¸æ”¯æŒé¢„ç¼–è¯‘å‚æ•°çš„ä½ç½®è¦è¿›è¡Œå–å€¼å°±ä½¿ç”¨${};
</span><span class="c">     --&gt;</span>
     
     <span class="c">&lt;!-- public List&lt;Employee&gt; getAllEmps(); --&gt;</span>
     <span class="c">&lt;!-- resultType=&#34;&#34;ï¼šå¦‚æœè¿”å›çš„æ˜¯é›†åˆï¼Œå†™çš„æ˜¯é›†åˆé‡Œé¢å…ƒç´ çš„ç±»å‹ --&gt;</span>
     <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getAllEmps&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
     	select * from employee
     <span class="nt">&lt;/select&gt;</span>
     
     <span class="c">&lt;!-- æŸ¥è¯¢è¿”å›ä¸€ä¸ªmap --&gt;</span>
     <span class="c">&lt;!-- public Map&lt;String, Object&gt; getEmpByIdReturnMap(Integer emp_id); --&gt;</span>
     <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpByIdReturnMap&#34;</span> <span class="na">resultType=</span><span class="s">&#34;map&#34;</span><span class="nt">&gt;</span>
     	select * from employee where emp_id=#{emp_id}
     <span class="nt">&lt;/select&gt;</span>
     
     <span class="c">&lt;!-- æŸ¥è¯¢å¤šä¸ªè¿”å›ä¸€ä¸ªmapï¼›æŸ¥è¯¢å¤šä¸ªæƒ…å†µä¸‹ï¼Œé›†åˆé‡Œé¢å†™å…ƒç´ ç±»å‹ --&gt;</span>
     <span class="c">&lt;!-- public Map&lt;Integer, Employee&gt; getAllEmpsReturnMap(); --&gt;</span>
     <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getAllEmpsReturnMap&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
     	select * from employee
     <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>


<span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span> KeyDao.xml <span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span>

<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.KeyDao&#34;</span><span class="nt">&gt;</span>

	<span class="c">&lt;!-- public List&lt;Key&gt; getKeysByLockId(Integer id); 
</span><span class="c">	æŒ‰ç…§é”idæŸ¥å‡ºæ‰€æœ‰çš„key
</span><span class="c">	--&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getKeysByLockId&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Key&#34;</span><span class="nt">&gt;</span>
		SELECT * FROM t_key WHERE lockid = #{id};
	<span class="nt">&lt;/select&gt;</span>

	<span class="c">&lt;!-- public Key getKeyByIdSimple(Integer id); --&gt;</span>
	<span class="c">&lt;!-- æŸ¥è¯¢keyçš„æ—¶å€™ä¹Ÿå¯ä»¥å¸¦ä¸Šé”ä¿¡æ¯ --&gt;</span>
	<span class="c">&lt;!-- id	keyname	lockid --&gt;</span>
	<span class="c">&lt;!-- 
</span><span class="c">	private Integer id;//é’¥åŒ™çš„id
</span><span class="c">	private String keyName;//é’¥åŒ™å
</span><span class="c">	private Lock lock;//å½“å‰é’¥åŒ™èƒ½å¼€å“ªä¸ªé”
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getKeyByIdSimple&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mykey02&#34;</span><span class="nt">&gt;</span>
		select * from t_key where id = #{id}
	<span class="nt">&lt;/select&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Key&#34;</span> <span class="na">id=</span><span class="s">&#34;mykey02&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;keyName&#34;</span> <span class="na">column=</span><span class="s">&#34;keyname&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- å‘Šè¯‰mybatisè‡ªå·±å»è°ƒç”¨ä¸€ä¸ªæŸ¥è¯¢æŸ¥é”
</span><span class="c">		select=&#34;&#34;ï¼šæŒ‡å®šä¸€ä¸ªæŸ¥è¯¢sqlçš„å”¯ä¸€æ ‡è¯†ï¼›
</span><span class="c">		mybatisè‡ªåŠ¨è°ƒç”¨æŒ‡å®šçš„sqlå°†æŸ¥å‡ºçš„lockå°è£…è¿›æ¥
</span><span class="c">		public Lock getLockByIdSimple(Integer id);éœ€è¦ä¼ å…¥é”id
</span><span class="c">		å‘Šè¯‰mybatisæŠŠé‚£ä¸€åˆ—çš„å€¼ä¼ è¿‡å»ï¼š
</span><span class="c">		column=&#34;&#34;ï¼šæŒ‡å®šå°†å“ªä¸€åˆ—çš„æ•°æ®ä¼ é€’è¿‡å»
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">&#34;lock&#34;</span> <span class="na">select=</span><span class="s">&#34;com.lql.dao.LockDao.getLockByIdSimple&#34;</span>
		<span class="na">column=</span><span class="s">&#34;lockid&#34;</span> <span class="na">fetchType=</span><span class="s">&#34;lazy&#34;</span><span class="nt">&gt;&lt;/association&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>


	<span class="c">&lt;!-- getKeyById(Integer) --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getKeyById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mykey&#34;</span><span class="nt">&gt;</span>
		SELECT k.id,k.keyname,k.lockid,l.id lid,l.lockname 
		FROM t_key k LEFT JOIN t_lock l ON k.lockid = l.id 
		WHERE k.id = #{id};
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- è‡ªå®šä¹‰å°è£…è§„åˆ™ï¼šä½¿ç”¨çº§è”å±æ€§å°è£… è”åˆæŸ¥è¯¢å‡ºæ¥çš„ç»“æœ--&gt;</span>
	<span class="c">&lt;!-- &lt;resultMap type=&#34;com.lql.bean.Key&#34; id=&#34;mykey&#34;&gt;
</span><span class="c">		&lt;id property=&#34;id&#34; column=&#34;id&#34;/&gt;
</span><span class="c">		&lt;result property=&#34;keyName&#34; column=&#34;keyname&#34;/&gt;
</span><span class="c">		&lt;result property=&#34;lock.id&#34; column=&#34;lid&#34;/&gt;
</span><span class="c">		&lt;result property=&#34;lock.lockName&#34; column=&#34;lockname&#34;/&gt;
</span><span class="c">	&lt;/resultMap&gt; --&gt;</span>
	
	<span class="c">&lt;!-- mybatisæ¨èçš„ --&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Key&#34;</span> <span class="na">id=</span><span class="s">&#34;mykey&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;keyName&#34;</span> <span class="na">column=</span><span class="s">&#34;keyname&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- æ¥ä¸‹æ¥çš„å±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè‡ªå®šä¹‰è¿™ä¸ªå¯¹è±¡çš„å°è£…è§„åˆ™ï¼›
</span><span class="c">		ä½¿ç”¨associationï¼šè¡¨ç¤ºè”åˆäº†ä¸€ä¸ªå¯¹è±¡
</span><span class="c">		javaType=&#34;&#34;ï¼šæŒ‡å®šè¿™ä¸ªå±æ€§çš„ç±»å‹
</span><span class="c">		--&gt;</span>
		<span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">&#34;lock&#34;</span> <span class="na">javaType=</span><span class="s">&#34;com.lql.bean.Lock&#34;</span><span class="nt">&gt;</span>
			<span class="c">&lt;!-- å®šä¹‰lockå±æ€§å¯¹åº”çš„è¿™ä¸ªLockå¯¹è±¡å¦‚ä½•å°è£… --&gt;</span>
			<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;lid&#34;</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;lockName&#34;</span> <span class="na">column=</span><span class="s">&#34;lockname&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;/association&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>


<span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span> LockDao.xml <span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span>

<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.LockDao&#34;</span><span class="nt">&gt;</span>

	<span class="c">&lt;!-- public Lock getLockByIdByStep(Integer id); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getLockByIdByStep&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mylockstep&#34;</span><span class="nt">&gt;</span>
		select * from t_lock where id=#{id}
	<span class="nt">&lt;/select&gt;</span>
	<span class="c">&lt;!-- collectionåˆ†æ­¥æŸ¥è¯¢ --&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Lock&#34;</span> <span class="na">id=</span><span class="s">&#34;mylockstep&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;lockName&#34;</span> <span class="na">column=</span><span class="s">&#34;lockname&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- collectionæŒ‡å®šé›†åˆç±»å‹çš„å±æ€§å°è£…è§„åˆ™ --&gt;</span>
		<span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;keys&#34;</span> 
		<span class="na">select=</span><span class="s">&#34;com.lql.dao.KeyDao.getKeysByLockId&#34;</span>
		<span class="na">column=</span><span class="s">&#34;{id=id}&#34;</span><span class="nt">&gt;&lt;/collection&gt;</span>
		<span class="c">&lt;!-- {key1=åˆ—å,key2=åˆ—å} --&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>

	<span class="c">&lt;!-- public Lock getLockByIdSimple(Integer id); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getLockByIdSimple&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Lock&#34;</span><span class="nt">&gt;</span>
		select * from t_lock where id=#{id}
	<span class="nt">&lt;/select&gt;</span>


	<span class="c">&lt;!-- public Lock getLockById(Integer id); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getLockById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mylock&#34;</span><span class="nt">&gt;</span>
		SELECT l.*,k.id kid,k.keyname,k.lockid 
		FROM t_lock l LEFT JOIN t_key k 
		ON l.id=k.lockid WHERE l.id = #{id}
	<span class="nt">&lt;/select&gt;</span>
	<span class="c">&lt;!-- 
</span><span class="c">		private Integer id;
</span><span class="c">		private String lockName;
</span><span class="c">		//æŸ¥é”çš„æ—¶å€™æŠŠæ‰€æœ‰çš„é’¥åŒ™ä¹ŸæŸ¥å‡ºæ¥
</span><span class="c">		private List&lt;Key&gt; keys;
</span><span class="c">		
</span><span class="c">		id	lockname	kid	keyname	lockid
</span><span class="c">		3	303åŠå…¬å®¤çš„é”	3	303é’¥åŒ™1	3
</span><span class="c">		3	303åŠå…¬å®¤çš„é”	4	303é’¥åŒ™2	3
</span><span class="c">		3	303åŠå…¬å®¤çš„é”	5	303é’¥åŒ™3	3
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Lock&#34;</span> <span class="na">id=</span><span class="s">&#34;mylock&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;lockName&#34;</span> <span class="na">column=</span><span class="s">&#34;lockname&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- 
</span><span class="c">		collectionï¼šå®šä¹‰é›†åˆå…ƒç´ çš„å°è£…
</span><span class="c">			property=&#34;&#34;ï¼šæŒ‡å®šå“ªä¸ªå±æ€§æ˜¯é›†åˆå±æ€§
</span><span class="c">			javaTypeï¼šæŒ‡å®šå¯¹è±¡ç±»å‹ï¼ˆassociationï¼‰
</span><span class="c">			ofTypeï¼šæŒ‡å®šé›†åˆé‡Œé¢å…ƒç´ çš„ç±»å‹
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;keys&#34;</span> <span class="na">ofType=</span><span class="s">&#34;com.lql.bean.Key&#34;</span><span class="nt">&gt;</span>
			<span class="c">&lt;!-- æ ‡ç­¾ä½“ä¸­é›†åˆä¸­è¿™ä¸ªå…ƒç´ çš„å°è£…è§„åˆ™ --&gt;</span>
			<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;kid&#34;</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;keyName&#34;</span> <span class="na">column=</span><span class="s">&#34;keyname&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;/collection&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h3 id="5mybatis-configxml-1">5.mybatis-config.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

	<span class="nt">&lt;settings&gt;</span>
		<span class="c">&lt;!-- å¼€å¯å»¶è¿ŸåŠ è½½å¼€å…³ --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;lazyLoadingEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- å¼€å¯å±æ€§æŒ‰éœ€åŠ è½½(é»˜è®¤å¼€å¯) --&gt;</span>
		<span class="c">&lt;!-- &lt;setting name=&#34;aggressiveLazyLoading&#34; value=&#34;false&#34;/&gt; --&gt;</span>
	<span class="nt">&lt;/settings&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/test?serverTimezone=UTC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
      <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<h3 id="6mybatistestjava">6ã€MyBatisTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Cat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.bean.Key</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.bean.Lock</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.CatDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.KeyDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.LockDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisTest</span> <span class="o">{</span>

	<span class="c1">//å·¥å‚ä¸€ä¸ª
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
		
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Employee</span> <span class="n">empById</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">empById</span><span class="o">);</span>
			
			
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="cm">/*Employee employee = new Employee(null, &#34;haha&#34;, 0, &#34;aaa&#34;);
</span><span class="cm">			int i = employeeDao.insertEmployee(employee);
</span><span class="cm">			System.out.println(&#34;---&gt;&#34;+i);
</span><span class="cm">			System.out.println(&#34;åˆšæ‰æ’å…¥çš„idï¼š&#34;+employee.getEmp_id());*/</span>
			<span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Employee</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&#34;haha&#34;</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="s">&#34;aaa&#34;</span><span class="o">);</span>
			<span class="n">employeeDao</span><span class="o">.</span><span class="na">insertEmployee2</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
			
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">.</span><span class="na">getEmp_id</span><span class="o">());</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test03</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="cm">/*Employee empByIdAndEmpName = employeeDao.getEmpByIdAndEmpName(1, &#34;admin&#34;);
</span><span class="cm">			System.out.println(empByIdAndEmpName);
</span><span class="cm">			
</span><span class="cm">			Employee empById = employeeDao.getEmpById(1);
</span><span class="cm">			System.out.println(empById);*/</span>
			
			<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;();</span>
			<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;emp_id&#34;</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
			<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;emp_name&#34;</span><span class="o">,</span> <span class="s">&#34;admin&#34;</span><span class="o">);</span>
			<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;tableName&#34;</span><span class="o">,</span> <span class="s">&#34;employee&#34;</span><span class="o">);</span>
			<span class="n">Employee</span> <span class="n">empByIdAndEmpName2</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getEmpByIdAndEmpName1</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">empByIdAndEmpName2</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test04</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="c1">//æŸ¥è¯¢å¤šæ¡è®°å½•å°è£…list
</span><span class="c1"></span>			<span class="cm">/*List&lt;Employee&gt; allEmps = employeeDao.getAllEmps();
</span><span class="cm">			for (Employee employee : allEmps) {
</span><span class="cm">				System.out.println(employee);
</span><span class="cm">			}*/</span>
			
			<span class="c1">//æŸ¥è¯¢å•æ¡è®°å½•å°è£…map
</span><span class="c1"></span>			<span class="cm">/*Map&lt;String, Object&gt; map = employeeDao.getEmpByIdReturnMap(1);
</span><span class="cm">			System.out.println(map);*/</span>
			
			<span class="c1">//æŸ¥è¯¢å¤šæ¡è®°å½•å°è£…map
</span><span class="c1"></span>			<span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Employee</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getAllEmpsReturnMap</span><span class="o">();</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
			<span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">.</span><span class="na">getEmp_name</span><span class="o">());</span>
			
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * é»˜è®¤mybatisè‡ªåŠ¨å°è£…ç»“æœé›†ï¼›
</span><span class="cm">	 * 1ï¼‰ã€æŒ‰ç…§åˆ—åå’Œå±æ€§åä¸€ä¸€å¯¹åº”çš„è§„åˆ™ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼›
</span><span class="cm">	 * 2ï¼‰ã€å¦‚æœä¸ä¸€ä¸€å¯¹åº”ï¼š
</span><span class="cm">	 * 		1ï¼‰ã€å¼€å¯é©¼å³°å‘½åæ³•ï¼ˆæ»¡è¶³é©¼å³°å‘½åè§„åˆ™ aaa_bbb aaaBbbï¼‰
</span><span class="cm">	 * 		2)ã€èµ·åˆ«å
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test05</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">CatDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">CatDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Cat</span> <span class="n">catById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getCatById</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">catById</span><span class="o">);</span>
			
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * è”åˆæŸ¥è¯¢æƒ…å†µä¸‹
</span><span class="cm">	 * 1ã€ä½¿ç”¨çº§è”å±æ€§å°è£…è”åˆæŸ¥è¯¢åçš„æ‰€æœ‰ç»“æœ
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test06</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">KeyDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">KeyDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Key</span> <span class="n">keyById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getKeyById</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">keyById</span><span class="o">);</span>
			
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test07</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">LockDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">LockDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Lock</span> <span class="n">lockById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getLockById</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lockById</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;æ‰€æœ‰ğŸ”‘å¦‚ä¸‹ï¼š&#34;</span><span class="o">);</span>
			<span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">lockById</span><span class="o">.</span><span class="na">getKeys</span><span class="o">();</span>
			<span class="k">for</span> <span class="o">(</span><span class="n">Key</span> <span class="n">key</span> <span class="o">:</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test08</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">LockDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">LockDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Lock</span> <span class="n">lockById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getLockById</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lockById</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;æ‰€æœ‰ğŸ”‘å¦‚ä¸‹ï¼š&#34;</span><span class="o">);</span>
			<span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">lockById</span><span class="o">.</span><span class="na">getKeys</span><span class="o">();</span>
			<span class="k">for</span> <span class="o">(</span><span class="n">Key</span> <span class="n">key</span> <span class="o">:</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * åˆ†æ­¥æŸ¥è¯¢
</span><span class="cm">	 * æŸ¥è¯¢ğŸ”‘çš„æ—¶å€™é¡ºä¾¿æŸ¥å‡ºğŸ”’
</span><span class="cm">	 * 1ï¼‰ã€Key key = keyDao.getKeyById(1);
</span><span class="cm">	 * 2)ã€Lock lock = lockDao.getLockById(1);
</span><span class="cm">	 * @throws InterruptedException 
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test09</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">KeyDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">KeyDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Key</span> <span class="n">keyByIdSimple</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getKeyByIdSimple</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="c1">//ä¸¥é‡æ€§èƒ½ï¼›
</span><span class="c1"></span>			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">keyByIdSimple</span><span class="o">.</span><span class="na">getKeyName</span><span class="o">());</span>
			<span class="c1">//æŒ‰éœ€åŠ è½½ï¼ˆéœ€è¦çš„æ—¶å€™å†å»æŸ¥è¯¢ï¼‰å…¨å±€å¼€å¯æŒ‰éœ€åŠ è½½ç­–ç•¥
</span><span class="c1"></span>			<span class="c1">//å»¶è¿ŸåŠ è½½ï¼Œä¸ç€æ€¥åŠ è½½ï¼ˆæŸ¥è¯¢å¯¹è±¡ï¼‰
</span><span class="c1"></span>			<span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">3000</span><span class="o">);</span>
			<span class="n">String</span> <span class="n">lockName</span> <span class="o">=</span> <span class="n">keyByIdSimple</span><span class="o">.</span><span class="na">getLock</span><span class="o">().</span><span class="na">getLockName</span><span class="o">();</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lockName</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * ä¸€èˆ¬æˆ‘ä»¬åœ¨å·¥ä½œçš„æ—¶å€™ï¼šå†™æˆä¸¤ä¸ªæ–¹æ³•
</span><span class="cm">	 * public Key getKeySimple(Integer id);
</span><span class="cm">	 * 
</span><span class="cm">	 * æ¨èéƒ½æ¥å†™è¿æ¥æŸ¥è¯¢
</span><span class="cm">	 * public Key getKeyAssicate()
</span><span class="cm">	 * @throws InterruptedException
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test10</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">LockDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">LockDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Lock</span> <span class="n">lockByIdByStep</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getLockByIdByStep</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lockByIdByStep</span><span class="o">.</span><span class="na">getLockName</span><span class="o">());</span>
			
			<span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">lockByIdByStep</span><span class="o">.</span><span class="na">getKeys</span><span class="o">();</span>
			<span class="k">for</span> <span class="o">(</span><span class="n">Key</span> <span class="n">key</span> <span class="o">:</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">getKeyName</span><span class="o">());</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	
<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h1 id="äº”åŠ¨æ€sql">äº”ã€åŠ¨æ€sql</h1>
<h2 id="1æ€»ä½“æ¶æ„-2">1ã€æ€»ä½“æ¶æ„ï¼š</h2>
<p><img src="https://i.loli.net/2020/12/21/q7axv8Hki2JLmNO.png" alt="image-20201221091302369"></p>
<h2 id="2bean-1">2ã€bean</h2>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Teacher</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">course</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Date</span> <span class="n">birth</span><span class="o">;</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getCourse</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">course</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCourse</span><span class="o">(</span><span class="n">String</span> <span class="n">course</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">course</span> <span class="o">=</span> <span class="n">course</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getAddress</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">address</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAddress</span><span class="o">(</span><span class="n">String</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Date</span> <span class="nf">getBirth</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">birth</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBirth</span><span class="o">(</span><span class="n">Date</span> <span class="n">birth</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">birth</span> <span class="o">=</span> <span class="n">birth</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Teacher [id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34;, name=&#34;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#34;, course=&#34;</span> <span class="o">+</span> <span class="n">course</span> <span class="o">+</span> <span class="s">&#34;, address=&#34;</span> <span class="o">+</span> <span class="n">address</span> <span class="o">+</span> <span class="s">&#34;, birth=&#34;</span>
				<span class="o">+</span> <span class="n">birth</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>
	
	
<span class="o">}</span>

</code></pre></div><hr>
<h2 id="3dao-1">3ã€dao</h2>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Teacher</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TeacherDao</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="n">Teacher</span> <span class="nf">getTeacherById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="nf">getTeacherByCondition</span><span class="o">(</span><span class="n">Teacher</span> <span class="n">teacher</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="nf">getTeacherByIdIn</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;ids&#34;</span><span class="o">)</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="nf">getTeacherByConditionChoose</span><span class="o">(</span><span class="n">Teacher</span> <span class="n">teacher</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">updateTeacher</span><span class="o">(</span><span class="n">Teacher</span> <span class="n">teacher</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<h2 id="4daoxml-1">4ã€dao.xml</h2>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>

<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.TeacherDao&#34;</span><span class="nt">&gt;</span>
<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Teacher&#34;</span> <span class="na">id=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;address&#34;</span> <span class="na">column=</span><span class="s">&#34;address&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;birth&#34;</span> <span class="na">column=</span><span class="s">&#34;birth_date&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;course&#34;</span> <span class="na">column=</span><span class="s">&#34;class_name&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;t_name&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>

<span class="c">&lt;!-- æŠ½å–å¯é‡ç”¨çš„sqlè¯­å¥ --&gt;</span>
<span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">&#34;selectSql&#34;</span><span class="nt">&gt;</span>select * from t_teacher<span class="nt">&lt;/sql&gt;</span>
<span class="c">&lt;!-- id	t_name	class_name	address	birth_date --&gt;</span>

	<span class="c">&lt;!-- public Teacher getTeacherById(Integer id); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacherById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&#34;selectSql&#34;</span><span class="nt">&gt;&lt;/include&gt;</span>
		<span class="c">&lt;!-- select * from t_teacher --&gt;</span> where id=#{id}
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- public List&lt;Teacher&gt; getTeacherByCondition(Teacher teacher); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacherByCondition&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
		select * from t_teacher
		<span class="c">&lt;!-- test=&#34;&#34;ï¼šç¼–å†™åˆ¤æ–­æ¡ä»¶
</span><span class="c">		id!=nullï¼šå–å‡ºä¼ å…¥çš„javaBeanå±æ€§ä¸­çš„idå€¼ï¼Œåˆ¤æ–­å…¶æ˜¯å¦ä¸ºç©º
</span><span class="c">		 --&gt;</span>
		 <span class="c">&lt;!-- &lt;where&gt;æ ‡ç­¾å¯ä»¥å¸®æˆ‘ä»¬å»é™¤æ‰å‰é¢çš„and --&gt;</span>
		 <span class="c">&lt;!-- &lt;trim&gt;æ ‡ç­¾æˆªå–å­—ç¬¦ä¸²
</span><span class="c">		 prefix=&#34;&#34;ï¼šå‰ç¼€ï¼›ä¸ºæˆ‘ä»¬ä¸‹é¢çš„sqlæ•´ä½“æ·»åŠ ä¸€ä¸ªå‰ç¼€ï¼›
</span><span class="c">		 prefixOverrides=&#34;&#34;ï¼šå»é™¤æ•´ä½“å­—ç¬¦ä¸²å‰é¢å¤šä½™çš„å­—ç¬¦ï¼›
</span><span class="c">		 suffix=&#34;&#34;ï¼šä¸ºæ•´ä½“æ·»åŠ ä¸€ä¸ªåç¼€
</span><span class="c">		 suffixOverrides=&#34;&#34;ï¼šåé¢å“ªä¸ªå¤šäº†ï¼Œå¯ä»¥å»æ‰
</span><span class="c">		  --&gt;</span>
		  <span class="c">&lt;!-- æˆ‘ä»¬çš„æŸ¥è¯¢æ¡ä»¶å°±æ”¾åœ¨whereæ ‡ç­¾ä¸­ï¼Œæ¯ä¸ªandå†™åœ¨å‰é¢ï¼Œwhereå¸®æˆ‘ä»¬è‡ªåŠ¨å–å‡ºå‰é¢å¤šä½™çš„and --&gt;</span>
		 <span class="nt">&lt;trim</span> <span class="na">prefix=</span><span class="s">&#34;where&#34;</span> 
		  <span class="na">suffixOverrides=</span><span class="s">&#34;and &#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;id!=null&#34;</span><span class="nt">&gt;</span>
			id &gt; #{id} and
		<span class="nt">&lt;/if&gt;</span> 
		<span class="c">&lt;!-- ç©ºä¸²&#34;&#34;
</span><span class="c">		 andï¼š&amp;&amp;
</span><span class="c">		 orï¼š||ï¼›
</span><span class="c">		 if()ï¼šä¼ å…¥éå¸¸å¼ºå¤§çš„åˆ¤æ–­æ¡ä»¶ï¼›
</span><span class="c">		 
</span><span class="c">		 OGNLè¡¨è¾¾å¼:å¯¹è±¡å¯¼èˆªå›¾ï¼ˆç›¸å½“äºçº§è”å±æ€§ï¼‰
</span><span class="c">		 æ–¹æ³•ã€é™æ€æ–¹æ³•ã€æ„é€ å™¨ã€xxx
</span><span class="c">		 åœ¨mybatisä¸­ï¼Œä¼ å…¥çš„å‚æ•°å¯ä»¥ç”¨æ¥åšåˆ¤æ–­ï¼›
</span><span class="c">		 é¢å¤–è¿˜æœ‰ä¸¤ä¸ªä¸œè¥¿ï¼š
</span><span class="c">		 	_parameterï¼šä»£è¡¨ä¼ å…¥æ¥çš„å‚æ•°ï¼š
</span><span class="c">		 		1ï¼‰ã€ä¼ å…¥äº†å•ä¸ªå‚æ•°ï¼š_parameterå°±ä»£è¡¨è¿™ä¸ªå‚æ•°
</span><span class="c">		 		2ï¼‰ã€ä¼ å…¥äº†å¤šä¸ªå‚æ•°ï¼š_parameterå°±ä»£è¡¨å¤šä¸ªå‚æ•°é›†åˆèµ·æ¥çš„map
</span><span class="c">		 	_databaseIdï¼šä»£è¡¨å½“å‰ç¯å¢ƒ
</span><span class="c">		 		å¦‚æœé…ç½®äº†databaseIdProviderï¼Œ_parameterå°±æœ‰å€¼
</span><span class="c">		  --&gt;</span>
		  
		  <span class="c">&lt;!-- ç»‘å®šä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼åˆ°ä¸€ä¸ªå˜é‡ï¼ˆä¸æ¨èï¼‰ --&gt;</span>
		<span class="nt">&lt;bind</span> <span class="na">name=</span><span class="s">&#34;_name&#34;</span> <span class="na">value=</span><span class="s">&#34;&#39;%&#39;+name+&#39;%&#39;&#34;</span><span class="nt">/&gt;</span>  
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;name!=null &amp;amp;&amp;amp; !name.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
			 t_name like #{_name} and
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;birth!=null&#34;</span><span class="nt">&gt;</span>
			 birth_date <span class="ni">&amp;lt;</span> #{birth} and
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;/trim&gt;</span>
		
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- public List&lt;Teacher&gt; getTeacherByIdIn(List&lt;Integer&gt; ids); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacherByIdIn&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
		SELECT * FROM t_teacher WHERE id IN 
		<span class="c">&lt;!-- å¸®æˆ‘ä»¬éå†é›†åˆçš„ï¼›
</span><span class="c">		collection=&#34;&#34;ï¼šæŒ‡å®šè¦éå†çš„é›†åˆçš„key
</span><span class="c">		close=&#34;&#34; ï¼šä»¥ä»€ä¹ˆç»“æŸ
</span><span class="c">		index=&#34;i&#34; ï¼šç´¢å¼•
</span><span class="c">			å¦‚æœéå†çš„æ˜¯ä¸€ä¸ªlistï¼š
</span><span class="c">				indexï¼šæŒ‡å®šçš„å˜é‡ä¿å­˜äº†å½“å‰ç´¢å¼•ï¼›
</span><span class="c">				itemï¼šå°±æ˜¯ä¿å­˜å½“å‰éå†çš„å…ƒç´ çš„å€¼ï¼›
</span><span class="c">			å¦‚æœéå†çš„æ˜¯ä¸€ä¸ªmapï¼š
</span><span class="c">				indexï¼šæŒ‡å®šçš„å˜é‡å°±æ˜¯ä¿å­˜äº†å½“å‰éå†çš„å…ƒç´ çš„key
</span><span class="c">				itemï¼šå°±æ˜¯ä¿å­˜å½“å‰éå†çš„å…ƒç´ çš„å€¼ï¼›
</span><span class="c">		item=&#34;å˜é‡å&#34; ï¼šæ¯æ¬¡éå†å‡ºçš„å…ƒç´ èµ·ä¸€ä¸ªå˜é‡åæ–¹ä¾¿å¼•ç”¨
</span><span class="c">		open=&#34;&#34; ï¼šä»¥ä»€ä¹ˆå¼€å§‹
</span><span class="c">		separator=&#34;&#34;ï¼šæ¯æ¬¡éå†å…ƒç´ çš„åˆ†éš”ç¬¦
</span><span class="c">		 --&gt;</span>
		 <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;ids.size &gt;0&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;ids&#34;</span> <span class="na">item=</span><span class="s">&#34;id_item&#34;</span> 
		<span class="na">open=</span><span class="s">&#34;(&#34;</span> <span class="na">close=</span><span class="s">&#34;)&#34;</span> <span class="na">separator=</span><span class="s">&#34;,&#34;</span><span class="nt">&gt;</span>
			#{id_item}
		<span class="nt">&lt;/foreach&gt;</span>
		<span class="nt">&lt;/if&gt;</span>
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- public List&lt;Teacher&gt; getTeacherByConditionChoose(Teacher teacher); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacherByConditionChoose&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
		SELECT * FROM t_teacher
		<span class="nt">&lt;where&gt;</span>
			<span class="nt">&lt;choose&gt;</span>
				<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;id!=null&#34;</span><span class="nt">&gt;</span>
					id=#{id}
				<span class="nt">&lt;/when&gt;</span>
				<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;name!=null and !name.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
					t_name=#{name}
				<span class="nt">&lt;/when&gt;</span>
				<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;birth!=null&#34;</span><span class="nt">&gt;</span>
					birth_date=#{birth}
				<span class="nt">&lt;/when&gt;</span>
				<span class="nt">&lt;otherwise&gt;</span>
					1=1
				<span class="nt">&lt;/otherwise&gt;</span>
			<span class="nt">&lt;/choose&gt;</span>
		<span class="nt">&lt;/where&gt;</span>
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- public int updateTeacher(Teacher teacher); --&gt;</span>
	<span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateTeacher&#34;</span><span class="nt">&gt;</span>
		UPDATE t_teacher
		<span class="nt">&lt;set&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;name!=null and !name.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
			t_name=#{name},
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;course!=null and !course.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
			class_name=#{course},
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;address!=null and !address.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
			address=#{address},
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;birth!=null&#34;</span><span class="nt">&gt;</span>
			birth_date=#{birth}
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;/set&gt;</span>
		<span class="nt">&lt;where&gt;</span>
			id=#{id}
		<span class="nt">&lt;/where&gt;</span>
	<span class="nt">&lt;/update&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h2 id="5mybatis-configxml-2">5ã€mybatis-config.xml</h2>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

	<span class="nt">&lt;settings&gt;</span>
		<span class="c">&lt;!-- å¼€å¯å»¶è¿ŸåŠ è½½å¼€å…³ --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;lazyLoadingEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- å¼€å¯å±æ€§æŒ‰éœ€åŠ è½½(é»˜è®¤å¼€å¯) --&gt;</span>
		<span class="c">&lt;!-- &lt;setting name=&#34;aggressiveLazyLoading&#34; value=&#34;false&#34;/&gt; --&gt;</span>
	<span class="nt">&lt;/settings&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/test?serverTimezone=UTC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
      <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<h2 id="6mybatistestjava-1">6ã€MyBatisTest.java</h2>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.TeacherDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisTest</span> <span class="o">{</span>

	<span class="c1">//å·¥å‚ä¸€ä¸ª
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
		
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">TeacherDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="cm">/*Teacher teacher = new Teacher();
</span><span class="cm">			teacher.setId(1);
</span><span class="cm">			teacher.setName(&#34;%a%&#34;);
</span><span class="cm">			//teacher.setBirth(new Date());
</span><span class="cm">			List&lt;Teacher&gt; list = mapper.getTeacherByCondition(teacher);*/</span>
			
			<span class="c1">//List&lt;Teacher&gt; list = mapper.getTeacherByIdIn(Arrays.asList(1,2,3,4,5));
</span><span class="c1"></span>			<span class="n">Teacher</span> <span class="n">teacher</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Teacher</span><span class="o">();</span>
			<span class="c1">//teacher.setId(1);
</span><span class="c1"></span>			<span class="c1">//teacher.setName(&#34;%a%&#34;);
</span><span class="c1"></span>			<span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherByConditionChoose</span><span class="o">(</span><span class="n">teacher</span><span class="o">);</span>
			
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">TeacherDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Teacher</span> <span class="n">teacher</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Teacher</span><span class="o">();</span>
			<span class="n">teacher</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">teacher</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;hahaha&#34;</span><span class="o">);</span>
			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">updateTeacher</span><span class="o">(</span><span class="n">teacher</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
		<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;java&#34;</span><span class="o">);</span>
		<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;c++&#34;</span><span class="o">);</span>
		<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;python&#34;</span><span class="o">);</span>
		<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
		<span class="k">while</span><span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()){</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h1 id="å…­ç¼“å­˜æœºåˆ¶">å…­ã€ç¼“å­˜æœºåˆ¶</h1>
<h2 id="1ç¼“å­˜ä½œç”¨">1ã€ç¼“å­˜ä½œç”¨</h2>
<ul>
<li>æš‚æ—¶çš„å­˜å‚¨ä¸€äº›æ•°æ®</li>
<li>åŠ å¿«ç³»ç»Ÿçš„æŸ¥è¯¢é€Ÿåº¦</li>
</ul>
<h2 id="2mybatisç¼“å­˜æœºåˆ¶">2ã€MyBatisç¼“å­˜æœºåˆ¶</h2>
<ul>
<li>
<p>Mapä¿å­˜æŸ¥è¯¢å‡ºçš„ä¸€äº›æ•°æ®</p>
</li>
<li>
<p><a href="#3%E3%80%81%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98">ä¸€çº§ç¼“å­˜</a></p>
<ul>
<li>çº¿ç¨‹çº§åˆ«çš„ç¼“å­˜</li>
<li>æœ¬åœ°ç¼“å­˜</li>
<li>SqlSessionçº§åˆ«çš„ç¼“å­˜</li>
<li>é»˜è®¤å­˜åœ¨</li>
</ul>
</li>
<li>
<p><a href="#4%E3%80%81%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98">äºŒçº§ç¼“å­˜</a></p>
<ul>
<li>å…¨å±€èŒƒå›´çš„ç¼“å­˜</li>
<li><strong>namespace</strong>çº§åˆ«çš„ç¼“å­˜</li>
<li>é™¤è¿‡å½“å‰çš„çº¿ç¨‹/SqlSessionèƒ½ç”¨å¤–å…¶ä»–ä¹Ÿå¯ä»¥ä½¿ç”¨</li>
</ul>
</li>
</ul>
<hr>
<h2 id="3ä¸€çº§ç¼“å­˜">3ã€ä¸€çº§ç¼“å­˜</h2>
<ul>
<li>åªè¦ä¹‹å‰æŸ¥è¯¢è¿‡çš„æ•°æ®ï¼Œmybatiså°±ä¼šä¿å­˜åœ¨ä¸€ä¸ªç¼“å­˜ä¸­ï¼ˆMapï¼‰</li>
<li>ä¸‹æ¬¡è·å–ç›´æ¥ä»ç¼“å­˜ä¸­æ‹¿</li>
</ul>
<h3 id="ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„å‡ ç§æƒ…å†µ">ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„å‡ ç§æƒ…å†µ</h3>
<ol>
<li>ä¸åŒçš„SqlSessionå¯¹åº”ä¸åŒçš„ä¸€çº§ç¼“å­˜</li>
<li>åŒä¸€ä¸ªSqlSessionä½†æ˜¯æŸ¥è¯¢æ¡ä»¶ä¸åŒ</li>
<li>åŒä¸€ä¸ªSqlSessionä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æ‰§è¡Œäº†ä»»ä½•ä¸€æ¬¡å¢åˆ æ”¹æ“ä½œ</li>
<li>åŒä¸€ä¸ªSqlSessionä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æ‰‹åŠ¨æ¸…ç©ºäº†ç¼“å­˜</li>
</ol>
<hr>
<h3 id="æºç ä½ç½®">æºç ä½ç½®</h3>
<ul>
<li>keyå¾ˆé•¿ï¼ˆæ•æ„Ÿï¼‰</li>
</ul>
<p><img src="https://i.loli.net/2020/12/18/jZ5kLDyefasgU8h.png" alt="image-20201218133253151"></p>
<hr>
<h2 id="4äºŒçº§ç¼“å­˜">4ã€äºŒçº§ç¼“å­˜</h2>
<ul>
<li><strong>Sqlsession</strong>å…³é—­æˆ–è€…æäº¤ä»¥åï¼Œä¸€çº§ç¼“å­˜çš„æ•°æ®ä¼šæ”¾åœ¨äºŒçº§ç¼“å­˜ä¸­</li>
<li>mybatisé»˜è®¤æ²¡æœ‰ä½¿ç”¨çš„</li>
</ul>
<h3 id="1äºŒçº§ç¼“å­˜çš„ä½¿ç”¨">1.äºŒçº§ç¼“å­˜çš„ä½¿ç”¨</h3>
<h4 id="1å…¨å±€é…ç½®å¼€å¯äºŒçº§ç¼“å­˜">1ã€å…¨å±€é…ç½®å¼€å¯äºŒçº§ç¼“å­˜</h4>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- å¼€å¯å…¨å±€ç¼“å­˜å¼€å…³(é»˜è®¤å¼€å¯) --&gt;</span>
<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</code></pre></div><hr>
<h4 id="2é…ç½®æŸä¸ªdaoxmlæ–‡ä»¶è®©å…¶ä½¿ç”¨äºŒçº§ç¼“å­˜">2ã€é…ç½®æŸä¸ªdao.xmlæ–‡ä»¶ï¼Œè®©å…¶ä½¿ç”¨äºŒçº§ç¼“å­˜</h4>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- ä½¿ç”¨äºŒçº§ç¼“å­˜ --&gt;</span>
<span class="nt">&lt;cache/&gt;</span>
</code></pre></div><hr>
<h3 id="2ç¼“å­˜åŸç†">2.ç¼“å­˜åŸç†</h3>
<p><img src="https://i.loli.net/2020/12/18/bpCKEyzc1tQOn4L.png" alt="image-20201218145239818"></p>
<hr>
<h2 id="5ç¼“å­˜æœ‰å…³è®¾ç½®">5ã€ç¼“å­˜æœ‰å…³è®¾ç½®</h2>
<h3 id="1å…¨å±€settingçš„cacheenable">1.å…¨å±€settingçš„cacheEnable</h3>
<ul>
<li>â€“é…ç½®äºŒçº§ç¼“å­˜çš„å¼€å…³ï¼ˆä¸€çº§ç¼“å­˜ä¸€ç›´æ˜¯æ‰“å¼€çš„ï¼‰</li>
</ul>
<h3 id="2selectæ ‡ç­¾çš„usecacheå±æ€§">2.selectæ ‡ç­¾çš„useCacheå±æ€§</h3>
<ul>
<li>â€“é…ç½®è¿™ä¸ª<strong>select</strong>æ˜¯å¦ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼ˆä¸€çº§ç¼“å­˜ä¸€ç›´æ˜¯ä½¿ç”¨çš„ï¼‰</li>
</ul>
<h3 id="3sqlæ ‡ç­¾çš„flushcacheå±æ€§">3.sqlæ ‡ç­¾çš„flushCacheå±æ€§</h3>
<ul>
<li>â€“sqlæ‰§è¡Œä»¥åï¼Œä¼šåŒæ—¶æ¸…ç©ºä¸€çº§å’ŒäºŒçº§ç¼“å­˜</li>
<li>å¢åˆ æ”¹é»˜è®¤flushCache=true</li>
<li>æŸ¥è¯¢é»˜è®¤flushCache=false</li>
</ul>
<h3 id="4sqlsessionclearcache">4.sqlSession.clearCache()</h3>
<ul>
<li>â€“åªæ˜¯ç”¨æ¥æ¸…é™¤ä¸€çº§ç¼“å­˜</li>
<li>å½“åœ¨æŸä¸€ä¸ªä½œç”¨åŸŸ (ä¸€çº§ç¼“å­˜Session/äºŒçº§ç¼“å­˜Namespaces) è¿›è¡Œäº† C/U/D æ“ä½œåï¼Œé»˜è®¤è¯¥ä½œç”¨åŸŸä¸‹<strong>æ‰€æœ‰</strong> <strong>select</strong> ä¸­çš„ç¼“å­˜å°†è¢«clear</li>
</ul>
<hr>
<h2 id="6æ•´åˆç¬¬ä¸‰æ–¹ç¼“å­˜">6ã€æ•´åˆç¬¬ä¸‰æ–¹ç¼“å­˜</h2>
<ul>
<li>MyBatis&mdash;&ndash;Cacheæ¥å£</li>
<li>æ•´åˆ<strong>ehcache</strong>ï¼ˆéå¸¸ä¸“ä¸šçš„javaè¿›ç¨‹å†…çš„ç¼“å­˜æ¡†æ¶ï¼‰</li>
</ul>
<hr>
<h3 id="1å¯¼åŒ…">1.å¯¼åŒ…</h3>
<blockquote>
<p>ehcache-core-2.6.11.jarï¼ˆehcacheæ ¸å¿ƒåŒ…ï¼‰
mybatis-ehcache-1.2.1.jarï¼ˆehcacheçš„æ•´åˆåŒ…ï¼‰</p>
<p>slf4j-api-1.7.30.jar
slf4j-log4j12-1.7.30.jar</p>
<hr>
</blockquote>
<h3 id="2ehcacheé…ç½®æ–‡ä»¶">2.ehcacheé…ç½®æ–‡ä»¶</h3>
<ul>
<li>æ–‡ä»¶åå«<a href="#5.echcache.xml"><strong>ehcache.xml</strong></a></li>
<li>æ”¾åœ¨ç±»è·¯å¾„çš„æ ¹ç›®å½•ä¸‹ï¼ˆ<strong>conf</strong>ä¸‹ï¼‰</li>
</ul>
<h3 id="3åœ¨mapperxmlä¸­é…ç½®ä½¿ç”¨è‡ªå®šä¹‰çš„ç¼“å­˜">3.åœ¨mapper.xmlä¸­é…ç½®ä½¿ç”¨è‡ªå®šä¹‰çš„ç¼“å­˜</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- ä½¿ç”¨mybatisé»˜è®¤äºŒçº§ç¼“å­˜&lt;cache /&gt; --&gt;</span>
<span class="nt">&lt;cache</span> <span class="na">type=</span><span class="s">&#34;org.mybatis.caches.ehcache.EhcacheCache&#34;</span> <span class="nt">/&gt;</span>
</code></pre></div><hr>
<h3 id="4åˆ«çš„daoè¿˜è¦ç”¨è¿™ä¸ªç¼“å­˜">4.åˆ«çš„daoè¿˜è¦ç”¨è¿™ä¸ªç¼“å­˜</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- å’Œåˆ«çš„daoå…±ç”¨ä¸€å—ç¼“å­˜ --&gt;</span>
<span class="nt">&lt;cache-ref</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.TeacherDao&#34;</span><span class="nt">/&gt;</span>
</code></pre></div><hr>
<h3 id="5echcachexml">5.echcache.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;ehcache</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
 <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">&#34;../config/ehcache.xsd&#34;</span><span class="nt">&gt;</span>
 <span class="c">&lt;!-- ç£ç›˜ä¿å­˜è·¯å¾„ --&gt;</span>
 <span class="nt">&lt;diskStore</span> <span class="na">path=</span><span class="s">&#34;D:\44\ehcache&#34;</span> <span class="nt">/&gt;</span>
 
 <span class="nt">&lt;defaultCache</span> 
   <span class="na">maxElementsInMemory=</span><span class="s">&#34;1&#34;</span> 
   <span class="na">maxElementsOnDisk=</span><span class="s">&#34;10000000&#34;</span>
   <span class="na">eternal=</span><span class="s">&#34;false&#34;</span> 
   <span class="na">overflowToDisk=</span><span class="s">&#34;true&#34;</span> 
   <span class="na">timeToIdleSeconds=</span><span class="s">&#34;120&#34;</span>
   <span class="na">timeToLiveSeconds=</span><span class="s">&#34;120&#34;</span> 
   <span class="na">diskExpiryThreadIntervalSeconds=</span><span class="s">&#34;120&#34;</span>
   <span class="na">memoryStoreEvictionPolicy=</span><span class="s">&#34;LRU&#34;</span><span class="nt">&gt;</span>
 <span class="nt">&lt;/defaultCache&gt;</span>
<span class="nt">&lt;/ehcache&gt;</span>
 
<span class="c">&lt;!-- 
</span><span class="c">å±æ€§è¯´æ˜ï¼š
</span><span class="c">l diskStoreï¼šæŒ‡å®šæ•°æ®åœ¨ç£ç›˜ä¸­çš„å­˜å‚¨ä½ç½®ã€‚
</span><span class="c">l defaultCacheï¼šå½“å€ŸåŠ©CacheManager.add(&#34;demoCache&#34;)åˆ›å»ºCacheæ—¶ï¼ŒEhCacheä¾¿ä¼šé‡‡ç”¨&lt;defalutCache/&gt;æŒ‡å®šçš„çš„ç®¡ç†ç­–ç•¥
</span><span class="c"> 
</span><span class="c">ä»¥ä¸‹å±æ€§æ˜¯å¿…é¡»çš„ï¼š
</span><span class="c">l maxElementsInMemory - åœ¨å†…å­˜ä¸­ç¼“å­˜çš„elementçš„æœ€å¤§æ•°ç›® 
</span><span class="c">l maxElementsOnDisk - åœ¨ç£ç›˜ä¸Šç¼“å­˜çš„elementçš„æœ€å¤§æ•°ç›®ï¼Œè‹¥æ˜¯0è¡¨ç¤ºæ— ç©·å¤§
</span><span class="c">l eternal - è®¾å®šç¼“å­˜çš„elementsæ˜¯å¦æ°¸è¿œä¸è¿‡æœŸã€‚å¦‚æœä¸ºtrueï¼Œåˆ™ç¼“å­˜çš„æ•°æ®å§‹ç»ˆæœ‰æ•ˆï¼Œå¦‚æœä¸ºfalseé‚£ä¹ˆè¿˜è¦æ ¹æ®timeToIdleSecondsï¼ŒtimeToLiveSecondsåˆ¤æ–­
</span><span class="c">l overflowToDisk - è®¾å®šå½“å†…å­˜ç¼“å­˜æº¢å‡ºçš„æ—¶å€™æ˜¯å¦å°†è¿‡æœŸçš„elementç¼“å­˜åˆ°ç£ç›˜ä¸Š
</span><span class="c"> 
</span><span class="c">ä»¥ä¸‹å±æ€§æ˜¯å¯é€‰çš„ï¼š
</span><span class="c">l timeToIdleSeconds - å½“ç¼“å­˜åœ¨EhCacheä¸­çš„æ•°æ®å‰åä¸¤æ¬¡è®¿é—®çš„æ—¶é—´è¶…è¿‡timeToIdleSecondsçš„å±æ€§å–å€¼æ—¶ï¼Œè¿™äº›æ•°æ®ä¾¿ä¼šåˆ é™¤ï¼Œé»˜è®¤å€¼æ˜¯0,ä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§
</span><span class="c">l timeToLiveSeconds - ç¼“å­˜elementçš„æœ‰æ•ˆç”Ÿå‘½æœŸï¼Œé»˜è®¤æ˜¯0.,ä¹Ÿå°±æ˜¯elementå­˜æ´»æ—¶é—´æ— ç©·å¤§
</span><span class="c"> diskSpoolBufferSizeMB è¿™ä¸ªå‚æ•°è®¾ç½®DiskStore(ç£ç›˜ç¼“å­˜)çš„ç¼“å­˜åŒºå¤§å°.é»˜è®¤æ˜¯30MB.æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒº.
</span><span class="c">l diskPersistent - åœ¨VMé‡å¯çš„æ—¶å€™æ˜¯å¦å¯ç”¨ç£ç›˜ä¿å­˜EhCacheä¸­çš„æ•°æ®ï¼Œé»˜è®¤æ˜¯falseã€‚
</span><span class="c">l diskExpiryThreadIntervalSeconds - ç£ç›˜ç¼“å­˜çš„æ¸…ç†çº¿ç¨‹è¿è¡Œé—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚æ¯ä¸ª120sï¼Œç›¸åº”çš„çº¿ç¨‹ä¼šè¿›è¡Œä¸€æ¬¡EhCacheä¸­æ•°æ®çš„æ¸…ç†å·¥ä½œ
</span><span class="c">l memoryStoreEvictionPolicy - å½“å†…å­˜ç¼“å­˜è¾¾åˆ°æœ€å¤§ï¼Œæœ‰æ–°çš„elementåŠ å…¥çš„æ—¶å€™ï¼Œ ç§»é™¤ç¼“å­˜ä¸­elementçš„ç­–ç•¥ã€‚é»˜è®¤æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ï¼Œå¯é€‰çš„æœ‰LFUï¼ˆæœ€ä¸å¸¸ä½¿ç”¨ï¼‰å’ŒFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰
</span><span class="c"> --&gt;</span>
</code></pre></div><hr>
<h3 id="6mybatistestjava-2">6.MyBatisTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.TeacherDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisTest</span> <span class="o">{</span>

	<span class="c1">//å·¥å‚ä¸€ä¸ª
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
		
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * ä½“ä¼šä¸€çº§ç¼“å­˜
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">TeacherDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Teacher</span> <span class="n">teacherById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;=========================&#34;</span><span class="o">);</span>
			<span class="n">Teacher</span> <span class="n">teacherById2</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById2</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById</span> <span class="o">==</span> <span class="n">teacherById2</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„å‡ ç§æƒ…å†µ
</span><span class="cm">	 * ä¸€çº§ç¼“å­˜æ˜¯SqlSessionçº§åˆ«çš„ç¼“å­˜ï¼›
</span><span class="cm">	 * 1ã€ä¸åŒçš„sqlSessionä½¿ç”¨ä¸åŒçš„ä¸€çº§ç¼“å­˜ï¼›
</span><span class="cm">	 * 		åªæœ‰åœ¨åŒä¸€ä¸ªsqlSessionæœŸé—´æŸ¥è¯¢åˆ°çš„æ•°æ®ä¼šä¿å­˜åœ¨è¿™ä¸ªsqlSessionçš„ç¼“å­˜ä¸­ï¼›
</span><span class="cm">	 * 		ä¸‹æ¬¡ä½¿ç”¨ä¸ªè¿™ä¸ªsqlSessionæŸ¥è¯¢ä¼šä»ç¼“å­˜ä¸­æ‹¿ã€‚
</span><span class="cm">	 * 2ã€åŒä¸€ä¸ªæ–¹æ³•ï¼Œä¸åŒçš„å‚æ•°ï¼Œç”±äºå¯èƒ½ä¹‹å‰æ²¡æŸ¥è¿‡ï¼Œæ‰€ä»¥è¿˜ä¼šå‘æ–°çš„sqlï¼›
</span><span class="cm">	 * 3ã€åœ¨è¿™ä¸ªsqlSessionæœŸé—´æ‰§è¡Œä»»ä½•ä¸€æ¬¡å¢åˆ æ”¹æ“ä½œï¼Œä¼šæŠŠç¼“å­˜æ¸…ç©ºï¼›
</span><span class="cm">	 * 4ã€æ‰‹åŠ¨æ¸…ç©ºäº†ç¼“å­˜ï¼›
</span><span class="cm">	 * 
</span><span class="cm">	 * æ¯æ¬¡æŸ¥è¯¢ï¼Œå…ˆçœ‹ä¸€çº§ç¼“å­˜ä¸­æœ‰æ²¡æœ‰ï¼Œå¦‚æœæ²¡æœ‰å°±å»å‘é€æ–°çš„sqlï¼›æ¯ä¸ªsqlSessionæ‹¥æœ‰è‡ªå·±çš„ä¸€çº§ç¼“å­˜ï¼›
</span><span class="cm">	 * 
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="c1">//1ã€ç¬¬ä¸€ä¸ªä¼šè¯
</span><span class="c1"></span>		<span class="n">TeacherDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">Teacher</span> <span class="n">teacher1</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;============================&#34;</span><span class="o">);</span>
		<span class="c1">//æ‰§è¡Œä»»ä½•ä¸€ä¸ªå¢åˆ æ”¹æ“ä½œ
</span><span class="c1"></span>		<span class="cm">/*Teacher teacher = new Teacher();
</span><span class="cm">		teacher.setId(3);
</span><span class="cm">		teacher.setName(&#34;3333&#34;);
</span><span class="cm">		mapper.updateTeacher(teacher);*/</span>
		
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;æ‰‹åŠ¨æ¸…ç©ºç¼“å­˜&#34;</span><span class="o">);</span>
		<span class="c1">//æ¸…ç©ºå½“å‰sqlSessionçš„ä»¥åŠç¼“å­˜
</span><span class="c1"></span>		<span class="c1">//openSession.clearCache();
</span><span class="c1"></span>		
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;============================&#34;</span><span class="o">);</span>
		<span class="n">Teacher</span> <span class="n">teacher2</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher2</span><span class="o">);</span>
		
		<span class="c1">//2ã€ç¬¬äºŒä¸ªä¼šè¯
</span><span class="c1"></span>		<span class="cm">/*SqlSession openSession2 = sqlSessionFactory.openSession();
</span><span class="cm">		TeacherDao mapper2 = openSession2.getMapper(TeacherDao.class);
</span><span class="cm">		Teacher teacher2 = mapper2.getTeacherById(1);
</span><span class="cm">		System.out.println(teacher2);*/</span>
		
		<span class="n">openSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
		<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="c1">//openSession2.close();
</span><span class="c1"></span>	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * ä½“éªŒäºŒçº§ç¼“å­˜
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test03</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">SqlSession</span> <span class="n">openSession2</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">TeacherDao</span> <span class="n">mapper1</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">TeacherDao</span> <span class="n">mapper2</span> <span class="o">=</span> <span class="n">openSession2</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		
		<span class="c1">//1ã€ç¬¬ä¸€ä¸ªdaoæŸ¥è¯¢1å·teacher
</span><span class="c1"></span>		<span class="n">Teacher</span> <span class="n">teacher1</span> <span class="o">=</span> <span class="n">mapper1</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher1</span><span class="o">);</span>
		<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		
		<span class="c1">//1ã€ç¬¬äºŒä¸ªdaoæŸ¥è¯¢1å·teacher
</span><span class="c1"></span>		<span class="n">Teacher</span> <span class="n">teacher2</span> <span class="o">=</span> <span class="n">mapper2</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher2</span><span class="o">);</span>
		<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 
</span><span class="cm">	 * 1ã€ä¸ä¼šå‡ºç°ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ä¸­æœ‰åŒä¸€ä¸ªæ•°æ®ï¼š
</span><span class="cm">	 * 		äºŒçº§ç¼“å­˜ä¸­ï¼Œä¸€çº§ç¼“å­˜å…³é—­äº†å°±æœ‰äº†ï¼›
</span><span class="cm">	 * 		ä¸€çº§ç¼“å­˜ä¸­ï¼ŒäºŒçº§ç¼“å­˜ä¸­æ²¡æœ‰æ­¤æ•°æ®ï¼Œå°±ä¼šçœ‹ä¸€çº§ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜æ²¡æœ‰å°±å»æŸ¥è¯¢æ•°æ®åº“
</span><span class="cm">	 * 2ã€ä»»ä½•æ—¶å€™éƒ½æ˜¯å…ˆçœ‹äºŒçº§ç¼“å­˜ï¼Œå†çœ‹ä¸€çº§ç¼“å­˜ï¼Œå¦‚æœå¤§å®¶éƒ½æ²¡æœ‰å°±å»æŸ¥è¯¢æ•°æ®åº“ï¼›
</span><span class="cm">	 * äºŒ-----ã€‹ä¸€====ã€‹åº“
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test04</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">TeacherDao</span> <span class="n">teacherDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">Teacher</span> <span class="n">teacher</span> <span class="o">=</span> <span class="n">teacherDao</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher</span><span class="o">);</span>
		<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;===============&#34;</span><span class="o">);</span>
		
		<span class="n">SqlSession</span> <span class="n">openSession2</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">TeacherDao</span> <span class="n">teacherDao2</span> <span class="o">=</span> <span class="n">openSession2</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">Teacher</span> <span class="n">teacherById</span> <span class="o">=</span> <span class="n">teacherDao2</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById</span><span class="o">);</span>
		
		<span class="n">Teacher</span> <span class="n">teacherById2</span> <span class="o">=</span> <span class="n">teacherDao2</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById2</span><span class="o">);</span>
		
		
		<span class="cm">/*Teacher teacherById2 = teacherDao2.getTeacherById(1);
</span><span class="cm">		System.out.println(teacherById2);
</span><span class="cm">		
</span><span class="cm">		System.out.println(&#34;ä»¥ä¸‹æ˜¯æŸ¥è¯¢äºŒå·teacherï¼š&#34;);
</span><span class="cm">		Teacher teacherById3 = teacherDao2.getTeacherById(2);
</span><span class="cm">		System.out.println(teacherById3);
</span><span class="cm">		Teacher teacherById4 = teacherDao2.getTeacherById(2);
</span><span class="cm">		System.out.println(teacherById4);
</span><span class="cm">		*/</span>
		<span class="n">openSession2</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
	
	
<span class="o">}</span>
</code></pre></div><hr>
<hr>
<h1 id="ä¸ƒssmæ•´åˆ">ä¸ƒã€SSMæ•´åˆ</h1>
<ul>
<li><strong>SSM</strong>
<ul>
<li><strong>Spring</strong>+<strong>SpringMVC</strong>+<strong>MyBatis</strong></li>
</ul>
</li>
</ul>
<h2 id="1å¯¼åŒ…-1">1ã€å¯¼åŒ…</h2>
<h3 id="1spring">1.Spring</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="err">ã€</span><span class="n">aopæ ¸å¿ƒ</span><span class="err">ã€‘</span>
<span class="n">com</span><span class="o">.</span><span class="na">springsource</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">sf</span><span class="o">.</span><span class="na">cglib</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">com</span><span class="o">.</span><span class="na">springsource</span><span class="o">.</span><span class="na">org</span><span class="o">.</span><span class="na">aopalliance</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">com</span><span class="o">.</span><span class="na">springsource</span><span class="o">.</span><span class="na">org</span><span class="o">.</span><span class="na">aspectj</span><span class="o">.</span><span class="na">weaver</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">6</span><span class="o">.</span><span class="na">8</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">aspects</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">ã€</span><span class="n">iocæ ¸å¿ƒ</span><span class="err">ã€‘</span>
<span class="n">commons</span><span class="o">-</span><span class="n">logging</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">3</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">aop</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">beans</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">context</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">expression</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">ã€</span><span class="n">jdbcæ ¸å¿ƒ</span><span class="err">ã€‘</span>
<span class="n">spring</span><span class="o">-</span><span class="n">jdbc</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">orm</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">tx</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>

<span class="err">ã€</span><span class="n">æµ‹è¯•</span><span class="err">ã€‘</span>
<span class="n">spring</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
   
</code></pre></div><hr>
<h3 id="2springmvc">2.SpringMVC</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="err">ã€</span><span class="n">Ajax</span><span class="err">ã€‘</span>
<span class="n">jackson</span><span class="o">-</span><span class="n">annotations</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">12</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">jackson</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">12</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">jackson</span><span class="o">-</span><span class="n">databind</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">12</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>

<span class="err">ã€</span><span class="n">æ•°æ®æ ¡éªŒ</span><span class="err">ã€‘</span>
<span class="n">hibernate</span><span class="o">-</span><span class="n">validator</span><span class="o">-</span><span class="n">6</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">7</span><span class="o">.</span><span class="na">Final</span><span class="o">.</span><span class="na">jar</span>
<span class="n">hibernate</span><span class="o">-</span><span class="n">validator</span><span class="o">-</span><span class="n">annotation</span><span class="o">-</span><span class="n">processor</span><span class="o">-</span><span class="n">6</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">7</span><span class="o">.</span><span class="na">Final</span><span class="o">.</span><span class="na">jar</span>
<span class="n">classmate</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">5</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">jar</span>
<span class="n">jboss</span><span class="o">-</span><span class="n">logging</span><span class="o">-</span><span class="n">3</span><span class="o">.</span><span class="na">4</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">Final</span><span class="o">.</span><span class="na">jar</span>
<span class="n">validation</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">Final</span><span class="o">.</span><span class="na">jar</span>

<span class="err">ã€</span><span class="n">ä¸Šä¼ ä¸‹è½½</span><span class="err">ã€‘</span>
<span class="n">commons</span><span class="o">-</span><span class="n">fileupload</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">4</span><span class="o">.</span><span class="na">jar</span>
<span class="n">commons</span><span class="o">-</span><span class="n">io</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">8</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">ã€</span><span class="n">jstl</span><span class="o">-</span><span class="n">jspæ ‡å‡†æ ‡ç­¾åº“</span><span class="err">ã€‘</span>
<span class="n">jstl</span><span class="o">.</span><span class="na">jar</span>
<span class="n">standard</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">ã€</span><span class="n">éªŒè¯ç </span><span class="err">ã€‘</span>   
<span class="n">kaptcha</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">3</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">jar</span>  
    
<span class="err">ã€</span><span class="n">SpringMVCæ ¸å¿ƒ</span><span class="err">ã€‘</span>
<span class="n">spring</span><span class="o">-</span><span class="n">web</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">webmvc</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
</code></pre></div><hr>
<h3 id="3mybatis">3.MyBatis</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="err">ã€</span><span class="n">mybatisæ ¸å¿ƒ</span><span class="err">ã€‘</span>
<span class="n">mybatis</span><span class="o">-</span><span class="n">3</span><span class="o">.</span><span class="na">5</span><span class="o">.</span><span class="na">6</span><span class="o">.</span><span class="na">jar</span>

<span class="err">ã€</span><span class="n">å’Œspringçš„æ•´åˆåŒ…</span><span class="err">ã€‘</span>
<span class="n">mybatis</span><span class="o">-</span><span class="n">spring</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">6</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">ã€</span><span class="n">ehcacheæ•´åˆ</span><span class="err">ã€‘</span>
<span class="n">ehcache</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">6</span><span class="o">.</span><span class="na">11</span><span class="o">.</span><span class="na">jar</span>
<span class="n">mybatis</span><span class="o">-</span><span class="n">ehcache</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">jar</span>
<span class="n">log4j</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">17</span><span class="o">.</span><span class="na">jar</span>
<span class="n">slf4j</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">7</span><span class="o">.</span><span class="na">30</span><span class="o">.</span><span class="na">jar</span>
<span class="n">slf4j</span><span class="o">-</span><span class="n">log4j12</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">7</span><span class="o">.</span><span class="na">30</span><span class="o">.</span><span class="na">jar</span>
</code></pre></div><hr>
<h3 id="4å…¶ä»–çš„">4.å…¶ä»–çš„</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//æ•°æ®æºï¼Œé©±åŠ¨
</span><span class="c1"></span><span class="n">mysql</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="n">java</span><span class="o">-</span><span class="n">8</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">22</span><span class="o">.</span><span class="na">jar</span>
<span class="n">c3p0</span><span class="o">-</span><span class="n">0</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">5</span><span class="o">.</span><span class="na">5</span><span class="o">.</span><span class="na">jar</span>
<span class="n">mchange</span><span class="o">-</span><span class="n">commons</span><span class="o">-</span><span class="n">java</span><span class="o">-</span><span class="n">0</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">20</span><span class="o">.</span><span class="na">jar</span>
<span class="c1">//åˆ†é¡µæ’ä»¶
</span><span class="c1"></span><span class="n">pagehelper</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">jsqlparser</span><span class="o">-</span><span class="n">3</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">jar</span>
</code></pre></div><hr>
<h3 id="5æ€»è§ˆ">5.æ€»è§ˆï¼š</h3>
<p><img src="https://i.loli.net/2020/12/21/8P1X24gnHdcoNf3.png" alt="image-20201221101143992"></p>
<hr>
<h2 id="2å†™é…ç½®-1">2ã€å†™é…ç½®</h2>
<h3 id="0webxml">0.web.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;web-app</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span class="na">xmlns=</span><span class="s">&#34;http://xmlns.jcp.org/xml/ns/javaee&#34;</span> <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&#34;</span> <span class="na">id=</span><span class="s">&#34;WebApp_ID&#34;</span> <span class="na">version=</span><span class="s">&#34;3.1&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;display-name&gt;</span>7.SSM<span class="nt">&lt;/display-name&gt;</span>
  <span class="nt">&lt;welcome-file-list&gt;</span>
    <span class="nt">&lt;welcome-file&gt;</span>index.jsp<span class="nt">&lt;/welcome-file&gt;</span>
  <span class="nt">&lt;/welcome-file-list&gt;</span>
  
  <span class="c">&lt;!-- é…ç½®Springå®¹å™¨å¯åŠ¨ --&gt;</span>
  <span class="c">&lt;!-- needed for ContextLoaderListener --&gt;</span>
	<span class="nt">&lt;context-param&gt;</span>
		<span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
		<span class="c">&lt;!-- æŒ‡å®šSpringé…ç½®æ–‡ä»¶ä½ç½® --&gt;</span>
		<span class="nt">&lt;param-value&gt;</span>classpath:spring/applicationContext.xml<span class="nt">&lt;/param-value&gt;</span>
	<span class="nt">&lt;/context-param&gt;</span>

	<span class="c">&lt;!-- Bootstraps the root web application context before servlet initialization --&gt;</span>
	<span class="nt">&lt;listener&gt;</span>
		<span class="nt">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="nt">&lt;/listener-class&gt;</span>
	<span class="nt">&lt;/listener&gt;</span>
	
	<span class="c">&lt;!-- é…ç½®springmvcçš„å‰ç«¯æ§åˆ¶å™¨ --&gt;</span>
	<span class="c">&lt;!-- The front controller of this Spring Web application, responsible for handling all application requests --&gt;</span>
	<span class="nt">&lt;servlet&gt;</span>
		<span class="nt">&lt;servlet-name&gt;</span>springDispatcherServlet<span class="nt">&lt;/servlet-name&gt;</span>
		<span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
		<span class="nt">&lt;init-param&gt;</span>
			<span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
			<span class="nt">&lt;param-value&gt;</span>classpath:spring/applicationContext-mvc.xml<span class="nt">&lt;/param-value&gt;</span>
		<span class="nt">&lt;/init-param&gt;</span>
		<span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
	<span class="nt">&lt;/servlet&gt;</span>

	<span class="c">&lt;!-- Map all requests to the DispatcherServlet for handling --&gt;</span>
	<span class="nt">&lt;servlet-mapping&gt;</span>
		<span class="nt">&lt;servlet-name&gt;</span>springDispatcherServlet<span class="nt">&lt;/servlet-name&gt;</span>
		<span class="nt">&lt;url-pattern&gt;</span>/<span class="nt">&lt;/url-pattern&gt;</span>
	<span class="nt">&lt;/servlet-mapping&gt;</span>
	
	<span class="c">&lt;!-- ä¸¤ä¸ªæ ‡å‡†é…ç½® --&gt;</span>
	<span class="c">&lt;!-- å­—ç¬¦ç¼–ç  --&gt;</span>
	<span class="c">&lt;!-- &lt;filter&gt;
</span><span class="c">		&lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt;
</span><span class="c">		&lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
</span><span class="c">		&lt;init-param&gt;
</span><span class="c">			&lt;param-name&gt;encoding&lt;/param-name&gt;
</span><span class="c">			&lt;param-value&gt;utf-8&lt;/param-value&gt;
</span><span class="c">		&lt;/init-param&gt;
</span><span class="c">		&lt;init-param&gt;
</span><span class="c">			&lt;param-name&gt;forceRequestEncoding&lt;/param-name&gt;
</span><span class="c">			&lt;param-value&gt;true&lt;/param-value&gt;
</span><span class="c">		&lt;/init-param&gt;
</span><span class="c">		&lt;init-param&gt;
</span><span class="c">			&lt;param-name&gt;forceResponseEncoding&lt;/param-name&gt;
</span><span class="c">			&lt;param-value&gt;true&lt;/param-value&gt;
</span><span class="c">		&lt;/init-param&gt;
</span><span class="c">	&lt;/filter&gt;
</span><span class="c">	&lt;filter-mapping&gt;
</span><span class="c">		&lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt;
</span><span class="c">		&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
</span><span class="c">	&lt;/filter-mapping&gt; --&gt;</span>
	
	<span class="c">&lt;!-- æ”¯æŒResté£æ ¼çš„è¿‡æ»¤å™¨ --&gt;</span>
	<span class="nt">&lt;filter&gt;</span>
		<span class="nt">&lt;filter-name&gt;</span>HiddenHttpMethodFilter<span class="nt">&lt;/filter-name&gt;</span>
		<span class="nt">&lt;filter-class&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="nt">&lt;/filter-class&gt;</span>
	<span class="nt">&lt;/filter&gt;</span>
	<span class="nt">&lt;filter-mapping&gt;</span>
		<span class="nt">&lt;filter-name&gt;</span>HiddenHttpMethodFilter<span class="nt">&lt;/filter-name&gt;</span>
		<span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
	<span class="nt">&lt;/filter-mapping&gt;</span>
<span class="nt">&lt;/web-app&gt;</span>
</code></pre></div><hr>
<h3 id="1springçš„é…ç½®">1.springçš„é…ç½®</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
	<span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
	<span class="na">xmlns:aop=</span><span class="s">&#34;http://www.springframework.org/schema/aop&#34;</span>
	<span class="na">xmlns:tx=</span><span class="s">&#34;http://www.springframework.org/schema/tx&#34;</span>
	<span class="na">xmlns:context=</span><span class="s">&#34;http://www.springframework.org/schema/context&#34;</span>
	<span class="na">xmlns:mybatis-spring=</span><span class="s">&#34;http://mybatis.org/schema/mybatis-spring&#34;</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://mybatis.org/schema/mybatis-spring http://mybatis.org/schema/mybatis-spring-1.2.xsd
</span><span class="s">		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class="s">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd
</span><span class="s">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.3.xsd
</span><span class="s">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.3.xsd&#34;</span><span class="nt">&gt;</span>

	<span class="c">&lt;!-- Springé™¤è¿‡æ§åˆ¶å™¨ä¸è¦ï¼Œå‰©ä¸‹çš„ä¸šåŠ¡é€»è¾‘ç»„ä»¶éƒ½è¦ï¼ˆåŒ…æ‹¬daoï¼Œserviceã€‚ã€‚ï¼‰ --&gt;</span>
	<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.lql&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- æ‰«ææ’é™¤ä¸å†™use-default-filters=&#34;false&#34; --&gt;</span>
		<span class="nt">&lt;context:exclude-filter</span> <span class="na">type=</span><span class="s">&#34;annotation&#34;</span> <span class="na">expression=</span><span class="s">&#34;org.springframework.stereotype.Controller&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/context:component-scan&gt;</span>
	
	<span class="c">&lt;!-- 0ã€å¯¼å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶ --&gt;</span>
	<span class="nt">&lt;context:property-placeholder</span> <span class="na">location=</span><span class="s">&#34;classpath:dbconfig.properties&#34;</span><span class="nt">/&gt;</span>
	<span class="c">&lt;!-- 1ã€é…æ•°æ®æº --&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;ds&#34;</span> <span class="na">class=</span><span class="s">&#34;com.mchange.v2.c3p0.ComboPooledDataSource&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;user&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.user}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.password}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driverClass&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.driverClass}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;jdbcUrl&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.jdbcUrl}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;maxPoolSize&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.maxPoolSize}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;minPoolSize&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.minPoolSize}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="c">&lt;!-- 2ã€é…ç½®JdbcTemplateæ“ä½œæ•°æ®åº“ï¼ˆpassï¼‰ --&gt;</span>
	<span class="c">&lt;!-- 3ã€é…ç½®ä½¿ç”¨mybatisæ“ä½œæ•°æ®åº“ --&gt;</span>
	<span class="c">&lt;!-- å¯ä»¥æ ¹æ®é…ç½®æ–‡ä»¶å¾—åˆ°SqlSessionFactory --&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;sqlSessionFactoryBean&#34;</span> <span class="na">class=</span><span class="s">&#34;org.mybatis.spring.SqlSessionFactoryBean&#34;</span><span class="nt">&gt;</span>
		
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;ds&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="c">&lt;!-- æŒ‡å®šxmlæ˜ å°„æ–‡ä»¶çš„ä½ç½® --&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;mapperLocations&#34;</span> <span class="na">value=</span><span class="s">&#34;classpath:mybatis/mapper/*.xml&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		
		<span class="c">&lt;!-- æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½® --&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;configLocation&#34;</span> <span class="na">value=</span><span class="s">&#34;classpath:mybatis/mybatis-config.xml&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	<span class="c">&lt;!-- æˆ‘ä»¬è¦æŠŠæ¯ä¸€ä¸ªdaoæ¥å£çš„å®ç°åŠ å…¥åˆ°iocå®¹å™¨ --&gt;</span>
	<span class="c">&lt;!-- &lt;bean class=&#34;org.mybatis.spring.mapper.MapperScannerConfigurer&#34;&gt;
</span><span class="c">		æŒ‡å®šdaoæ¥å£æ‰€åœ¨çš„åŒ…
</span><span class="c">		&lt;property name=&#34;basePackage&#34; value=&#34;com.lql.dao&#34;&gt;&lt;/property&gt;
</span><span class="c">	&lt;/bean&gt; --&gt;</span>
	<span class="c">&lt;!-- æ›¿æ¢ä¸Šé¢çš„ç®€å•å†™æ³• --&gt;</span>
	<span class="nt">&lt;mybatis-spring:scan</span> <span class="na">base-package=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">/&gt;</span>
	
	<span class="c">&lt;!-- 4ã€é…ç½®äº‹åŠ¡æ§åˆ¶ï¼ˆé…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œè®©ä»–æ§åˆ¶ä½æ•°æ®æºé‡Œé¢çš„è¿æ¥çš„å…³é—­å’Œæäº¤ï¼‰ --&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;tm&#34;</span> <span class="na">class=</span><span class="s">&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;ds&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="c">&lt;!-- 5ã€åŸºäºxmlé…ç½®ï¼Œé…ç½®äº‹åŠ¡ï¼ˆå“ªäº›æ–¹æ³•åˆ‡å…¥äº‹åŠ¡ï¼Œè¿˜è¦å†™åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼‰ --&gt;</span>
	<span class="nt">&lt;aop:config&gt;</span>
		<span class="c">&lt;!-- é…ç½®åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ --&gt;</span>
		<span class="nt">&lt;aop:pointcut</span> <span class="na">expression=</span><span class="s">&#34;execution(* com.lql.service.*.*(..))&#34;</span> <span class="na">id=</span><span class="s">&#34;txPoint&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;aop:advisor</span> <span class="na">advice-ref=</span><span class="s">&#34;myTx&#34;</span> <span class="na">pointcut-ref=</span><span class="s">&#34;txPoint&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/aop:config&gt;</span>
	
	<span class="c">&lt;!-- 6ã€é…ç½®äº‹åŠ¡å¢å¼ºã€äº‹åŠ¡å±æ€§ã€äº‹åŠ¡å»ºè®®
</span><span class="c">	transaction-manager=&#34;tm&#34;ï¼šæŒ‡å®šè¦é…ç½®çš„äº‹åŠ¡ç®¡ç†å™¨çš„id
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;tx:advice</span> <span class="na">id=</span><span class="s">&#34;myTx&#34;</span> <span class="na">transaction-manager=</span><span class="s">&#34;tm&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- é…ç½®äº‹åŠ¡å±æ€§ --&gt;</span>
		<span class="nt">&lt;tx:attributes&gt;</span>
			<span class="nt">&lt;tx:method</span> <span class="na">name=</span><span class="s">&#34;*&#34;</span> <span class="na">rollback-for=</span><span class="s">&#34;java.lang.Exception&#34;</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;tx:method</span> <span class="na">name=</span><span class="s">&#34;get*&#34;</span> <span class="na">read-only=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
			<span class="c">&lt;!-- &lt;tx:method name=&#34;insertEmp&#34; isolation=&#34;READ_UNCOMMITTED&#34;/&gt; --&gt;</span>
		<span class="nt">&lt;/tx:attributes&gt;</span>
	<span class="nt">&lt;/tx:advice&gt;</span>

<span class="nt">&lt;/beans&gt;</span>

</code></pre></div><hr>
<h3 id="2springmvcçš„é…ç½®">2.springmvcçš„é…ç½®</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
	<span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
	<span class="na">xmlns:context=</span><span class="s">&#34;http://www.springframework.org/schema/context&#34;</span>
	<span class="na">xmlns:mvc=</span><span class="s">&#34;http://www.springframework.org/schema/mvc&#34;</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd
</span><span class="s">		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class="s">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd&#34;</span><span class="nt">&gt;</span>
		
	<span class="c">&lt;!-- SpringMVCåªæ‰«ææ§åˆ¶å™¨;ç¦ç”¨é»˜è®¤çš„è§„åˆ™ --&gt;</span>
	<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.lql&#34;</span> <span class="na">use-default-filters=</span><span class="s">&#34;false&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;context:include-filter</span> <span class="na">type=</span><span class="s">&#34;annotation&#34;</span> <span class="na">expression=</span><span class="s">&#34;org.springframework.stereotype.Controller&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/context:component-scan&gt;</span>
	
	<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;org.springframework.web.servlet.view.InternalResourceViewResolver&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;prefix&#34;</span> <span class="na">value=</span><span class="s">&#34;/WEB-INF/pages&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;suffix&#34;</span> <span class="na">value=</span><span class="s">&#34;.jsp&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="c">&lt;!-- é…ç½®æ–‡ä»¶ä¸Šä¼ è§£æå™¨ --&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;multipartResolver&#34;</span> <span class="na">class=</span><span class="s">&#34;org.springframework.web.multipart.commons.CommonsMultipartResolver&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;defaultEncoding&#34;</span> <span class="na">value=</span><span class="s">&#34;utf-8&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;maxUploadSize&#34;</span> <span class="na">value=</span><span class="s">&#34;#{1024*1024*20}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="c">&lt;!-- æ‰«æé™æ€èµ„æº --&gt;</span>
	<span class="nt">&lt;mvc:default-servlet-handler/&gt;</span>
	<span class="c">&lt;!-- æ‰«æåŠ¨æ€èµ„æº --&gt;</span>
	<span class="nt">&lt;mvc:annotation-driven&gt;&lt;/mvc:annotation-driven&gt;</span>
<span class="nt">&lt;/beans&gt;</span>

</code></pre></div><hr>
<h3 id="3mybatisçš„é…ç½®">3.mybatisçš„é…ç½®</h3>
<ul>
<li><a href="#1.spring%E7%9A%84%E9%85%8D%E7%BD%AE">æ•´åˆçš„å…³é”®é…ç½®</a></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 2ã€é…ç½®JdbcTemplateæ“ä½œæ•°æ®åº“ï¼ˆpassï¼‰ --&gt;</span>
<span class="c">&lt;!-- 3ã€é…ç½®ä½¿ç”¨mybatisæ“ä½œæ•°æ®åº“ --&gt;</span>
<span class="c">&lt;!-- å¯ä»¥æ ¹æ®é…ç½®æ–‡ä»¶å¾—åˆ°SqlSessionFactory --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;sqlSessionFactoryBean&#34;</span> <span class="na">class=</span><span class="s">&#34;org.mybatis.spring.SqlSessionFactoryBean&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½® --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;configLocation&#34;</span> <span class="na">value=</span><span class="s">&#34;classpath:mybatis/mybatis-config.xml&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;ds&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
    <span class="c">&lt;!-- æŒ‡å®šxmlæ˜ å°„æ–‡ä»¶çš„ä½ç½® --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;mapperLocations&#34;</span> <span class="na">value=</span><span class="s">&#34;classpath:mybatis/mapper/*.xml&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
<span class="c">&lt;!-- æˆ‘ä»¬è¦æŠŠæ¯ä¸€ä¸ªdaoæ¥å£çš„å®ç°åŠ å…¥åˆ°iocå®¹å™¨ --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;org.mybatis.spring.mapper.MapperScannerConfigurer&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- æŒ‡å®šdaoæ¥å£æ‰€åœ¨çš„åŒ… --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;basePackage&#34;</span> <span class="na">value=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div><h4 id="mybatis-configxml">mybatis-config.xml</h4>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

	<span class="nt">&lt;settings&gt;</span>
		<span class="c">&lt;!-- å¼€å¯å»¶è¿ŸåŠ è½½å¼€å…³ --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;lazyLoadingEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- å¼€å¯å±æ€§æŒ‰éœ€åŠ è½½(é»˜è®¤å¼€å¯) --&gt;</span>
		<span class="c">&lt;!-- &lt;setting name=&#34;aggressiveLazyLoading&#34; value=&#34;false&#34;/&gt; --&gt;</span>
		<span class="c">&lt;!-- å¼€å¯å…¨å±€ç¼“å­˜å¼€å…³(é»˜è®¤å¼€å¯) --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/settings&gt;</span>
	
    <span class="c">&lt;!-- é…ç½®åˆ†é¡µæ’ä»¶ --&gt;</span>
	<span class="nt">&lt;plugins&gt;</span>
		<span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">&#34;com.github.pagehelper.PageInterceptor&#34;</span><span class="nt">&gt;&lt;/plugin&gt;</span>
	<span class="nt">&lt;/plugins&gt;</span>
  
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<hr>
<h2 id="3æµ‹è¯•åˆ†é¡µåŠŸèƒ½">3ã€æµ‹è¯•ï¼ˆåˆ†é¡µåŠŸèƒ½ï¼‰</h2>
<h3 id="1controller">1.controller</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.controller</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.github.pagehelper.PageHelper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.github.pagehelper.PageInfo</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.bean.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.service.TeacherService</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TeacherController</span> <span class="o">{</span>

	<span class="nd">@Autowired</span>
	<span class="n">TeacherService</span> <span class="n">teacherService</span><span class="o">;</span>
	
	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/getTea&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getTeacher</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">&#34;id&#34;</span><span class="o">,</span><span class="n">defaultValue</span><span class="o">=</span><span class="s">&#34;1&#34;</span><span class="o">)</span><span class="n">Integer</span> <span class="n">id</span><span class="o">,</span><span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
		<span class="n">Teacher</span> <span class="n">t</span> <span class="o">=</span> <span class="n">teacherService</span><span class="o">.</span><span class="na">getTeacher</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
		<span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;teacher&#34;</span><span class="o">,</span> <span class="n">t</span><span class="o">);</span>
		<span class="k">return</span> <span class="s">&#34;success&#34;</span><span class="o">;</span>
	<span class="o">}</span>
	
	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/getAll&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getAll</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">&#34;pn&#34;</span><span class="o">,</span><span class="n">defaultValue</span><span class="o">=</span><span class="s">&#34;1&#34;</span><span class="o">)</span><span class="n">Integer</span> <span class="n">pn</span><span class="o">,</span><span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
		<span class="c1">//ç´§è·Ÿä»–çš„æŸ¥è¯¢å°±æ˜¯ä¸€ä¸ªåˆ†é¡µæŸ¥è¯¢
</span><span class="c1"></span>		<span class="n">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="n">pn</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">teacherService</span><span class="o">.</span><span class="na">getAll</span><span class="o">();</span>
		
		<span class="c1">//å°†æŸ¥è¯¢çš„ç»“æœæ”¾åœ¨pageinfoä¸­è¿™ä¸ªpageInfoå°±æœ‰éå¸¸å¤šèƒ½å¤Ÿç”¨çš„
</span><span class="c1"></span>		<span class="c1">//ç¬¬äºŒä»½ä¼ å…¥è¿ç»­è¦æ˜¾ç¤ºçš„é¡µç 
</span><span class="c1"></span>		<span class="n">PageInfo</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="n">pageInfo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PageInfo</span><span class="o">&lt;&gt;(</span><span class="n">list</span><span class="o">,</span><span class="n">6</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;å½“å‰é¡µç ï¼š&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPageNum</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;æ€»é¡µç ï¼š&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPages</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;æ€»è®°å½•æ•°ï¼š&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getTotal</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;å½“å‰é¡µæœ‰å‡ æ¡è®°å½•ï¼š&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getSize</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;å½“å‰é¡µçš„pageSizeï¼š&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;å‰ä¸€é¡µï¼š&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPrePage</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ç»“æœï¼š&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getList</span><span class="o">());</span><span class="c1">//æŸ¥è¯¢ç»“æœ
</span><span class="c1"></span>		<span class="kt">int</span><span class="o">[]</span> <span class="n">nums</span> <span class="o">=</span> <span class="n">pageInfo</span><span class="o">.</span><span class="na">getNavigatepageNums</span><span class="o">();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">nums</span><span class="o">);</span>
		<span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;pageInfo&#34;</span><span class="o">,</span><span class="n">pageInfo</span><span class="o">);</span>
		<span class="k">return</span> <span class="s">&#34;success&#34;</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="2successjsp">2.success.jsp</h3>
<pre><code class="language-jsp" data-lang="jsp">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;
    pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%@taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;æˆåŠŸï¼&lt;/h1&gt;
${teacher }
&lt;table cellpadding=&quot;5&quot; cellspacing=&quot;0&quot; border=&quot;1&quot;&gt;
	&lt;tr&gt;
		&lt;th&gt;id&lt;/th&gt;
		&lt;th&gt;name&lt;/th&gt;
		&lt;th&gt;course&lt;/th&gt;
		&lt;th&gt;address&lt;/th&gt;
	&lt;/tr&gt;
	&lt;c:forEach items=&quot;${pageInfo.list}&quot; var=&quot;tea&quot;&gt;
		&lt;tr&gt;
			&lt;td&gt;${tea.id}&lt;/td&gt;
			&lt;td&gt;${tea.name}&lt;/td&gt;
			&lt;td&gt;${tea.course}&lt;/td&gt;
			&lt;td&gt;æ–°åŸåŒº&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/c:forEach&gt;
	&lt;tr&gt;
		&lt;td colspan=&quot;4&quot;&gt;
			&lt;a href=&quot;getAll?pn=1&quot;&gt;é¦–é¡µ&lt;/a&gt;&lt;a href=&quot;getAll?pn=${pageInfo.prePage }&quot;&gt;ä¸Šä¸€é¡µ&lt;/a&gt;  
			
			&lt;c:forEach items=&quot;${pageInfo.navigatepageNums}&quot; var=&quot;num&quot;&gt;
				&lt;c:if test=&quot;${num == pageInfo.pageNum}&quot;&gt;
					ã€${num}ã€‘
				&lt;/c:if&gt;
				
				&lt;c:if test=&quot;${num != pageInfo.pageNum}&quot;&gt;
					&lt;a href=&quot;getAll?pn=${num}&quot;&gt;${num}&lt;/a&gt;
				&lt;/c:if&gt;
				
				
			&lt;/c:forEach&gt;
			
			&lt;a href=&quot;getAll?pn=${pageInfo.nextPage}&quot;&gt;ä¸‹ä¸€é¡µ&lt;/a&gt;&lt;a href=&quot;getAll?pn=${pageInfo.pages}&quot;&gt;æœ«é¡µ&lt;/a&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h2 id="4å·¥ç¨‹ç»“æ„">4ã€å·¥ç¨‹ç»“æ„ï¼š</h2>
<p><img src="https://i.loli.net/2020/12/21/WE1bhfmy5GInYp7.png" alt="image-20201221134106225"></p>
<hr>
<h1 id="å…«mbg">å…«ã€MBG</h1>
<ul>
<li><strong>MyBatis Generator</strong>ï¼ˆä»£ç ç”Ÿæˆå™¨ï¼‰</li>
<li><strong>MyBatis</strong>å®˜æ–¹æä¾›</li>
<li>å¸®æˆ‘ä»¬é€†å‘ç”Ÿæˆ</li>
</ul>
<h2 id="1æ­£å‘">1ã€æ­£å‘</h2>
<ul>
<li>table&mdash;ã€‹JavaBean&mdash;-ã€‹BookDao&mdash;-ã€‹dao.xml&mdash;-ã€‹xxx</li>
</ul>
<h2 id="2é€†å‘å·¥ç¨‹">2ã€é€†å‘å·¥ç¨‹</h2>
<ul>
<li>æ ¹æ®æ•°æ®è¡¨tableï¼Œé€†å‘åˆ†ææ•°æ®è¡¨ï¼Œè‡ªåŠ¨ç”Ÿæˆ JavaBean&mdash;-ã€‹BookDao&mdash;-ã€‹dao.xml&mdash;-ã€‹xxx</li>
</ul>
<hr>
<h2 id="3é…ç½®æ­¥éª¤">3ã€é…ç½®æ­¥éª¤</h2>
<h3 id="1å¯¼åŒ…-2">1.å¯¼åŒ…</h3>
<ul>
<li>mbgçš„æ ¸å¿ƒåŒ…</li>
</ul>
<blockquote>
<p>mybatis-generator-core-1.4.0.jar</p>
<hr>
</blockquote>
<h3 id="2é…ç½®">2.é…ç½®</h3>
<ul>
<li>æ–°å»º<strong>xml</strong>é…ç½®æ–‡ä»¶</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE generatorConfiguration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&#34;&gt;</span>

<span class="nt">&lt;generatorConfiguration&gt;</span>

  <span class="c">&lt;!-- MyBatis3Simpleï¼šç®€å•ç‰ˆ --&gt;</span>
  <span class="nt">&lt;context</span> <span class="na">id=</span><span class="s">&#34;DB2Tables&#34;</span> <span class="na">targetRuntime=</span><span class="s">&#34;MyBatis3&#34;</span><span class="nt">&gt;</span>
 	 <span class="c">&lt;!-- jdbcConnectionï¼šæŒ‡å¯¼è¿æ¥åˆ°å“ªä¸ªæ•°æ®åº“ --&gt;</span>
    <span class="nt">&lt;jdbcConnection</span> <span class="na">driverClass=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span>
        <span class="na">connectionURL=</span><span class="s">&#34;jdbc:mysql://localhost:3306/test?serverTimezone=UTC&#34;</span>
        <span class="na">userId=</span><span class="s">&#34;root&#34;</span>
        <span class="na">password=</span><span class="s">&#34;123456&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/jdbcConnection&gt;</span>

    <span class="nt">&lt;javaTypeResolver</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;forceBigDecimals&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/javaTypeResolver&gt;</span>
	
	<span class="c">&lt;!-- javaModelGeneratorï¼šç”Ÿæˆpojo
</span><span class="c">	targetPackageï¼šç”Ÿæˆçš„pojoæ”¾åœ¨å“ªä¸ªåŒ…
</span><span class="c">	targetProjectï¼šæ”¾åœ¨å“ªä¸ªå·¥ç¨‹ä¸‹
</span><span class="c">	 --&gt;</span>
    <span class="nt">&lt;javaModelGenerator</span> <span class="na">targetPackage=</span><span class="s">&#34;com.lql.bean&#34;</span> <span class="na">targetProject=</span><span class="s">&#34;.\src&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;trimStrings&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/javaModelGenerator&gt;</span>
	
	<span class="c">&lt;!-- sqlMapGeneratorï¼šsqlæ˜ å°„æ–‡ä»¶ç”Ÿæˆå™¨ï¼ˆæŒ‡å®šxmlç”Ÿæˆçš„åœ°æ–¹ï¼‰ --&gt;</span>
    <span class="nt">&lt;sqlMapGenerator</span> <span class="na">targetPackage=</span><span class="s">&#34;com.lql.dao&#34;</span>  <span class="na">targetProject=</span><span class="s">&#34;.\conf&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/sqlMapGenerator&gt;</span>
	
	<span class="c">&lt;!-- javaClientGeneratorï¼šç”Ÿæˆdaoæ¥å£ --&gt;</span>
    <span class="nt">&lt;javaClientGenerator</span> <span class="na">type=</span><span class="s">&#34;XMLMAPPER&#34;</span> <span class="na">targetPackage=</span><span class="s">&#34;com.lql.dao&#34;</span>  <span class="na">targetProject=</span><span class="s">&#34;.\src&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/javaClientGenerator&gt;</span>
	
	<span class="c">&lt;!-- tableï¼šæŒ‡å®šè¦é€†å‘ç”Ÿæˆå“ªä¸ªæ•°æ®è¡¨
</span><span class="c">	tableName=&#34;t_cat&#34;ï¼šè¡¨å
</span><span class="c">	domainObjectName=&#34;Cat&#34;ï¼šè¿™ä¸ªè¡¨å¯¹åº”çš„å¯¹è±¡å
</span><span class="c">	 --&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;t_cat&#34;</span> <span class="na">domainObjectName=</span><span class="s">&#34;Cat&#34;</span> <span class="nt">&gt;&lt;/table&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;employee&#34;</span> <span class="na">domainObjectName=</span><span class="s">&#34;Employee&#34;</span> <span class="nt">&gt;&lt;/table&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;t_teacher&#34;</span> <span class="na">domainObjectName=</span><span class="s">&#34;Teacher&#34;</span> <span class="nt">&gt;&lt;/table&gt;</span>

  <span class="nt">&lt;/context&gt;</span>
<span class="nt">&lt;/generatorConfiguration&gt;</span>
</code></pre></div><h3 id="3mbgç”Ÿæˆä»£ç ">3.mbgç”Ÿæˆä»£ç </h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.mybatis.generator.api.MyBatisGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mybatis.generator.config.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mybatis.generator.config.xml.ConfigurationParser</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mybatis.generator.exception.XMLParserException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mybatis.generator.internal.DefaultShellCallback</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MBGTest</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">warnings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
		<span class="kt">boolean</span> <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
		<span class="n">File</span> <span class="n">configFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&#34;mbg.xml&#34;</span><span class="o">);</span>
		<span class="n">ConfigurationParser</span> <span class="n">cp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConfigurationParser</span><span class="o">(</span><span class="n">warnings</span><span class="o">);</span>
		<span class="n">Configuration</span> <span class="n">config</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="na">parseConfiguration</span><span class="o">(</span><span class="n">configFile</span><span class="o">);</span>
		<span class="n">DefaultShellCallback</span> <span class="n">callback</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultShellCallback</span><span class="o">(</span><span class="n">overwrite</span><span class="o">);</span>
		<span class="n">MyBatisGenerator</span> <span class="n">myBatisGenerator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyBatisGenerator</span><span class="o">(</span><span class="n">config</span><span class="o">,</span> <span class="n">callback</span><span class="o">,</span> <span class="n">warnings</span><span class="o">);</span>
		<span class="c1">//ä»£ç ç”Ÿæˆ
</span><span class="c1"></span>		<span class="n">myBatisGenerator</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ç”ŸæˆğŸ†—äº†ï¼&#34;</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h1 id="æ³¨ä¸mybatisç›¸å…³çš„é…ç½®jaråŒ…å®˜æ–¹æ–‡æ¡£ç­‰éƒ½å¯ä»¥åˆ°githubhttpsgithubcommybatisä¸­æŸ¥æ‰¾"><strong>==æ³¨ï¼šä¸mybatisç›¸å…³çš„é…ç½®jaråŒ…ï¼Œå®˜æ–¹æ–‡æ¡£ç­‰éƒ½å¯ä»¥åˆ°<a href="https://github.com/mybatis/">GitHub</a>ä¸­æŸ¥æ‰¾==</strong></h1>

    
	</div>
  <footer class="article-footer clearfix">
  

<div class="article-tags">
  <span></span>
  
  <a href="https://qianlong98.github.io/tags/mybatis">MyBatis</a>
  
  <a href="https://qianlong98.github.io/tags/%E7%AC%94%E8%AE%B0">ç¬”è®°</a>
  
</div>





<div class="article-categories">
  <span></span>
  
  <a class="article-category-link" href="https://qianlong98.github.io/categories/%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0">ä¸ªäººå­¦ä¹ ç¬”è®°</a>
  
</div>



  <div class="article-share" id="share">
    <div data-url="https://qianlong98.github.io/post/mybatis%E5%AD%A6%E4%B9%A0/" data-title="MyBatiså­¦ä¹ " data-tsina="1816308191" class="share clearfix">
    </div>
  </div>
</footer>

	</article>
  


<section class="comment">
<div id="disqus_thread"></div>
</section>
<script>
  
  var xhr = new XMLHttpRequest();
  xhr.open('GET', '//disqus.com/next/config.json?' + new Date().getTime(), true);
  xhr.timeout = 3000; 

  xhr.onload = function() { 


var disqus_config = function () {
this.page.url = "https:\/\/qianlong98.github.io\/post\/mybatis%E5%AD%A6%E4%B9%A0\/"
this.page.identifier = "https:\/\/qianlong98.github.io\/post\/mybatis%E5%AD%A6%E4%B9%A0\/"
};
(function() { 
var d = document, s = d.createElement('script');

s.src = '//qianlong98.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
}
  xhr.ontimeout = function() {
  
  return;
}
xhr.send(null);
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</div>

    <div class="openaside"><a class="navbutton" href="#" title="æ˜¾ç¤ºä¾§è¾¹æ "></a></div>
<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="éšè—ä¾§è¾¹æ "></a></div>
<aside class="clearfix">
  

<div class="categorieslist">
  <p class="asidetitle">åˆ†ç±»</p>
  <ul>
    
    <li><a href="https://qianlong98.github.io/categories/%e4%b8%aa%e4%ba%ba%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" title="ä¸ªäººå­¦ä¹ ç¬”è®°">ä¸ªäººå­¦ä¹ ç¬”è®°<sup>7</sup></a></li>
    
    <li><a href="https://qianlong98.github.io/categories/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0-%e5%8e%9f%e5%88%9b" title="æŠ€æœ¯æ–‡ç« -åŸåˆ›">æŠ€æœ¯æ–‡ç« -åŸåˆ›<sup>1</sup></a></li>
    
    <li><a href="https://qianlong98.github.io/categories/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0-%e8%bd%ac%e8%bd%bd" title="æŠ€æœ¯æ–‡ç« -è½¬è½½">æŠ€æœ¯æ–‡ç« -è½¬è½½<sup>2</sup></a></li>
    
  </ul>
</div>



  

<div class="tagslist">
	<p class="asidetitle">æ ‡ç­¾</p>
		<ul class="clearfix">
      
			<li><a href="https://qianlong98.github.io/tags/blog" title="blog">blog<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/git" title="git">git<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/hibernate" title="hibernate">hibernate<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/javascript" title="javascript">javascript<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/maven" title="maven">maven<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/mybatis" title="mybatis">mybatis<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/mysql" title="mysql">mysql<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/spring" title="spring">spring<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/spring-boot" title="spring-boot">spring-boot<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/spring-mvc" title="spring-mvc">spring-mvc<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/web" title="web">web<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/%e6%95%b0%e6%8d%ae%e5%ba%93" title="æ•°æ®åº“">æ•°æ®åº“<sup>2</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/%e7%ac%94%e8%ae%b0" title="ç¬”è®°">ç¬”è®°<sup>5</sup></a></li>
      
		</ul>
</div>



  
  <div class="archiveslist">
    <p class="asidetitle">å½’æ¡£</p>
    <ul class="archive-list">
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://qianlong98.github.io/post/#2020-12">2020å¹´12æœˆ</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://qianlong98.github.io/post/#2020-11">2020å¹´11æœˆ</a><span class="archive-list-count">5</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://qianlong98.github.io/post/#2020-10">2020å¹´10æœˆ</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://qianlong98.github.io/post/#2020-09">2020å¹´09æœˆ</a><span class="archive-list-count">2</span>
      </li>
      
    </ul>

  </div>


  

<div class="tagcloudlist">
  <p class="asidetitle">æ ‡ç­¾äº‘</p>
  <div class="tagcloudlist clearfix">
    
    <a href="https://qianlong98.github.io/tags/blog" style="font-size: 12px;">blog</a>
    
    <a href="https://qianlong98.github.io/tags/git" style="font-size: 12px;">git</a>
    
    <a href="https://qianlong98.github.io/tags/hibernate" style="font-size: 12px;">hibernate</a>
    
    <a href="https://qianlong98.github.io/tags/javascript" style="font-size: 12px;">javascript</a>
    
    <a href="https://qianlong98.github.io/tags/maven" style="font-size: 12px;">maven</a>
    
    <a href="https://qianlong98.github.io/tags/mybatis" style="font-size: 12px;">mybatis</a>
    
    <a href="https://qianlong98.github.io/tags/mysql" style="font-size: 12px;">mysql</a>
    
    <a href="https://qianlong98.github.io/tags/spring" style="font-size: 12px;">spring</a>
    
    <a href="https://qianlong98.github.io/tags/spring-boot" style="font-size: 12px;">spring-boot</a>
    
    <a href="https://qianlong98.github.io/tags/spring-mvc" style="font-size: 12px;">spring-mvc</a>
    
    <a href="https://qianlong98.github.io/tags/web" style="font-size: 12px;">web</a>
    
    <a href="https://qianlong98.github.io/tags/%e6%95%b0%e6%8d%ae%e5%ba%93" style="font-size: 12px;">æ•°æ®åº“</a>
    
    <a href="https://qianlong98.github.io/tags/%e7%ac%94%e8%ae%b0" style="font-size: 12px;">ç¬”è®°</a>
    
  </div>
</div>



  

</aside>
</div>

  </div>
  <footer><div id="footer" >
  <div class="line">
    <span></span>
    
    <div style='background:no-repeat url("https://qianlong98.github.io/img/author.jpg") left top;-webkit-background-size:6.875em 6.875em;-moz-background-size:6.875em 6.875em;background-size:6.875em 6.875em;' class="author" ></div>
  </div>
  <section class="info">
    <p>ä¸è¦å†ç”˜äºå¹³åº¸ <br/> åšäººä¸Šäººè¦æœ‰é‡å¿ƒ</p>
  </section>
  <div class="social-font clearfix">
    <a href='http://weibo.com/qianlong98' target="_blank" title="weibo"></a>
    
    <a href='https://github.com/qianlong98' target="_blank" title="github"></a>
    
  
  </div>
  <p class="copyright">Powered by <a href="http://gohugo.io" target="_blank" title="hugo">hugo</a> and Name by <a href="https://weibo.com/u/6969049127?refer_flag=1005050005_&is_all=1" target="_blank" title="èŠ±ç”Ÿå¸†">èŠ±ç”Ÿå¸†å°å§å§</a> Â© 2021
    
    <a href="https://qianlong98.github.io/" title="ä»£ç L">ä»£ç L</a>
    
  </p>
</div>

</footer>
  <script src="https://qianlong98.github.io/js/jquery-2.1.0.min.js"></script>

<script src="https://qianlong98.github.io/js/qrcode.js"></script>
<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:https:\/\/qianlong98.github.io\/ ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>æ‰«æäºŒç»´ç åˆ†äº«åˆ°å¾®ä¿¡æœ‹å‹åœˆ</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="https://b.bshare.cn/barCode?site=weixin&url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});
</script>


<link rel="stylesheet" href="https://qianlong98.github.io/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="https://qianlong98.github.io/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>




</body>
</html>
