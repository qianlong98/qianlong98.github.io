<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-180310890-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-180310890-1');
</script>

  <meta charset="UTF-8">
  <title>MyBatis学习 - 代码L</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="一、MyBatis简介 0、MyBatis官方中文文档 1、MyBatis 和数据库进行交互 持久化层框架（SQL映射框架） 半自动框架 前身是iBat">
  
  <meta itemprop="name" content="MyBatis学习 - 代码L">
  <meta itemprop="description" content="一、MyBatis简介 0、MyBatis官方中文文档 1、MyBatis 和数据库进行交互 持久化层框架（SQL映射框架） 半自动框架 前身是iBat">
  <meta itemprop="image" content="https://qianlong98.github.io/img/author.jpg">
  
  
  <meta name="twitter:description" content="">
  
  <link rel="shortcut icon" href="https://qianlong98.github.io/img/favicon.ico"/>
  <link rel="apple-touch-icon" href="https://qianlong98.github.io/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="https://qianlong98.github.io/apple-touch-icon.png" />
  <link rel="stylesheet" href="https://qianlong98.github.io/highlight/styles/github.css">
  <script src="https://qianlong98.github.io/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  <link rel="stylesheet" href="https://qianlong98.github.io/font/hack/css/hack.min.css">
  <link rel="stylesheet" href="https://qianlong98.github.io/css/style.css">
</head>

<body>
  <header>
    <div>
  <div id="imglogo">
    <a href="https://qianlong98.github.io/"><img src='https://qianlong98.github.io/img/logo.svg' alt="代码L" title="代码L"/></a>
  </div>
  <div id="textlogo">
    <h1 class="site-name"><a href="https://qianlong98.github.io/" title="代码L">代码L</a></h1>
    <h2 class="blog-motto">一个勇敢的快乐boy</h2>
  </div>
  <div class="navbar"><a class="navbutton navmobile" href="#" title="menu"></a></div>
  <nav class="animated">
    <ul>
      
      
      <li><a href="/">首页</a></li>
      
      <li><a href="/about">关于</a></li>
      
      
      <li>
        <form class="search" method="get" action="https://www.google.com/search">
          <div>
            <input type="text" id="search" name="q" placeholder='搜索'>
          </div>
        </form>
      </li>
    </ul>
  </nav>
</div>

  </header>
  <div id="container">
    <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody">
    <header class="article-info clearfix">
  <h1 itemprop="name">
      <a href="https://qianlong98.github.io/post/mybatis%E5%AD%A6%E4%B9%A0/" title="MyBatis学习" itemprop="url">MyBatis学习</a>
  </h1>
  <p class="article-author">By
    
      <a href="https://qianlong98.github.io/post/" title="萤火">萤火</a>
    
  </p>
  <p class="article-time">
    <time datetime="2020-12-09 16:00:25 &#43;0800 CST" itemprop="datePublished">2020年12月09日</time>
  </p>
</header>

	<div class="article-content">
    
    <hr>
<h1 id="一mybatis简介">一、MyBatis简介</h1>
<h2 id="0mybatis官方中文文档httpsmybatisorgmybatis-3zhindexhtml"><a href="https://mybatis.org/mybatis-3/zh/index.html">0、MyBatis官方中文文档</a></h2>
<h2 id="1mybatis">1、MyBatis</h2>
<ul>
<li>和数据库进行交互</li>
<li>持久化层框架（SQL映射框架）</li>
<li>半自动框架</li>
<li>前身是<strong>iBatis</strong></li>
</ul>
<hr>
<h2 id="2持久化层技术">2、持久化层技术</h2>
<ul>
<li>原始的JDBC&ndash;&gt;dbutils（QueryRunner）&ndash;&gt;JdbcTemplate&ndash;&gt;等等</li>
</ul>
<p>称为<strong>工具</strong></p>
<ul>
<li>一些功能的简单封装</li>
</ul>
<p><strong>框架</strong></p>
<ul>
<li>某些领域的整体解决方案
<ul>
<li>要考虑<strong>缓存</strong>，异常处理问题，部分字段映射问题等</li>
</ul>
</li>
</ul>
<hr>
<h3 id="不用原生jdbc原因">不用原生JDBC原因</h3>
<ul>
<li>
<p>麻烦（使用流程）</p>
<p><img src="https://i.loli.net/2020/12/14/aFd2ImhOsgvEDGt.png" alt="image-20201214103213154"></p>
<hr>
</li>
<li>
<p><strong>sql语句是硬编码在程序中的</strong></p>
<ul>
<li>耦合（数据库层和java编码耦合）</li>
</ul>
</li>
</ul>
<hr>
<h2 id="3hibernate">3、Hibernate</h2>
<ul>
<li>数据库库交互的框架（<strong>ORM</strong>框架）
<ul>
<li><strong>ORM</strong>（Object Relation Mapping）对象关系映射</li>
<li>全自动的框架</li>
</ul>
</li>
</ul>
<h3 id="1优点">1.优点</h3>
<ul>
<li>方便</li>
</ul>
<p><img src="https://i.loli.net/2020/12/14/A6XJtGTwr8u3yxK.png" alt="image-20201214104326397"></p>
<hr>
<h3 id="2缺点">2.缺点</h3>
<ol>
<li>无法定制sql（二八理论）</li>
<li>要学<strong>HQL</strong>（Hibernate Query Language）（反模式）</li>
<li>全映射框架（做部分字段映射很难）</li>
</ol>
<hr>
<p><strong>希望</strong></p>
<ul>
<li>最好有一个框架
<ul>
<li>支持定制化sql</li>
<li>功能强大</li>
<li>sql也不要硬编码在java文件中（导致维护修改起来比较麻烦）</li>
</ul>
</li>
</ul>
<h2 id="4mybatis应运而生">4、MyBatis应运而生</h2>
<ol>
<li>
<p>MyBatis将重要的步骤抽取出来可以人工定制，其他步骤自动化</p>
<p><img src="https://i.loli.net/2020/12/14/lLSeVmBpXkYsPTU.png" alt="image-20201214110226659"></p>
<hr>
</li>
<li>
<p>重要步骤都是写在配置文件中（好维护）</p>
</li>
<li>
<p>完全解决数据库的优化问题</p>
</li>
<li>
<p><strong>MyBatis</strong>底层就是对原生<strong>JDBC</strong>的一个简单封装</p>
</li>
<li>
<p>既将java编码与sql抽取了出来，还不会失去自动化功能（<strong>半自动化的持久化层框架</strong>）</p>
</li>
<li>
<p><strong>mybatis</strong>是一个轻量级的框架</p>
</li>
</ol>
<hr>
<h1 id="二helloworld">二、HelloWorld</h1>
<h2 id="1环境搭建">1、环境搭建</h2>
<h3 id="1创建一个java工程">1.创建一个java工程</h3>
<h3 id="2创建测试库">2.创建测试库</h3>
<ul>
<li>测试表，封装数据的javaBean和操作数据库的dao接口</li>
</ul>
<h3 id="3用mybatis操作数据库">3.用MyBatis操作数据库</h3>
<h4 id="1导包建议导入日志包">1、导包（建议导入日志包）</h4>
<blockquote>
<p>mybatis-3.5.6.jar</p>
<p>mysql-connector-java-8.0.22.jar</p>
<p>log4j-1.2.17.jar（可选）</p>
</blockquote>
<ul>
<li>log4j（日志框架）：依赖类路径下一个log4j.xml配置文件</li>
</ul>
<hr>
<h4 id="2写配置">2、写配置</h4>
<ol>
<li>
<p>第一个配置文件（==全局配置文件==）（<strong>mybatis-config.xml</strong>）</p>
<ul>
<li>==指导mybatis==正确==运行==的一些全局设置（比如连接哪个数据库）</li>
</ul>
</li>
<li>
<p>第二个配置文件（==SQL映射文件==）（<strong>EmployeeDao.xml</strong>）</p>
<ul>
<li>
<p>编写每一个方法如何向数据库发送sql语句，如何执行（相当于==对Dao接口的一个实现描述==）</p>
<ol>
<li>
<p>将<strong>mapper</strong>的<strong>namespace</strong>属性改为接口的全类名</p>
</li>
<li>
<p>配置细节</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- namespace：名称空间，写接口的全类名；相当于告诉MyBatis这个配置文件是实现哪个接口的 --&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
        
    <span class="c">&lt;!-- public Employee getEmpById(Integer id); --&gt;</span>
    <span class="c">&lt;!-- select：用来定义一个查询操作；
</span><span class="c">    id：方法名，相当于这个配置是对于某个方法的实现
</span><span class="c">    resultType：指定方法运行后的返回值类型（查询操作必须指定的）
</span><span class="c">    #{属性名}：代表取出传递过来的某个参数的值
</span><span class="c">     --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
    select * from employee where id = #{id}
  <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div></li>
<li>
<p>我们写的dao接口的实现文件，mybatis默认是不知道的，需要<strong>在全局配置文件中注册</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 引入我们自己编写的每一个接口的实现文件 --&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
    <span class="c">&lt;!-- resource：表示从类路径下找资源 --&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;mybatis/EmployeeDao.xml&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></div></li>
</ol>
</li>
</ul>
</li>
</ol>
<hr>
<h4 id="3测试">3、测试</h4>
<ol>
<li>
<p>根据全局配置文件先创建一个<strong>SqlSessionFactory</strong></p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//1、根据全局配置文件创建出一个SqlSessionFactory
</span><span class="c1">//SqlSessionFactory：是SqlSession工厂，负责创建SqlSession对象
</span><span class="c1">//SqlSession：sql会话（代表和数据库的一次会话）
</span><span class="c1"></span><span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
</code></pre></div><hr>
</li>
<li>
<p><strong>sqlSessionFactory</strong>中获取<strong>sqlSession</strong>对象操作数据库即可</p>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//2、获取和数据库的一次会话：getConnection();
</span><span class="c1"></span><span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
<span class="c1">//3、使用SqlSession操作数据库，先获取到dao接口的实现
</span><span class="c1"></span><span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">//4、调用之前的方法
</span><span class="c1"></span><span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
</code></pre></div><hr>
</li>
<li>
<p>==注意==：测试可能会出现时区错误，是数据库版本的问题，可参考<a href="https://blog.csdn.net/iiiiiilikangshuai/article/details/98459941"><strong>解决办法</strong></a></p>
</li>
</ol>
<hr>
<h3 id="4总体架构">4、总体架构：</h3>
<p><img src="https://i.loli.net/2020/12/20/Qjw3NxR6balyumO.png" alt="image-20201220213612329"></p>
<hr>
<h3 id="5mybatis-configxml">5、mybatis-config.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
      <span class="c">&lt;!-- 配置连接池 --&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/test?serverTimezone=UTC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  
  <span class="c">&lt;!-- 引入我们自己编写的每一个接口的实现文件 --&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
  	<span class="c">&lt;!-- resource：表示从类路径下找资源 --&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;mybatis/EmployeeDao.xml&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<h3 id="6log4jxml">6、log4j.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE log4j:configuration SYSTEM &#34;log4j.dtd&#34;&gt;</span>
 
<span class="nt">&lt;log4j:configuration</span> <span class="na">xmlns:log4j=</span><span class="s">&#34;http://jakarta.apache.org/log4j/&#34;</span><span class="nt">&gt;</span>
 
 <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">&#34;STDOUT&#34;</span> <span class="na">class=</span><span class="s">&#34;org.apache.log4j.ConsoleAppender&#34;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;Encoding&#34;</span> <span class="na">value=</span><span class="s">&#34;UTF-8&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">&#34;org.apache.log4j.PatternLayout&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&#34;ConversionPattern&#34;</span> <span class="na">value=</span><span class="s">&#34;%-5p %d{MM-dd HH:mm:ss,SSS} %m  (%F:%L) \n&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/layout&gt;</span>
 <span class="nt">&lt;/appender&gt;</span>
 <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&#34;java.sql&#34;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&#34;debug&#34;</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/logger&gt;</span>
 <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&#34;org.apache.ibatis&#34;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&#34;info&#34;</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/logger&gt;</span>
 <span class="nt">&lt;root&gt;</span>
   <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">&#34;debug&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&#34;STDOUT&#34;</span> <span class="nt">/&gt;</span>
 <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/log4j:configuration&gt;</span>
</code></pre></div><hr>
<h3 id="7employeedaoxml">7、EmployeeDao.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="c">&lt;!-- namespace：名称空间，写接口的全类名；相当于告诉MyBatis这个配置文件是实现哪个接口的 --&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>

	<span class="c">&lt;!-- public Employee getEmpById(Integer id); --&gt;</span>
	<span class="c">&lt;!-- select：用来定义一个查询操作；
</span><span class="c">	id：方法名，相当于这个配置是对于某个方法的实现
</span><span class="c">	resultType：指定方法运行后的返回值类型（查询操作必须指定的）
</span><span class="c">	#{属性名}：代表取出传递过来的某个参数的值
</span><span class="c">	 --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
    select * from employee where emp_id = #{emp_id}
  <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h3 id="8mybatistestjava">8、MyBatisTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisTest</span> <span class="o">{</span>

	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
		<span class="c1">//1、根据全局配置文件创建出一个SqlSessionFactory
</span><span class="c1"></span>		<span class="c1">//SqlSessionFactory：是SqlSession工厂，负责创建SqlSession对象
</span><span class="c1"></span>		<span class="c1">//SqlSession：sql会话（代表和数据库的一次会话）
</span><span class="c1"></span>		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
		
		<span class="c1">//4、调用之前的方法
</span><span class="c1"></span>		<span class="n">Employee</span> <span class="n">employee</span><span class="o">;</span>
		<span class="c1">//2、获取和数据库的一次会话：getConnection();
</span><span class="c1"></span>		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			
			<span class="c1">//3、使用SqlSession操作数据库，先获取到dao接口的实现
</span><span class="c1"></span>			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">employee</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
		
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div><hr>
<h3 id="9employeedaojava">9、EmployeeDao.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDao</span> <span class="o">{</span>

	<span class="c1">//数据库驱动
</span><span class="c1"></span>	<span class="c1">//mysql-connector-java-8.0.22.jar
</span><span class="c1"></span>	<span class="c1">//mybatis-3.5.6.jar
</span><span class="c1"></span>	<span class="c1">//log4j-1.2.17.jar
</span><span class="c1"></span>	<span class="c1">//按照员工id查询员工
</span><span class="c1"></span>	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="10employeejava">10、Employee.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">emp_id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">emp_name</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">emp_email</span><span class="o">;</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getEmp_id</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_id</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_id</span> <span class="o">=</span> <span class="n">emp_id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmp_name</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_name</span><span class="o">(</span><span class="n">String</span> <span class="n">emp_name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_name</span> <span class="o">=</span> <span class="n">emp_name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getEmp_gender</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_gender</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_gender</span> <span class="o">=</span> <span class="n">emp_gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmp_email</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_email</span><span class="o">(</span><span class="n">String</span> <span class="n">emp_email</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_email</span> <span class="o">=</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Employee [emp_id=&#34;</span> <span class="o">+</span> <span class="n">emp_id</span> <span class="o">+</span> <span class="s">&#34;, emp_name=&#34;</span> <span class="o">+</span> <span class="n">emp_name</span> <span class="o">+</span> <span class="s">&#34;, emp_gender=&#34;</span> <span class="o">+</span> <span class="n">emp_gender</span> <span class="o">+</span> <span class="s">&#34;, emp_email=&#34;</span>
				<span class="o">+</span> <span class="n">emp_email</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>

	
<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h2 id="2如何写xml有提示">2、如何写xml有提示</h2>
<h3 id="让eclipse找到dtd约束文件的位置">让eclipse找到dtd约束文件的位置</h3>
<ul>
<li>
<p><strong>dtd约束文件</strong>（<strong>mybatis</strong> jar包中解压复制出来）</p>
<p><img src="https://i.loli.net/2020/12/20/yGVek4PUXaZ5mDq.png" alt="image-20201220212420081"></p>
<hr>
</li>
<li>
<p><strong>绑定约束文件的位置</strong></p>
</li>
</ul>
<ol>
<li>复制dtd的引用网址
<ul>
<li><a href="http://mybatis.org/dtd/mybatis-3-config.dtd">http://mybatis.org/dtd/mybatis-3-config.dtd</a></li>
</ul>
</li>
<li>eclipse进入window&ndash;》perferences&ndash;》XML&ndash;》XML Catalog</li>
<li>点击Add，Location写dtd约束文件的位置，Key type 选URI，Key填复制的引用网址</li>
<li>点击🆗，完事。</li>
</ol>
<hr>
<p><img src="https://i.loli.net/2020/12/15/bMcZ5zBxSg9luH3.png" alt="image-20201215084850196"></p>
<hr>
<h2 id="3细节">3、细节</h2>
<h3 id="1获取到的是接口的代理对象">1.获取到的是接口的代理对象</h3>
<ul>
<li>mybatis自动创建的</li>
</ul>
<h3 id="2sqlsessionfactory和sqlsession">2.SqlSessionFactory和SqlSession</h3>
<ul>
<li>SqlSessionFactory创建SqlSession对象，Factory只new一次就行</li>
<li>SqlSession相当于connection和数据库进行交互
<ul>
<li>和数据库的一次会话</li>
<li>应该创建一个新的sqlSession</li>
</ul>
</li>
</ul>
<hr>
<h1 id="三全局配置文件">三、全局配置文件</h1>
<h2 id="1mybatis-configxml5mybatis-configxml">1、<a href="#5%E3%80%81mybatis-config.xml">mybatis-config.xml</a></h2>
<h2 id="2配置文档的顶层结构">2、配置文档的顶层结构</h2>
<ul>
<li>
<p>configuration（配置）</p>
<ul>
<li>properties（属性）</li>
<li>settings（设置）</li>
<li>typeAliases（类型别名）</li>
<li>typeHandlers（类型处理器）</li>
<li>objectFactory（对象工厂）</li>
<li>plugins（插件）</li>
<li>environments（环境配置）
<ul>
<li>environment（环境变量）
<ul>
<li>transactionManager（事务管理器）</li>
<li>dataSource（数据源）</li>
</ul>
</li>
</ul>
</li>
<li>databaseIdProvider（数据库厂商标识）</li>
<li>mappers（映射器）</li>
</ul>
</li>
<li>
<p><strong>建议参考<a href="https://mybatis.org/mybatis-3/zh/index.html">MyBatis官方中文文档</a></strong></p>
</li>
</ul>
<hr>
<h2 id="3原生jdbc执行sql">3、原生jdbc执行sql</h2>
<ul>
<li>或者封装结果集</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="n">Connection</span> <span class="n">connection</span> <span class="o">=</span> <span class="n">dataSource</span><span class="o">.</span><span class="na">getConnection</span><span class="o">();</span>

<span class="n">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">&#34;insert into employee(emp_name,emp_email,emp_gender) values(?,?,?)&#34;</span><span class="o">;</span>

<span class="n">PreparedStatement</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span>
<span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">0</span><span class="o">,</span><span class="s">&#34;admin&#34;</span><span class="o">);</span>
<span class="n">ps</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="s">&#34;aaa@qq.com&#34;</span><span class="o">);</span>
<span class="n">ps</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">2</span><span class="o">,</span><span class="n">1</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
<span class="c1">//ps.close();connection.close();
</span><span class="c1"></span>
</code></pre></div><hr>
<h2 id="4增删改查测试">4、增删改查测试</h2>
<h3 id="1employeedaojava">1.EmployeeDao.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDao</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">updateEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">deleteEmployee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">insertEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="2employeedaoxml">2.EmployeeDao.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- public Employee getEmpById(Integer emp_id);参数类型不用写 --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
  		<span class="c">&lt;!-- sql语句不要写分号 --&gt;</span>
  		select * from employee where emp_id=#{emp_id}
  <span class="nt">&lt;/select&gt;</span>
  
<span class="c">&lt;!-- public int updateEmployee(Employee employee);
</span><span class="c">增删改不用写返回值类型；增删改是返回影响多少行
</span><span class="c">mybatis自动判断，如果是数字（int，long）
</span><span class="c">如果是boolean（影响0行自动封装false，否则true）
</span><span class="c">#{属性名}：从传入的参数对象中取出对应属性的值
</span><span class="c">--&gt;</span>
<span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateEmployee&#34;</span><span class="nt">&gt;</span>
	UPDATE employee 
	SET emp_name=#{emp_name},emp_gender=#{emp_gender},emp_email=#{emp_email} 
	WHERE emp_id=#{emp_id}
<span class="nt">&lt;/update&gt;</span>

<span class="c">&lt;!-- public int deleteEmployee(Integer emp_id); --&gt;</span>
<span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteEmployee&#34;</span><span class="nt">&gt;</span>
	DELETE FROM employee WHERE emp_id=#{emp_id}
<span class="nt">&lt;/delete&gt;</span>

<span class="c">&lt;!-- public int insertEmployee(Employee employee);--&gt;</span>
<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertEmployee&#34;</span><span class="nt">&gt;</span>
	INSERT INTO employee(emp_name,emp_gender,emp_email) 
	VALUES(#{emp_name},#{emp_gender},#{emp_email})
<span class="nt">&lt;/insert&gt;</span>

  <span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h3 id="3mybatiscrudtestjava">3.MyBatisCRUDTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisCRUDTest</span> <span class="o">{</span>
	
	<span class="c1">//工厂一个
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
	
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="cm">/**
</span><span class="cm">	 * 测试添加
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInsert</span><span class="o">(){</span>
		<span class="c1">//1、获取和数据库的一次会话
</span><span class="c1"></span>		<span class="c1">//true：代表自动提交
</span><span class="c1"></span>		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">//2、获取到接口的映射器
</span><span class="c1"></span>			<span class="n">EmployeeDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="c1">//3、测试
</span><span class="c1"></span>			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">insertEmployee</span><span class="o">(</span><span class="k">new</span> <span class="n">Employee</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&#34;tomcat&#34;</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="s">&#34;tomcat@qq.com&#34;</span><span class="o">));</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="c1">//手动提交
</span><span class="c1"></span>			<span class="c1">//openSession.commit();
</span><span class="c1"></span>			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 测试删除
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDelete</span><span class="o">(){</span>
		<span class="c1">//1、获取和数据库的一次会话
</span><span class="c1"></span>		<span class="c1">//true：代表自动提交
</span><span class="c1"></span>		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">//2、获取到接口的映射器
</span><span class="c1"></span>			<span class="n">EmployeeDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="c1">//3、测试
</span><span class="c1"></span>			<span class="n">mapper</span><span class="o">.</span><span class="na">deleteEmployee</span><span class="o">(</span><span class="n">4</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="c1">//手动提交
</span><span class="c1"></span>			<span class="c1">//openSession.commit();
</span><span class="c1"></span>			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 测试修改
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUpdate</span><span class="o">(){</span>
		<span class="c1">//1、获取和数据库的一次会话
</span><span class="c1"></span>		<span class="c1">//true：代表自动提交
</span><span class="c1"></span>		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="c1">//2、获取到接口的映射器
</span><span class="c1"></span>			<span class="n">EmployeeDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="c1">//3、测试
</span><span class="c1"></span>			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">updateEmployee</span><span class="o">(</span><span class="k">new</span> <span class="n">Employee</span><span class="o">(</span><span class="n">5</span><span class="o">,</span> <span class="s">&#34;tom&#34;</span><span class="o">,</span> <span class="n">1</span><span class="o">,</span> <span class="s">&#34;tom@qq.com&#34;</span><span class="o">));</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="c1">//手动提交
</span><span class="c1"></span>			<span class="c1">//openSession.commit();
</span><span class="c1"></span>			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 测试查询
</span><span class="cm">	 * @throws IOException
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
		<span class="c1">//1、根据全局配置文件得到SqlSessionFactory对象
</span><span class="c1"></span>		<span class="c1">//initSqlSessionFactory();
</span><span class="c1"></span>		<span class="c1">//2、得到SqlSession对象；
</span><span class="c1"></span>		
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		
		<span class="c1">//3、获取到dao接口的实现（映射器）
</span><span class="c1"></span>		<span class="n">EmployeeDao</span> <span class="n">dao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="c1">//class com.sun.proxy.$Proxy7
</span><span class="c1"></span>		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dao</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="n">dao</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div><h2 id="5mybatis_config工程">5、MyBatis_config工程</h2>
<ul>
<li>==注解配置配合使用==（<strong>重要的dao写配置，简单的dao就直接标注解</strong>）</li>
</ul>
<h3 id="1总体架构">1.总体架构：</h3>
<p><img src="https://i.loli.net/2020/12/20/a5xiLHBC2YmftTR.png" alt="image-20201220225300510"></p>
<hr>
<h3 id="2mybatis-configxml">2.mybatis-config.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

<span class="c">&lt;!-- 1、和Spring的context:property-placeholder（引用配置文件）相同 --&gt;</span>
	<span class="c">&lt;!-- 
</span><span class="c">	resource：从类路径下开始引用
</span><span class="c">	url：引用磁盘路径或者网络路径的资源
</span><span class="c"> 	--&gt;</span>
	<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;dbconfig.properties&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;org.apache.ibatis.parsing.PropertyParser.enable-default-value&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/properties&gt;</span>
	
	<span class="c">&lt;!-- 2、settings是 MyBatis 中极为重要的调整设置，它们会改变 MyBatis 的运行时行为。  --&gt;</span>
	<span class="nt">&lt;settings&gt;</span>
		<span class="c">&lt;!-- name：配置项的key，value：配置项的值 --&gt;</span>
		<span class="c">&lt;!-- loginAccount ==》login_account --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;mapUnderscoreToCamelCase&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/settings&gt;</span>
	
	<span class="c">&lt;!-- 3、类型别名,为常用的类型（javaBean）起别名 --&gt;</span>
	<span class="nt">&lt;typeAliases&gt;</span>
		<span class="c">&lt;!-- typeAlias：就是为一个JavaBean起别名，别名默认就是类名（不区分大小写），配置文件中就可以用别名了 --&gt;</span>
		<span class="c">&lt;!-- alias=&#34;&#34;：指定一个别名 --&gt;</span>
		<span class="c">&lt;!-- &lt;typeAlias type=&#34;com.lql.bean.Employee&#34; alias=&#34;emp&#34;/&gt; --&gt;</span>
		
		<span class="c">&lt;!-- 批量起别名;name=&#34;&#34;指定包名，默认别名就是类名 --&gt;</span>
		<span class="c">&lt;!-- &lt;package name=&#34;com.lql.bean&#34;/&gt; --&gt;</span>
		<span class="c">&lt;!-- 我们推荐就用全类名 --&gt;</span>
	<span class="nt">&lt;/typeAliases&gt;</span>
	
	<span class="c">&lt;!-- 4、类型处理器，作用： --&gt;</span>
	<span class="c">&lt;!-- &lt;typeHandlers&gt;
</span><span class="c">		自定义好的类型处理器就这么配置上就行了
</span><span class="c">		&lt;typeHandler handler=&#34;&#34;/&gt;
</span><span class="c">	&lt;/typeHandlers&gt; --&gt;</span>
	
	<span class="c">&lt;!-- 5、插件是mybatis中的一个强大功能 --&gt;</span>

	<span class="c">&lt;!-- 6、environments配置环境“们”
</span><span class="c">		environment：配置一个具体的环境，都需要一个事务管理器和一个数据源
</span><span class="c">			transactionManger
</span><span class="c">		后来的数据源和事务管理都是Spring来管理
</span><span class="c">	 --&gt;</span>
  <span class="c">&lt;!-- default=&#34;development&#34;：默认使用哪个环境 --&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- id=&#34;testEnv&#34;是当前环境的唯一标识 --&gt;</span>
  <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;testEnv&#34;</span><span class="nt">&gt;</span>
  	<span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;&#34;</span><span class="nt">/&gt;</span>
  	<span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;&#34;</span><span class="nt">&gt;</span>
  		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://47.110.152.31:3333/user_db&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbcurl}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
  	<span class="nt">&lt;/dataSource&gt;</span>
  <span class="nt">&lt;/environment&gt;</span>
  
  
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
      <span class="c">&lt;!-- 配置连接池 --&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
      	<span class="c">&lt;!-- ${}取出配置文件中的值 --&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driverclass}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbcurl}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username:root}&#34;</span><span class="nt">/&gt;</span><span class="c">&lt;!-- 如果属性 &#39;username&#39; 没有被配置，&#39;username&#39; 属性的值将为 &#39;root&#39; --&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password:123456}&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  
  <span class="c">&lt;!-- 7、mybatis用来考虑数据库移植性的 --&gt;</span>
  <span class="nt">&lt;databaseIdProvider</span> <span class="na">type=</span><span class="s">&#34;DB_VENDOR&#34;</span><span class="nt">&gt;</span>
  	<span class="c">&lt;!-- name=&#34;&#34;：数据库厂商标识；value=&#34;&#34;：给这个标识起一个好用的名字
</span><span class="c">  		MySQL、Oracle、SQL Server
</span><span class="c">  	 --&gt;</span>
  	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;MySQL&#34;</span> <span class="na">value=</span><span class="s">&#34;mysql&#34;</span><span class="nt">/&gt;</span>
  	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;SQL Server&#34;</span> <span class="na">value=</span><span class="s">&#34;sqlserver&#34;</span><span class="nt">/&gt;</span>
  	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;Oracle&#34;</span> <span class="na">value=</span><span class="s">&#34;oracle&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/databaseIdProvider&gt;</span>
  
  <span class="c">&lt;!-- 8、写好的sql映射文件，需要使用mappers注册进来 --&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
  	<span class="c">&lt;!-- 
</span><span class="c">  	url：可以从磁盘或者网络路径引用
</span><span class="c">  	resource：在类路径下找sql映射文件
</span><span class="c">  	class：直接引用接口的全类名
</span><span class="c">  		可以将xml放在和dao接口同目录下，而且文件名和接口名一致；
</span><span class="c">  		class的另一种用法
</span><span class="c">  	 --&gt;</span>
  	 
     <span class="c">&lt;!-- &lt;mapper class=&#34;com.lql.dao.EmployeeDao&#34;/&gt; --&gt;</span>
     <span class="c">&lt;!-- &lt;mapper class=&#34;com.lql.dao.EmployeeDaoAnnotation&#34;/&gt;
</span><span class="c">     &lt;mapper resource=&#34;mybatis/EmployeeDao.xml&#34;/&gt;  --&gt;</span>
     <span class="c">&lt;!-- 配合使用：重要的dao可以写配置；
</span><span class="c">     	简单的dao就直接标注解；
</span><span class="c">      --&gt;</span>
      
      <span class="c">&lt;!-- 批量注册 name=&#34;&#34;：dao所在的包名 --&gt;</span>
      <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<h3 id="3dbconfigproperties">3.dbconfig.properties</h3>
<pre><code class="language-properties" data-lang="properties">username=root
password=123456
jdbcurl=jdbc:mysql://localhost:3306/test?serverTimezone=UTC
driverclass=com.mysql.cj.jdbc.Driver
</code></pre><hr>
<p>4.EmployeeDao.xml</p>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- public Employee getEmpById(Integer emp_id);参数类型不用写 --&gt;</span>
  <span class="c">&lt;!-- 默认这个查询是不区分环境 --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
  		<span class="c">&lt;!-- sql语句不要写分号 --&gt;</span>
  		select * from employee where emp_id=#{emp_id}
  <span class="nt">&lt;/select&gt;</span>
  
  <span class="c">&lt;!-- 如果能精确匹配就精确，不能就用模糊的 --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span> <span class="na">databaseId=</span><span class="s">&#34;mysql&#34;</span><span class="nt">&gt;</span>
  		<span class="c">&lt;!-- sql语句不要写分号 --&gt;</span>
  		select * from employee where emp_id=#{emp_id}
  <span class="nt">&lt;/select&gt;</span>
  
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span> <span class="na">databaseId=</span><span class="s">&#34;oracle&#34;</span><span class="nt">&gt;</span>
  		<span class="c">&lt;!-- sql语句不要写分号 --&gt;</span>
  		select * from employee where emp_id=#{emp_id}
  <span class="nt">&lt;/select&gt;</span>
  
<span class="c">&lt;!-- public int updateEmployee(Employee employee);
</span><span class="c">增删改不用写返回值类型；增删改是返回影响多少行
</span><span class="c">mybatis自动判断，如果是数字（int，long）
</span><span class="c">如果是boolean（影响0行自动封装false，否则true）
</span><span class="c">#{属性名}：从传入的参数对象中取出对应属性的值
</span><span class="c">--&gt;</span>
<span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateEmployee&#34;</span><span class="nt">&gt;</span>
	UPDATE employee 
	SET emp_name=#{emp_name},emp_gender=#{emp_gender},emp_email=#{emp_email}
	WHERE emp_id=#{emp_id}
<span class="nt">&lt;/update&gt;</span>

<span class="c">&lt;!-- public int deleteEmployee(Integer emp_id); --&gt;</span>
<span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteEmployee&#34;</span><span class="nt">&gt;</span>
	DELETE FROM employee WHERE emp_id=#{emp_id}
<span class="nt">&lt;/delete&gt;</span>

<span class="c">&lt;!-- public int insertEmployee(Employee employee);--&gt;</span>
<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertEmployee&#34;</span><span class="nt">&gt;</span>
	INSERT INTO employee(emp_name,emp_gender,emp_email) 
	VALUES(#{emp_name},#{emp_gender},#{emp_email})
<span class="nt">&lt;/insert&gt;</span>

  <span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h3 id="4mybatiscrudtestjava">4.MyBatisCRUDTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDaoAnnotation</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisCRUDTest</span> <span class="o">{</span>
	
	<span class="c1">//工厂一个
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
	
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testAnnotation</span><span class="o">(){</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">EmployeeDaoAnnotation</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDaoAnnotation</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">Employee</span> <span class="n">empById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">5</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">empById</span><span class="o">);</span>
		
		<span class="n">EmployeeDao</span> <span class="n">mapper2</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">mapper2</span><span class="o">);</span>
		<span class="n">Employee</span> <span class="n">empById2</span> <span class="o">=</span> <span class="n">mapper2</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">empById2</span><span class="o">);</span>
		
	<span class="o">}</span>
</code></pre></div><hr>
<h3 id="5employeedaoannotationjava">5.EmployeeDaoAnnotation.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Delete</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Insert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Select</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Update</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDaoAnnotation</span> <span class="o">{</span>

	<span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from employee where emp_id=#{emp_id}&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	
	<span class="nd">@Update</span><span class="o">(</span><span class="s">&#34;UPDATE employee &#34;</span>
			<span class="o">+</span> <span class="s">&#34;SET emp_name=#{emp_name},emp_gender=#{emp_gender},emp_email=#{emp_email}&#34;</span>
			<span class="o">+</span> <span class="s">&#34; WHERE emp_id=#{emp_id}&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">updateEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
	
	<span class="nd">@Delete</span><span class="o">(</span><span class="s">&#34;DELETE FROM employee WHERE emp_id=#{emp_id}&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">deleteEmployee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	
	<span class="nd">@Insert</span><span class="o">(</span><span class="s">&#34;INSERT INTO employee(emp_name,emp_gender,emp_email) &#34;</span>
			<span class="o">+</span> <span class="s">&#34;VALUES(#{emp_name},#{emp_gender},#{emp_email})&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">insertEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h1 id="四sql映射文件">四、SQL映射文件</h1>
<ul>
<li>映射文件指导着MyBatis如何进行数据库增删改查，有着非常重要的意义</li>
</ul>
<h2 id="1增删改元素">1、增删改元素</h2>
<p><img src="https://i.loli.net/2020/12/15/ya7GkVA6gHOSunt.png" alt="image-20201215161245376"></p>
<hr>
<h2 id="2各种配置3mybatis_sqlmapper"><a href="#3%E3%80%81MyBatis_sqlMapper">2、各种配置</a></h2>
<h2 id="3mybatis_sqlmapper">3、MyBatis_sqlMapper</h2>
<h3 id="1总体架构-1">1.总体架构：</h3>
<p><img src="https://i.loli.net/2020/12/21/qj9b1az4emXPvf5.png" alt="Snipaste_2020-12-21_08-45-46"></p>
<hr>
<h3 id="2bean">2.bean</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>

	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">gender</span><span class="o">;</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getGender</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGender</span><span class="o">(</span><span class="n">Integer</span> <span class="n">gender</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getAge</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">age</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAge</span><span class="o">(</span><span class="n">Integer</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Cat [id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34;, name=&#34;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#34;, age=&#34;</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span> <span class="s">&#34;, gender=&#34;</span> <span class="o">+</span> <span class="n">gender</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>
		
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.type.Alias</span><span class="o">;</span>

<span class="nd">@Alias</span><span class="o">(</span><span class="s">&#34;emp&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">emp_id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">emp_name</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">emp_email</span><span class="o">;</span>

	<span class="kd">public</span> <span class="nf">Employee</span><span class="o">()</span> <span class="o">{</span>
		<span class="kd">super</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="nf">Employee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">,</span> <span class="n">String</span> <span class="n">emp_name</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">,</span> <span class="n">String</span> <span class="n">emp_email</span><span class="o">)</span> <span class="o">{</span>
		<span class="kd">super</span><span class="o">();</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_id</span> <span class="o">=</span> <span class="n">emp_id</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_name</span> <span class="o">=</span> <span class="n">emp_name</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_gender</span> <span class="o">=</span> <span class="n">emp_gender</span><span class="o">;</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_email</span> <span class="o">=</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getEmp_id</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_id</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_id</span> <span class="o">=</span> <span class="n">emp_id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmp_name</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_name</span><span class="o">(</span><span class="n">String</span> <span class="n">emp_name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_name</span> <span class="o">=</span> <span class="n">emp_name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getEmp_gender</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_gender</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_gender</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_gender</span> <span class="o">=</span> <span class="n">emp_gender</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmp_email</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmp_email</span><span class="o">(</span><span class="n">String</span> <span class="n">emp_email</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">emp_email</span> <span class="o">=</span> <span class="n">emp_email</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Employee [emp_id=&#34;</span> <span class="o">+</span> <span class="n">emp_id</span> <span class="o">+</span> <span class="s">&#34;, emp_name=&#34;</span> <span class="o">+</span> <span class="n">emp_name</span> <span class="o">+</span> <span class="s">&#34;, emp_gender=&#34;</span> <span class="o">+</span> <span class="n">emp_gender</span> <span class="o">+</span> <span class="s">&#34;, emp_email=&#34;</span>
				<span class="o">+</span> <span class="n">emp_email</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>
	
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * 🔑表
</span><span class="cm"> * @author 陆乾龙
</span><span class="cm"> *
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Key</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span><span class="c1">//钥匙的id
</span><span class="c1"></span>	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">keyName</span><span class="o">;</span><span class="c1">//钥匙名
</span><span class="c1"></span>	
	<span class="kd">private</span> <span class="n">Lock</span> <span class="n">lock</span><span class="o">;</span><span class="c1">//当前钥匙能开哪个锁
</span><span class="c1"></span>	
	

	<span class="kd">public</span> <span class="n">Lock</span> <span class="nf">getLock</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">lock</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLock</span><span class="o">(</span><span class="n">Lock</span> <span class="n">lock</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">lock</span> <span class="o">=</span> <span class="n">lock</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getKeyName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">keyName</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setKeyName</span><span class="o">(</span><span class="n">String</span> <span class="n">keyName</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">keyName</span> <span class="o">=</span> <span class="n">keyName</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Key [id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34;, keyName=&#34;</span> <span class="o">+</span> <span class="n">keyName</span> <span class="o">+</span> <span class="s">&#34;, lock=&#34;</span> <span class="o">+</span> <span class="n">lock</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>	
	
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * 🔒表
</span><span class="cm"> * @author 陆乾龙
</span><span class="cm"> *
</span><span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Lock</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">lockName</span><span class="o">;</span>
	
	<span class="c1">//查🔒的时候把所有的🔑也查出来
</span><span class="c1"></span>	<span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span><span class="o">;</span>
	<span class="c1">//1-1关联  1-n关联  n-n关联
</span><span class="c1"></span>	<span class="cm">/**
</span><span class="cm">	 * 一个key开一把lock：1-1
</span><span class="cm">	 * 一个lock有多把key：1-n
</span><span class="cm">	 * 从key表看lock：n-1
</span><span class="cm">	 * 1-n,n-1,n-n：外键应该放在哪个表?
</span><span class="cm">	 * 一对多：外键一定放在多的一端
</span><span class="cm">	 * 多对多：中间表存储对应关系
</span><span class="cm">	 */</span>
	
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="nf">getKeys</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">keys</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setKeys</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">keys</span> <span class="o">=</span> <span class="n">keys</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getLockName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">lockName</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLockName</span><span class="o">(</span><span class="n">String</span> <span class="n">lockName</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">lockName</span> <span class="o">=</span> <span class="n">lockName</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Lock [id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34;, lockName=&#34;</span> <span class="o">+</span> <span class="n">lockName</span> <span class="o">+</span> <span class="s">&#34;, keys=&#34;</span> <span class="o">+</span> <span class="n">keys</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>
	
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="3dao">3.dao</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Cat</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CatDao</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="n">Cat</span> <span class="nf">getCatById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.MapKey</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDao</span> <span class="o">{</span>

	<span class="c1">//列名作为key，值作为value
</span><span class="c1"></span>	<span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="nf">getEmpByIdReturnMap</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="nf">getAllEmps</span><span class="o">();</span>
	
	<span class="cm">/**
</span><span class="cm">	 * key就是这个记录的主键，value就是这条记录封装好的对象；
</span><span class="cm">	 * @return
</span><span class="cm">	 * 
</span><span class="cm">	 * 把查询的记录的id的值作为key封装这个map:
</span><span class="cm">	 * @MapKey(&#34;emp_id&#34;)
</span><span class="cm">	 */</span>
	<span class="nd">@MapKey</span><span class="o">(</span><span class="s">&#34;emp_id&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Employee</span><span class="o">&gt;</span> <span class="nf">getAllEmpsReturnMap</span><span class="o">();</span>
	
	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpByIdAndEmpName</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;emp_id&#34;</span><span class="o">)</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">,</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;emp_name&#34;</span><span class="o">)</span><span class="n">String</span> <span class="n">emp_name</span><span class="o">);</span>
	<span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmpByIdAndEmpName1</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">updateEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">deleteEmployee</span><span class="o">(</span><span class="n">Integer</span> <span class="n">emp_id</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">insertEmployee</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">insertEmployee2</span><span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="o">);</span>
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Key</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">KeyDao</span> <span class="o">{</span>

	<span class="cm">/**
</span><span class="cm">	 * 将🔑和🔒ℹ一起查出
</span><span class="cm">	 * @param id
</span><span class="cm">	 * @return
</span><span class="cm">	 */</span>
	<span class="kd">public</span> <span class="n">Key</span> <span class="nf">getKeyById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">Key</span> <span class="nf">getKeyByIdSimple</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="nf">getKeysByLockId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

<span class="o">*****************************************************</span>
<span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Lock</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">LockDao</span> <span class="o">{</span>

	<span class="c1">//查🔒的时候将所有🔑也查出来
</span><span class="c1"></span>	<span class="kd">public</span> <span class="n">Lock</span> <span class="nf">getLockById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">Lock</span> <span class="nf">getLockByIdSimple</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">Lock</span> <span class="nf">getLockByIdByStep</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="4daoxml">4.dao.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span> CatDao.xml <span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span>

<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.CatDao&#34;</span><span class="nt">&gt;</span>
	<span class="c">&lt;!-- getCatById(Integer)
</span><span class="c">	resultType=&#34;com.lql.bean.Cat&#34;：使用默认规则：属性列名一一对应
</span><span class="c">	resultMap=&#34;mycat&#34;：查出数据封装结果的时候，使用mycat自定义的规则
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getCatById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mycat&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- select id,cname name,cage age,cgender gender from t_cat where id=#{id}  --&gt;</span>
		select * from t_cat where id=#{id} 
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- 自定义结果集：自己定义每一列数据和javaBean的映射规则
</span><span class="c">	type=&#34;&#34;：指定为哪个javaBean自定义封装规则；全类名
</span><span class="c">	id=&#34;&#34;：唯一标识，让别名在后面引用
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Cat&#34;</span> <span class="na">id=</span><span class="s">&#34;mycat&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- 指定主键列的对应规则：
</span><span class="c">		column=&#34;id&#34;：指定那一列是主键列
</span><span class="c">		property=&#34;&#34;：指定cat的哪个属性封装id这一列数据
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- 普通列 --&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;cname&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;age&#34;</span> <span class="na">column=</span><span class="s">&#34;cage&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;gender&#34;</span> <span class="na">column=</span><span class="s">&#34;cgender&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>


<span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span> EmployeeDao.xml <span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span>

<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- namespace=&#34;com.lql.dao.EmployeeDao&#34;：写dao接口的全类名 --&gt;</span>
<span class="c">&lt;!-- 这个文件中能写的所有标签：
</span><span class="c">cache：和缓存有关
</span><span class="c">cache-ref：和缓存有关
</span><span class="c">parameterMap：参数map；废弃的。。。原本是来做复杂参数映射的；
</span><span class="c">resultMap：结果集映射；自定义结果集的封装规则
</span><span class="c">sql：抽取可重用的sql；
</span><span class="c">
</span><span class="c">delete、update、insert、select：增删改查；
</span><span class="c">databaseId：指定这个CRUD属于哪个数据库的
</span><span class="c"> --&gt;</span>
 
 	<span class="c">&lt;!-- public int insertEmployee(Employee employee);--&gt;</span>
 	<span class="c">&lt;!-- 
</span><span class="c"> 	让MyBatis自动的将自增id赋值给传入的employee对象的id属性
</span><span class="c"> 		useGeneratedKeys=&#34;true&#34;：原生jdbc获取自增主键的方法；
</span><span class="c"> 		keyProperty=&#34;&#34;：将刚才自增的id封装给哪个属性
</span><span class="c"> 	 --&gt;</span>
	<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertEmployee&#34;</span> <span class="na">useGeneratedKeys=</span><span class="s">&#34;true&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;emp_id&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- 查询主键
</span><span class="c">		order=&#34;BEFORE&#34;:
</span><span class="c">			在核心sql语句之前先运行一个查询sql查到id；将查到的id赋值给javaBean的哪个属性
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;selectKey</span> <span class="na">order=</span><span class="s">&#34;BEFORE&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;emp_id&#34;</span><span class="nt">&gt;</span>
			select max(emp_id) from employee
		<span class="nt">&lt;/selectKey&gt;</span>
		INSERT INTO employee(emp_name,emp_gender,emp_email) 
		VALUES(#{emp_name},#{emp_gender},#{emp_email})
	<span class="nt">&lt;/insert&gt;</span>
	
	<span class="c">&lt;!-- public int insertEmployee2(Employee employee); --&gt;</span>
	<span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;insertEmployee2&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- 查询主键
</span><span class="c">		order=&#34;BEFORE&#34;:
</span><span class="c">			在核心sql语句之前先运行一个查询sql查到id；将查到的id赋值给javaBean的哪个属性
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;selectKey</span> <span class="na">order=</span><span class="s">&#34;BEFORE&#34;</span> <span class="na">resultType=</span><span class="s">&#34;integer&#34;</span> <span class="na">keyProperty=</span><span class="s">&#34;emp_id&#34;</span><span class="nt">&gt;</span>
			select max(emp_id)+1 from employee
		<span class="nt">&lt;/selectKey&gt;</span>
		INSERT INTO employee(emp_id,emp_name,emp_gender,emp_email) 
		VALUES(#{emp_id},#{emp_name},#{emp_gender},#{emp_email})
	<span class="nt">&lt;/insert&gt;</span>

    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateEmployee&#34;</span> <span class="nt">&gt;</span>
	UPDATE employee 
	SET emp_name=#{emp_name},emp_gender=#{emp_gender},emp_email=#{emp_email}
	WHERE emp_id=#{emp_id}
    <span class="nt">&lt;/update&gt;</span>

	<span class="c">&lt;!-- public int deleteEmployee(Integer emp_id); --&gt;</span>
	<span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteEmployee&#34;</span> <span class="nt">&gt;</span>
		DELETE FROM employee WHERE emp_id=#{emp_id}
	<span class="nt">&lt;/delete&gt;</span>
	
	<span class="c">&lt;!-- 传参到底能传哪些 --&gt;</span>
	<span class="c">&lt;!-- public Employee getEmpById(Integer emp_id); --&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpById&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span> <span class="nt">&gt;</span>
  		select * from employee where emp_id=#{hahaha}
    <span class="nt">&lt;/select&gt;</span>
    
    <span class="c">&lt;!-- Caused by: org.apache.ibatis.binding.BindingException:
</span><span class="c">     Parameter &#39;emp_id&#39; not found. 
</span><span class="c">     Available parameters are [arg1, arg0, param1, param2]
</span><span class="c">     --&gt;</span>
    
    <span class="c">&lt;!-- public Employee getEmpByIdAndEmpName(Integer emp_id,String emp_name); --&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpByIdAndEmpName&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
    	select * from employee where emp_id=#{emp_id} and emp_name=#{emp_name}
    <span class="nt">&lt;/select&gt;</span>
    
    <span class="c">&lt;!-- public Employee getEmpByIdAndEmpName1(Map&lt;String, Object&gt; map); --&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpByIdAndEmpName1&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
    	select * from ${tableName} where emp_id=#{emp_id,jdbcType=INTEGER} and emp_name=#{emp_name}
    <span class="nt">&lt;/select&gt;</span>
    
    <span class="c">&lt;!-- 现象：
</span><span class="c">    	1）、单个参数
</span><span class="c">    		基本类型：
</span><span class="c">    			取值：#{随便写}
</span><span class="c">    		传入Pojo
</span><span class="c">    	2）、多个参数
</span><span class="c">    		public Employee getEmpByIdAndEmpName(Integer emp_id,String emp_name)
</span><span class="c">    		取值：#{参数名}是无效了；
</span><span class="c">    		可用：arg0，arg1或者param1，param2
</span><span class="c">    		原因：只要是传入了多个参数；mybatis会自动的将这些参数封装在一个map中，
</span><span class="c">    			封装时使用的key就是参数的索引和参数的第几个表示
</span><span class="c">    			Map&lt;String,Object&gt; map = new HashMap&lt;&gt;();
</span><span class="c">    			map.put(&#34;1&#34;,传入的值);map.put(&#34;2&#34;,传入的值);
</span><span class="c">    		#{key}就是从这几个map中取值；
</span><span class="c">    	3)、@Param(&#34;&#34;)为参数指定key，命名参数，我们以后也推荐这么做；
</span><span class="c">    		我们可以告诉mybatis，封装参数map的时候别乱来，使用我们指定的key
</span><span class="c">    	
</span><span class="c">    	4）、传入了pojo（javaBean）
</span><span class="c">    		取值：#{pojo的属性名}
</span><span class="c">    	
</span><span class="c">    	5）、传入了map;将多个要使用的参数封装起来
</span><span class="c">    		取值：#{key}
</span><span class="c">    	
</span><span class="c">    	扩展：多个参数：自动封装map；
</span><span class="c">    	method01(@Param(&#34;emp_id&#34;)Integer emp_id,String emp_name,Employee employee);
</span><span class="c">    	Integer id -&gt; #{emp_id}
</span><span class="c">    	String emp_name -&gt; #{param2}
</span><span class="c">    	Employee employee(取出这里面的email) -&gt; #{param3.email}
</span><span class="c">    	
</span><span class="c">    	无论传入什么参数都要能正确的取出值；
</span><span class="c">    	#{key/属性名}
</span><span class="c">    	1)、#{key,jdbcType=INTEGER}；
</span><span class="c">    	javaType、jdbcType、mode、numericScale、resultMap、typeHandler、jdbcTypeName、expression
</span><span class="c">    	只有jdbcType才可能是需要被指定的；
</span><span class="c">    		默认不指定jdbcType：mysql没问题，oracle没问题；
</span><span class="c">    		万一传入的数据是null：mysql插入null没问题，【oracle不知道null到底是什么类型】
</span><span class="c">    	
</span><span class="c">    	实际上在mybatis中，有两种取值方式：
</span><span class="c">    	#{属性名}：是预编译的方式，参数的位置都是？替代，参数后来都是预编译设置进去的；安全，不会有sql注入问题
</span><span class="c">    	${属性名}：不是参数预编译，而是直接和sql语句进行拼串；不安全:
</span><span class="c">    		//emp_id=1 or 1=1 or and emp_name=
</span><span class="c">    		传入一个&#39;1 or 1=1 or&#39;
</span><span class="c">    		有使用场景：sql语句只有参数位置是支持预编译的：
</span><span class="c">    		log_2020_12、log_2021_1(动态表名)
</span><span class="c">    		select * from log_2021_1 where emp_id=1 and emp_name=?
</span><span class="c">    	
</span><span class="c">    	
</span><span class="c">    	emp_id=${emp_id} and emp_name=#{emp_name}
</span><span class="c">    	select * from employee where emp_id=1 and emp_name=?
</span><span class="c">    	
</span><span class="c">    	emp_id=#{emp_id} and emp_name=#{emp_name}
</span><span class="c">    	select * from employee where emp_id=? and emp_name=?
</span><span class="c">    	
</span><span class="c">    	一般都是使用#{}；安全；在不支持预编译参数的位置要进行取值就使用${};
</span><span class="c">     --&gt;</span>
     
     <span class="c">&lt;!-- public List&lt;Employee&gt; getAllEmps(); --&gt;</span>
     <span class="c">&lt;!-- resultType=&#34;&#34;：如果返回的是集合，写的是集合里面元素的类型 --&gt;</span>
     <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getAllEmps&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
     	select * from employee
     <span class="nt">&lt;/select&gt;</span>
     
     <span class="c">&lt;!-- 查询返回一个map --&gt;</span>
     <span class="c">&lt;!-- public Map&lt;String, Object&gt; getEmpByIdReturnMap(Integer emp_id); --&gt;</span>
     <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getEmpByIdReturnMap&#34;</span> <span class="na">resultType=</span><span class="s">&#34;map&#34;</span><span class="nt">&gt;</span>
     	select * from employee where emp_id=#{emp_id}
     <span class="nt">&lt;/select&gt;</span>
     
     <span class="c">&lt;!-- 查询多个返回一个map；查询多个情况下，集合里面写元素类型 --&gt;</span>
     <span class="c">&lt;!-- public Map&lt;Integer, Employee&gt; getAllEmpsReturnMap(); --&gt;</span>
     <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getAllEmpsReturnMap&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Employee&#34;</span><span class="nt">&gt;</span>
     	select * from employee
     <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>


<span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span> KeyDao.xml <span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span>

<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.KeyDao&#34;</span><span class="nt">&gt;</span>

	<span class="c">&lt;!-- public List&lt;Key&gt; getKeysByLockId(Integer id); 
</span><span class="c">	按照锁id查出所有的key
</span><span class="c">	--&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getKeysByLockId&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Key&#34;</span><span class="nt">&gt;</span>
		SELECT * FROM t_key WHERE lockid = #{id};
	<span class="nt">&lt;/select&gt;</span>

	<span class="c">&lt;!-- public Key getKeyByIdSimple(Integer id); --&gt;</span>
	<span class="c">&lt;!-- 查询key的时候也可以带上锁信息 --&gt;</span>
	<span class="c">&lt;!-- id	keyname	lockid --&gt;</span>
	<span class="c">&lt;!-- 
</span><span class="c">	private Integer id;//钥匙的id
</span><span class="c">	private String keyName;//钥匙名
</span><span class="c">	private Lock lock;//当前钥匙能开哪个锁
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getKeyByIdSimple&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mykey02&#34;</span><span class="nt">&gt;</span>
		select * from t_key where id = #{id}
	<span class="nt">&lt;/select&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Key&#34;</span> <span class="na">id=</span><span class="s">&#34;mykey02&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;keyName&#34;</span> <span class="na">column=</span><span class="s">&#34;keyname&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- 告诉mybatis自己去调用一个查询查锁
</span><span class="c">		select=&#34;&#34;：指定一个查询sql的唯一标识；
</span><span class="c">		mybatis自动调用指定的sql将查出的lock封装进来
</span><span class="c">		public Lock getLockByIdSimple(Integer id);需要传入锁id
</span><span class="c">		告诉mybatis把那一列的值传过去：
</span><span class="c">		column=&#34;&#34;：指定将哪一列的数据传递过去
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">&#34;lock&#34;</span> <span class="na">select=</span><span class="s">&#34;com.lql.dao.LockDao.getLockByIdSimple&#34;</span>
		<span class="na">column=</span><span class="s">&#34;lockid&#34;</span> <span class="na">fetchType=</span><span class="s">&#34;lazy&#34;</span><span class="nt">&gt;&lt;/association&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>


	<span class="c">&lt;!-- getKeyById(Integer) --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getKeyById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mykey&#34;</span><span class="nt">&gt;</span>
		SELECT k.id,k.keyname,k.lockid,l.id lid,l.lockname 
		FROM t_key k LEFT JOIN t_lock l ON k.lockid = l.id 
		WHERE k.id = #{id};
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- 自定义封装规则：使用级联属性封装 联合查询出来的结果--&gt;</span>
	<span class="c">&lt;!-- &lt;resultMap type=&#34;com.lql.bean.Key&#34; id=&#34;mykey&#34;&gt;
</span><span class="c">		&lt;id property=&#34;id&#34; column=&#34;id&#34;/&gt;
</span><span class="c">		&lt;result property=&#34;keyName&#34; column=&#34;keyname&#34;/&gt;
</span><span class="c">		&lt;result property=&#34;lock.id&#34; column=&#34;lid&#34;/&gt;
</span><span class="c">		&lt;result property=&#34;lock.lockName&#34; column=&#34;lockname&#34;/&gt;
</span><span class="c">	&lt;/resultMap&gt; --&gt;</span>
	
	<span class="c">&lt;!-- mybatis推荐的 --&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Key&#34;</span> <span class="na">id=</span><span class="s">&#34;mykey&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;keyName&#34;</span> <span class="na">column=</span><span class="s">&#34;keyname&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- 接下来的属性是一个对象，自定义这个对象的封装规则；
</span><span class="c">		使用association：表示联合了一个对象
</span><span class="c">		javaType=&#34;&#34;：指定这个属性的类型
</span><span class="c">		--&gt;</span>
		<span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">&#34;lock&#34;</span> <span class="na">javaType=</span><span class="s">&#34;com.lql.bean.Lock&#34;</span><span class="nt">&gt;</span>
			<span class="c">&lt;!-- 定义lock属性对应的这个Lock对象如何封装 --&gt;</span>
			<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;lid&#34;</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;lockName&#34;</span> <span class="na">column=</span><span class="s">&#34;lockname&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;/association&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>


<span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span> LockDao.xml <span class="err">&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;</span>

<span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.LockDao&#34;</span><span class="nt">&gt;</span>

	<span class="c">&lt;!-- public Lock getLockByIdByStep(Integer id); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getLockByIdByStep&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mylockstep&#34;</span><span class="nt">&gt;</span>
		select * from t_lock where id=#{id}
	<span class="nt">&lt;/select&gt;</span>
	<span class="c">&lt;!-- collection分步查询 --&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Lock&#34;</span> <span class="na">id=</span><span class="s">&#34;mylockstep&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;lockName&#34;</span> <span class="na">column=</span><span class="s">&#34;lockname&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- collection指定集合类型的属性封装规则 --&gt;</span>
		<span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;keys&#34;</span> 
		<span class="na">select=</span><span class="s">&#34;com.lql.dao.KeyDao.getKeysByLockId&#34;</span>
		<span class="na">column=</span><span class="s">&#34;{id=id}&#34;</span><span class="nt">&gt;&lt;/collection&gt;</span>
		<span class="c">&lt;!-- {key1=列名,key2=列名} --&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>

	<span class="c">&lt;!-- public Lock getLockByIdSimple(Integer id); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getLockByIdSimple&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.lql.bean.Lock&#34;</span><span class="nt">&gt;</span>
		select * from t_lock where id=#{id}
	<span class="nt">&lt;/select&gt;</span>


	<span class="c">&lt;!-- public Lock getLockById(Integer id); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getLockById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;mylock&#34;</span><span class="nt">&gt;</span>
		SELECT l.*,k.id kid,k.keyname,k.lockid 
		FROM t_lock l LEFT JOIN t_key k 
		ON l.id=k.lockid WHERE l.id = #{id}
	<span class="nt">&lt;/select&gt;</span>
	<span class="c">&lt;!-- 
</span><span class="c">		private Integer id;
</span><span class="c">		private String lockName;
</span><span class="c">		//查锁的时候把所有的钥匙也查出来
</span><span class="c">		private List&lt;Key&gt; keys;
</span><span class="c">		
</span><span class="c">		id	lockname	kid	keyname	lockid
</span><span class="c">		3	303办公室的锁	3	303钥匙1	3
</span><span class="c">		3	303办公室的锁	4	303钥匙2	3
</span><span class="c">		3	303办公室的锁	5	303钥匙3	3
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Lock&#34;</span> <span class="na">id=</span><span class="s">&#34;mylock&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;lockName&#34;</span> <span class="na">column=</span><span class="s">&#34;lockname&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- 
</span><span class="c">		collection：定义集合元素的封装
</span><span class="c">			property=&#34;&#34;：指定哪个属性是集合属性
</span><span class="c">			javaType：指定对象类型（association）
</span><span class="c">			ofType：指定集合里面元素的类型
</span><span class="c">		 --&gt;</span>
		<span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;keys&#34;</span> <span class="na">ofType=</span><span class="s">&#34;com.lql.bean.Key&#34;</span><span class="nt">&gt;</span>
			<span class="c">&lt;!-- 标签体中集合中这个元素的封装规则 --&gt;</span>
			<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;kid&#34;</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;keyName&#34;</span> <span class="na">column=</span><span class="s">&#34;keyname&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;/collection&gt;</span>
	<span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h3 id="5mybatis-configxml-1">5.mybatis-config.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

	<span class="nt">&lt;settings&gt;</span>
		<span class="c">&lt;!-- 开启延迟加载开关 --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;lazyLoadingEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- 开启属性按需加载(默认开启) --&gt;</span>
		<span class="c">&lt;!-- &lt;setting name=&#34;aggressiveLazyLoading&#34; value=&#34;false&#34;/&gt; --&gt;</span>
	<span class="nt">&lt;/settings&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/test?serverTimezone=UTC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
      <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<h3 id="6mybatistestjava">6、MyBatisTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Cat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.bean.Employee</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.bean.Key</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.bean.Lock</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.CatDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.EmployeeDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.KeyDao</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.LockDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisTest</span> <span class="o">{</span>

	<span class="c1">//工厂一个
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
		
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Employee</span> <span class="n">empById</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getEmpById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">empById</span><span class="o">);</span>
			
			
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="cm">/*Employee employee = new Employee(null, &#34;haha&#34;, 0, &#34;aaa&#34;);
</span><span class="cm">			int i = employeeDao.insertEmployee(employee);
</span><span class="cm">			System.out.println(&#34;---&gt;&#34;+i);
</span><span class="cm">			System.out.println(&#34;刚才插入的id：&#34;+employee.getEmp_id());*/</span>
			<span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Employee</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&#34;haha&#34;</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="s">&#34;aaa&#34;</span><span class="o">);</span>
			<span class="n">employeeDao</span><span class="o">.</span><span class="na">insertEmployee2</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
			
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">.</span><span class="na">getEmp_id</span><span class="o">());</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test03</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="cm">/*Employee empByIdAndEmpName = employeeDao.getEmpByIdAndEmpName(1, &#34;admin&#34;);
</span><span class="cm">			System.out.println(empByIdAndEmpName);
</span><span class="cm">			
</span><span class="cm">			Employee empById = employeeDao.getEmpById(1);
</span><span class="cm">			System.out.println(empById);*/</span>
			
			<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;();</span>
			<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;emp_id&#34;</span><span class="o">,</span> <span class="n">1</span><span class="o">);</span>
			<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;emp_name&#34;</span><span class="o">,</span> <span class="s">&#34;admin&#34;</span><span class="o">);</span>
			<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;tableName&#34;</span><span class="o">,</span> <span class="s">&#34;employee&#34;</span><span class="o">);</span>
			<span class="n">Employee</span> <span class="n">empByIdAndEmpName2</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getEmpByIdAndEmpName1</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">empByIdAndEmpName2</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test04</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">EmployeeDao</span> <span class="n">employeeDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="c1">//查询多条记录封装list
</span><span class="c1"></span>			<span class="cm">/*List&lt;Employee&gt; allEmps = employeeDao.getAllEmps();
</span><span class="cm">			for (Employee employee : allEmps) {
</span><span class="cm">				System.out.println(employee);
</span><span class="cm">			}*/</span>
			
			<span class="c1">//查询单条记录封装map
</span><span class="c1"></span>			<span class="cm">/*Map&lt;String, Object&gt; map = employeeDao.getEmpByIdReturnMap(1);
</span><span class="cm">			System.out.println(map);*/</span>
			
			<span class="c1">//查询多条记录封装map
</span><span class="c1"></span>			<span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Employee</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="n">employeeDao</span><span class="o">.</span><span class="na">getAllEmpsReturnMap</span><span class="o">();</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
			<span class="n">Employee</span> <span class="n">employee</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">.</span><span class="na">getEmp_name</span><span class="o">());</span>
			
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 默认mybatis自动封装结果集；
</span><span class="cm">	 * 1）、按照列名和属性名一一对应的规则（不区分大小写）；
</span><span class="cm">	 * 2）、如果不一一对应：
</span><span class="cm">	 * 		1）、开启驼峰命名法（满足驼峰命名规则 aaa_bbb aaaBbb）
</span><span class="cm">	 * 		2)、起别名
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test05</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">CatDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">CatDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Cat</span> <span class="n">catById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getCatById</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">catById</span><span class="o">);</span>
			
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 联合查询情况下
</span><span class="cm">	 * 1、使用级联属性封装联合查询后的所有结果
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test06</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">KeyDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">KeyDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Key</span> <span class="n">keyById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getKeyById</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">keyById</span><span class="o">);</span>
			
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test07</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">LockDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">LockDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Lock</span> <span class="n">lockById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getLockById</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lockById</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;所有🔑如下：&#34;</span><span class="o">);</span>
			<span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">lockById</span><span class="o">.</span><span class="na">getKeys</span><span class="o">();</span>
			<span class="k">for</span> <span class="o">(</span><span class="n">Key</span> <span class="n">key</span> <span class="o">:</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test08</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">LockDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">LockDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Lock</span> <span class="n">lockById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getLockById</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lockById</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;所有🔑如下：&#34;</span><span class="o">);</span>
			<span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">lockById</span><span class="o">.</span><span class="na">getKeys</span><span class="o">();</span>
			<span class="k">for</span> <span class="o">(</span><span class="n">Key</span> <span class="n">key</span> <span class="o">:</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 分步查询
</span><span class="cm">	 * 查询🔑的时候顺便查出🔒
</span><span class="cm">	 * 1）、Key key = keyDao.getKeyById(1);
</span><span class="cm">	 * 2)、Lock lock = lockDao.getLockById(1);
</span><span class="cm">	 * @throws InterruptedException 
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test09</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">KeyDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">KeyDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Key</span> <span class="n">keyByIdSimple</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getKeyByIdSimple</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="c1">//严重性能；
</span><span class="c1"></span>			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">keyByIdSimple</span><span class="o">.</span><span class="na">getKeyName</span><span class="o">());</span>
			<span class="c1">//按需加载（需要的时候再去查询）全局开启按需加载策略
</span><span class="c1"></span>			<span class="c1">//延迟加载，不着急加载（查询对象）
</span><span class="c1"></span>			<span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">3000</span><span class="o">);</span>
			<span class="n">String</span> <span class="n">lockName</span> <span class="o">=</span> <span class="n">keyByIdSimple</span><span class="o">.</span><span class="na">getLock</span><span class="o">().</span><span class="na">getLockName</span><span class="o">();</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lockName</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 一般我们在工作的时候：写成两个方法
</span><span class="cm">	 * public Key getKeySimple(Integer id);
</span><span class="cm">	 * 
</span><span class="cm">	 * 推荐都来写连接查询
</span><span class="cm">	 * public Key getKeyAssicate()
</span><span class="cm">	 * @throws InterruptedException
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test10</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">LockDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">LockDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Lock</span> <span class="n">lockByIdByStep</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getLockByIdByStep</span><span class="o">(</span><span class="n">3</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">lockByIdByStep</span><span class="o">.</span><span class="na">getLockName</span><span class="o">());</span>
			
			<span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">lockByIdByStep</span><span class="o">.</span><span class="na">getKeys</span><span class="o">();</span>
			<span class="k">for</span> <span class="o">(</span><span class="n">Key</span> <span class="n">key</span> <span class="o">:</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">getKeyName</span><span class="o">());</span>
			<span class="o">}</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	
<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h1 id="五动态sql">五、动态sql</h1>
<h2 id="1总体架构-2">1、总体架构：</h2>
<p><img src="https://i.loli.net/2020/12/21/q7axv8Hki2JLmNO.png" alt="image-20201221091302369"></p>
<h2 id="2bean-1">2、bean</h2>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Teacher</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">course</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">String</span> <span class="n">address</span><span class="o">;</span>
	
	<span class="kd">private</span> <span class="n">Date</span> <span class="n">birth</span><span class="o">;</span>

	<span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getCourse</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">course</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCourse</span><span class="o">(</span><span class="n">String</span> <span class="n">course</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">course</span> <span class="o">=</span> <span class="n">course</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getAddress</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">address</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAddress</span><span class="o">(</span><span class="n">String</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">address</span> <span class="o">=</span> <span class="n">address</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="n">Date</span> <span class="nf">getBirth</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">birth</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBirth</span><span class="o">(</span><span class="n">Date</span> <span class="n">birth</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">birth</span> <span class="o">=</span> <span class="n">birth</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="s">&#34;Teacher [id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&#34;, name=&#34;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&#34;, course=&#34;</span> <span class="o">+</span> <span class="n">course</span> <span class="o">+</span> <span class="s">&#34;, address=&#34;</span> <span class="o">+</span> <span class="n">address</span> <span class="o">+</span> <span class="s">&#34;, birth=&#34;</span>
				<span class="o">+</span> <span class="n">birth</span> <span class="o">+</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
	<span class="o">}</span>
	
	
<span class="o">}</span>

</code></pre></div><hr>
<h2 id="3dao-1">3、dao</h2>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.dao</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Teacher</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TeacherDao</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="n">Teacher</span> <span class="nf">getTeacherById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="nf">getTeacherByCondition</span><span class="o">(</span><span class="n">Teacher</span> <span class="n">teacher</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="nf">getTeacherByIdIn</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;ids&#34;</span><span class="o">)</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="nf">getTeacherByConditionChoose</span><span class="o">(</span><span class="n">Teacher</span> <span class="n">teacher</span><span class="o">);</span>
	
	<span class="kd">public</span> <span class="kt">int</span> <span class="nf">updateTeacher</span><span class="o">(</span><span class="n">Teacher</span> <span class="n">teacher</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></div><hr>
<h2 id="4daoxml-1">4、dao.xml</h2>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>

<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.TeacherDao&#34;</span><span class="nt">&gt;</span>
<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;com.lql.bean.Teacher&#34;</span> <span class="na">id=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;address&#34;</span> <span class="na">column=</span><span class="s">&#34;address&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;birth&#34;</span> <span class="na">column=</span><span class="s">&#34;birth_date&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;course&#34;</span> <span class="na">column=</span><span class="s">&#34;class_name&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;t_name&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>

<span class="c">&lt;!-- 抽取可重用的sql语句 --&gt;</span>
<span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">&#34;selectSql&#34;</span><span class="nt">&gt;</span>select * from t_teacher<span class="nt">&lt;/sql&gt;</span>
<span class="c">&lt;!-- id	t_name	class_name	address	birth_date --&gt;</span>

	<span class="c">&lt;!-- public Teacher getTeacherById(Integer id); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacherById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&#34;selectSql&#34;</span><span class="nt">&gt;&lt;/include&gt;</span>
		<span class="c">&lt;!-- select * from t_teacher --&gt;</span> where id=#{id}
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- public List&lt;Teacher&gt; getTeacherByCondition(Teacher teacher); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacherByCondition&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
		select * from t_teacher
		<span class="c">&lt;!-- test=&#34;&#34;：编写判断条件
</span><span class="c">		id!=null：取出传入的javaBean属性中的id值，判断其是否为空
</span><span class="c">		 --&gt;</span>
		 <span class="c">&lt;!-- &lt;where&gt;标签可以帮我们去除掉前面的and --&gt;</span>
		 <span class="c">&lt;!-- &lt;trim&gt;标签截取字符串
</span><span class="c">		 prefix=&#34;&#34;：前缀；为我们下面的sql整体添加一个前缀；
</span><span class="c">		 prefixOverrides=&#34;&#34;：去除整体字符串前面多余的字符；
</span><span class="c">		 suffix=&#34;&#34;：为整体添加一个后缀
</span><span class="c">		 suffixOverrides=&#34;&#34;：后面哪个多了，可以去掉
</span><span class="c">		  --&gt;</span>
		  <span class="c">&lt;!-- 我们的查询条件就放在where标签中，每个and写在前面，where帮我们自动取出前面多余的and --&gt;</span>
		 <span class="nt">&lt;trim</span> <span class="na">prefix=</span><span class="s">&#34;where&#34;</span> 
		  <span class="na">suffixOverrides=</span><span class="s">&#34;and &#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;id!=null&#34;</span><span class="nt">&gt;</span>
			id &gt; #{id} and
		<span class="nt">&lt;/if&gt;</span> 
		<span class="c">&lt;!-- 空串&#34;&#34;
</span><span class="c">		 and：&amp;&amp;
</span><span class="c">		 or：||；
</span><span class="c">		 if()：传入非常强大的判断条件；
</span><span class="c">		 
</span><span class="c">		 OGNL表达式:对象导航图（相当于级联属性）
</span><span class="c">		 方法、静态方法、构造器、xxx
</span><span class="c">		 在mybatis中，传入的参数可以用来做判断；
</span><span class="c">		 额外还有两个东西：
</span><span class="c">		 	_parameter：代表传入来的参数：
</span><span class="c">		 		1）、传入了单个参数：_parameter就代表这个参数
</span><span class="c">		 		2）、传入了多个参数：_parameter就代表多个参数集合起来的map
</span><span class="c">		 	_databaseId：代表当前环境
</span><span class="c">		 		如果配置了databaseIdProvider，_parameter就有值
</span><span class="c">		  --&gt;</span>
		  
		  <span class="c">&lt;!-- 绑定一个表达式的值到一个变量（不推荐） --&gt;</span>
		<span class="nt">&lt;bind</span> <span class="na">name=</span><span class="s">&#34;_name&#34;</span> <span class="na">value=</span><span class="s">&#34;&#39;%&#39;+name+&#39;%&#39;&#34;</span><span class="nt">/&gt;</span>  
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;name!=null &amp;amp;&amp;amp; !name.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
			 t_name like #{_name} and
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;birth!=null&#34;</span><span class="nt">&gt;</span>
			 birth_date <span class="ni">&amp;lt;</span> #{birth} and
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;/trim&gt;</span>
		
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- public List&lt;Teacher&gt; getTeacherByIdIn(List&lt;Integer&gt; ids); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacherByIdIn&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
		SELECT * FROM t_teacher WHERE id IN 
		<span class="c">&lt;!-- 帮我们遍历集合的；
</span><span class="c">		collection=&#34;&#34;：指定要遍历的集合的key
</span><span class="c">		close=&#34;&#34; ：以什么结束
</span><span class="c">		index=&#34;i&#34; ：索引
</span><span class="c">			如果遍历的是一个list：
</span><span class="c">				index：指定的变量保存了当前索引；
</span><span class="c">				item：就是保存当前遍历的元素的值；
</span><span class="c">			如果遍历的是一个map：
</span><span class="c">				index：指定的变量就是保存了当前遍历的元素的key
</span><span class="c">				item：就是保存当前遍历的元素的值；
</span><span class="c">		item=&#34;变量名&#34; ：每次遍历出的元素起一个变量名方便引用
</span><span class="c">		open=&#34;&#34; ：以什么开始
</span><span class="c">		separator=&#34;&#34;：每次遍历元素的分隔符
</span><span class="c">		 --&gt;</span>
		 <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;ids.size &gt;0&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;ids&#34;</span> <span class="na">item=</span><span class="s">&#34;id_item&#34;</span> 
		<span class="na">open=</span><span class="s">&#34;(&#34;</span> <span class="na">close=</span><span class="s">&#34;)&#34;</span> <span class="na">separator=</span><span class="s">&#34;,&#34;</span><span class="nt">&gt;</span>
			#{id_item}
		<span class="nt">&lt;/foreach&gt;</span>
		<span class="nt">&lt;/if&gt;</span>
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- public List&lt;Teacher&gt; getTeacherByConditionChoose(Teacher teacher); --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacherByConditionChoose&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;teacherMap&#34;</span><span class="nt">&gt;</span>
		SELECT * FROM t_teacher
		<span class="nt">&lt;where&gt;</span>
			<span class="nt">&lt;choose&gt;</span>
				<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;id!=null&#34;</span><span class="nt">&gt;</span>
					id=#{id}
				<span class="nt">&lt;/when&gt;</span>
				<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;name!=null and !name.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
					t_name=#{name}
				<span class="nt">&lt;/when&gt;</span>
				<span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;birth!=null&#34;</span><span class="nt">&gt;</span>
					birth_date=#{birth}
				<span class="nt">&lt;/when&gt;</span>
				<span class="nt">&lt;otherwise&gt;</span>
					1=1
				<span class="nt">&lt;/otherwise&gt;</span>
			<span class="nt">&lt;/choose&gt;</span>
		<span class="nt">&lt;/where&gt;</span>
	<span class="nt">&lt;/select&gt;</span>
	
	<span class="c">&lt;!-- public int updateTeacher(Teacher teacher); --&gt;</span>
	<span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateTeacher&#34;</span><span class="nt">&gt;</span>
		UPDATE t_teacher
		<span class="nt">&lt;set&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;name!=null and !name.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
			t_name=#{name},
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;course!=null and !course.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
			class_name=#{course},
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;address!=null and !address.equals(&amp;quot;&amp;quot;)&#34;</span><span class="nt">&gt;</span>
			address=#{address},
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;birth!=null&#34;</span><span class="nt">&gt;</span>
			birth_date=#{birth}
		<span class="nt">&lt;/if&gt;</span>
		<span class="nt">&lt;/set&gt;</span>
		<span class="nt">&lt;where&gt;</span>
			id=#{id}
		<span class="nt">&lt;/where&gt;</span>
	<span class="nt">&lt;/update&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div><hr>
<h2 id="5mybatis-configxml-2">5、mybatis-config.xml</h2>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

	<span class="nt">&lt;settings&gt;</span>
		<span class="c">&lt;!-- 开启延迟加载开关 --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;lazyLoadingEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- 开启属性按需加载(默认开启) --&gt;</span>
		<span class="c">&lt;!-- &lt;setting name=&#34;aggressiveLazyLoading&#34; value=&#34;false&#34;/&gt; --&gt;</span>
	<span class="nt">&lt;/settings&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/test?serverTimezone=UTC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
      <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<h2 id="6mybatistestjava-1">6、MyBatisTest.java</h2>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.TeacherDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisTest</span> <span class="o">{</span>

	<span class="c1">//工厂一个
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
		
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">TeacherDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="cm">/*Teacher teacher = new Teacher();
</span><span class="cm">			teacher.setId(1);
</span><span class="cm">			teacher.setName(&#34;%a%&#34;);
</span><span class="cm">			//teacher.setBirth(new Date());
</span><span class="cm">			List&lt;Teacher&gt; list = mapper.getTeacherByCondition(teacher);*/</span>
			
			<span class="c1">//List&lt;Teacher&gt; list = mapper.getTeacherByIdIn(Arrays.asList(1,2,3,4,5));
</span><span class="c1"></span>			<span class="n">Teacher</span> <span class="n">teacher</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Teacher</span><span class="o">();</span>
			<span class="c1">//teacher.setId(1);
</span><span class="c1"></span>			<span class="c1">//teacher.setName(&#34;%a%&#34;);
</span><span class="c1"></span>			<span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherByConditionChoose</span><span class="o">(</span><span class="n">teacher</span><span class="o">);</span>
			
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">TeacherDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Teacher</span> <span class="n">teacher</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Teacher</span><span class="o">();</span>
			<span class="n">teacher</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">teacher</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;hahaha&#34;</span><span class="o">);</span>
			<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">updateTeacher</span><span class="o">(</span><span class="n">teacher</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
		<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;java&#34;</span><span class="o">);</span>
		<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;c++&#34;</span><span class="o">);</span>
		<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&#34;python&#34;</span><span class="o">);</span>
		<span class="n">Iterator</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
		<span class="k">while</span><span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">()){</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h1 id="六缓存机制">六、缓存机制</h1>
<h2 id="1缓存作用">1、缓存作用</h2>
<ul>
<li>暂时的存储一些数据</li>
<li>加快系统的查询速度</li>
</ul>
<h2 id="2mybatis缓存机制">2、MyBatis缓存机制</h2>
<ul>
<li>
<p>Map保存查询出的一些数据</p>
</li>
<li>
<p><a href="#3%E3%80%81%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98">一级缓存</a></p>
<ul>
<li>线程级别的缓存</li>
<li>本地缓存</li>
<li>SqlSession级别的缓存</li>
<li>默认存在</li>
</ul>
</li>
<li>
<p><a href="#4%E3%80%81%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98">二级缓存</a></p>
<ul>
<li>全局范围的缓存</li>
<li><strong>namespace</strong>级别的缓存</li>
<li>除过当前的线程/SqlSession能用外其他也可以使用</li>
</ul>
</li>
</ul>
<hr>
<h2 id="3一级缓存">3、一级缓存</h2>
<ul>
<li>只要之前查询过的数据，mybatis就会保存在一个缓存中（Map）</li>
<li>下次获取直接从缓存中拿</li>
</ul>
<h3 id="一级缓存失效的几种情况">一级缓存失效的几种情况</h3>
<ol>
<li>不同的SqlSession对应不同的一级缓存</li>
<li>同一个SqlSession但是查询条件不同</li>
<li>同一个SqlSession两次查询期间执行了任何一次增删改操作</li>
<li>同一个SqlSession两次查询期间手动清空了缓存</li>
</ol>
<hr>
<h3 id="源码位置">源码位置</h3>
<ul>
<li>key很长（敏感）</li>
</ul>
<p><img src="https://i.loli.net/2020/12/18/jZ5kLDyefasgU8h.png" alt="image-20201218133253151"></p>
<hr>
<h2 id="4二级缓存">4、二级缓存</h2>
<ul>
<li><strong>Sqlsession</strong>关闭或者提交以后，一级缓存的数据会放在二级缓存中</li>
<li>mybatis默认没有使用的</li>
</ul>
<h3 id="1二级缓存的使用">1.二级缓存的使用</h3>
<h4 id="1全局配置开启二级缓存">1、全局配置开启二级缓存</h4>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 开启全局缓存开关(默认开启) --&gt;</span>
<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</code></pre></div><hr>
<h4 id="2配置某个daoxml文件让其使用二级缓存">2、配置某个dao.xml文件，让其使用二级缓存</h4>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 使用二级缓存 --&gt;</span>
<span class="nt">&lt;cache/&gt;</span>
</code></pre></div><hr>
<h3 id="2缓存原理">2.缓存原理</h3>
<p><img src="https://i.loli.net/2020/12/18/bpCKEyzc1tQOn4L.png" alt="image-20201218145239818"></p>
<hr>
<h2 id="5缓存有关设置">5、缓存有关设置</h2>
<h3 id="1全局setting的cacheenable">1.全局setting的cacheEnable</h3>
<ul>
<li>–配置二级缓存的开关（一级缓存一直是打开的）</li>
</ul>
<h3 id="2select标签的usecache属性">2.select标签的useCache属性</h3>
<ul>
<li>–配置这个<strong>select</strong>是否使用二级缓存（一级缓存一直是使用的）</li>
</ul>
<h3 id="3sql标签的flushcache属性">3.sql标签的flushCache属性</h3>
<ul>
<li>–sql执行以后，会同时清空一级和二级缓存</li>
<li>增删改默认flushCache=true</li>
<li>查询默认flushCache=false</li>
</ul>
<h3 id="4sqlsessionclearcache">4.sqlSession.clearCache()</h3>
<ul>
<li>–只是用来清除一级缓存</li>
<li>当在某一个作用域 (一级缓存Session/二级缓存Namespaces) 进行了 C/U/D 操作后，默认该作用域下<strong>所有</strong> <strong>select</strong> 中的缓存将被clear</li>
</ul>
<hr>
<h2 id="6整合第三方缓存">6、整合第三方缓存</h2>
<ul>
<li>MyBatis&mdash;&ndash;Cache接口</li>
<li>整合<strong>ehcache</strong>（非常专业的java进程内的缓存框架）</li>
</ul>
<hr>
<h3 id="1导包">1.导包</h3>
<blockquote>
<p>ehcache-core-2.6.11.jar（ehcache核心包）
mybatis-ehcache-1.2.1.jar（ehcache的整合包）</p>
<p>slf4j-api-1.7.30.jar
slf4j-log4j12-1.7.30.jar</p>
<hr>
</blockquote>
<h3 id="2ehcache配置文件">2.ehcache配置文件</h3>
<ul>
<li>文件名叫<a href="#5.echcache.xml"><strong>ehcache.xml</strong></a></li>
<li>放在类路径的根目录下（<strong>conf</strong>下）</li>
</ul>
<h3 id="3在mapperxml中配置使用自定义的缓存">3.在mapper.xml中配置使用自定义的缓存</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 使用mybatis默认二级缓存&lt;cache /&gt; --&gt;</span>
<span class="nt">&lt;cache</span> <span class="na">type=</span><span class="s">&#34;org.mybatis.caches.ehcache.EhcacheCache&#34;</span> <span class="nt">/&gt;</span>
</code></pre></div><hr>
<h3 id="4别的dao还要用这个缓存">4.别的dao还要用这个缓存</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 和别的dao共用一块缓存 --&gt;</span>
<span class="nt">&lt;cache-ref</span> <span class="na">namespace=</span><span class="s">&#34;com.lql.dao.TeacherDao&#34;</span><span class="nt">/&gt;</span>
</code></pre></div><hr>
<h3 id="5echcachexml">5.echcache.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;ehcache</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
 <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">&#34;../config/ehcache.xsd&#34;</span><span class="nt">&gt;</span>
 <span class="c">&lt;!-- 磁盘保存路径 --&gt;</span>
 <span class="nt">&lt;diskStore</span> <span class="na">path=</span><span class="s">&#34;D:\44\ehcache&#34;</span> <span class="nt">/&gt;</span>
 
 <span class="nt">&lt;defaultCache</span> 
   <span class="na">maxElementsInMemory=</span><span class="s">&#34;1&#34;</span> 
   <span class="na">maxElementsOnDisk=</span><span class="s">&#34;10000000&#34;</span>
   <span class="na">eternal=</span><span class="s">&#34;false&#34;</span> 
   <span class="na">overflowToDisk=</span><span class="s">&#34;true&#34;</span> 
   <span class="na">timeToIdleSeconds=</span><span class="s">&#34;120&#34;</span>
   <span class="na">timeToLiveSeconds=</span><span class="s">&#34;120&#34;</span> 
   <span class="na">diskExpiryThreadIntervalSeconds=</span><span class="s">&#34;120&#34;</span>
   <span class="na">memoryStoreEvictionPolicy=</span><span class="s">&#34;LRU&#34;</span><span class="nt">&gt;</span>
 <span class="nt">&lt;/defaultCache&gt;</span>
<span class="nt">&lt;/ehcache&gt;</span>
 
<span class="c">&lt;!-- 
</span><span class="c">属性说明：
</span><span class="c">l diskStore：指定数据在磁盘中的存储位置。
</span><span class="c">l defaultCache：当借助CacheManager.add(&#34;demoCache&#34;)创建Cache时，EhCache便会采用&lt;defalutCache/&gt;指定的的管理策略
</span><span class="c"> 
</span><span class="c">以下属性是必须的：
</span><span class="c">l maxElementsInMemory - 在内存中缓存的element的最大数目 
</span><span class="c">l maxElementsOnDisk - 在磁盘上缓存的element的最大数目，若是0表示无穷大
</span><span class="c">l eternal - 设定缓存的elements是否永远不过期。如果为true，则缓存的数据始终有效，如果为false那么还要根据timeToIdleSeconds，timeToLiveSeconds判断
</span><span class="c">l overflowToDisk - 设定当内存缓存溢出的时候是否将过期的element缓存到磁盘上
</span><span class="c"> 
</span><span class="c">以下属性是可选的：
</span><span class="c">l timeToIdleSeconds - 当缓存在EhCache中的数据前后两次访问的时间超过timeToIdleSeconds的属性取值时，这些数据便会删除，默认值是0,也就是可闲置时间无穷大
</span><span class="c">l timeToLiveSeconds - 缓存element的有效生命期，默认是0.,也就是element存活时间无穷大
</span><span class="c"> diskSpoolBufferSizeMB 这个参数设置DiskStore(磁盘缓存)的缓存区大小.默认是30MB.每个Cache都应该有自己的一个缓冲区.
</span><span class="c">l diskPersistent - 在VM重启的时候是否启用磁盘保存EhCache中的数据，默认是false。
</span><span class="c">l diskExpiryThreadIntervalSeconds - 磁盘缓存的清理线程运行间隔，默认是120秒。每个120s，相应的线程会进行一次EhCache中数据的清理工作
</span><span class="c">l memoryStoreEvictionPolicy - 当内存缓存达到最大，有新的element加入的时候， 移除缓存中element的策略。默认是LRU（最近最少使用），可选的有LFU（最不常使用）和FIFO（先进先出）
</span><span class="c"> --&gt;</span>
</code></pre></div><hr>
<h3 id="6mybatistestjava-2">6.MyBatisTest.java</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.lql.bean.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.dao.TeacherDao</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisTest</span> <span class="o">{</span>

	<span class="c1">//工厂一个
</span><span class="c1"></span>	<span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
		
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">{</span>
		<span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
		<span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
		<span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 体会一级缓存
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">TeacherDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
			<span class="n">Teacher</span> <span class="n">teacherById</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;=========================&#34;</span><span class="o">);</span>
			<span class="n">Teacher</span> <span class="n">teacherById2</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById2</span><span class="o">);</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById</span> <span class="o">==</span> <span class="n">teacherById2</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
			<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 一级缓存失效的几种情况
</span><span class="cm">	 * 一级缓存是SqlSession级别的缓存；
</span><span class="cm">	 * 1、不同的sqlSession使用不同的一级缓存；
</span><span class="cm">	 * 		只有在同一个sqlSession期间查询到的数据会保存在这个sqlSession的缓存中；
</span><span class="cm">	 * 		下次使用个这个sqlSession查询会从缓存中拿。
</span><span class="cm">	 * 2、同一个方法，不同的参数，由于可能之前没查过，所以还会发新的sql；
</span><span class="cm">	 * 3、在这个sqlSession期间执行任何一次增删改操作，会把缓存清空；
</span><span class="cm">	 * 4、手动清空了缓存；
</span><span class="cm">	 * 
</span><span class="cm">	 * 每次查询，先看一级缓存中有没有，如果没有就去发送新的sql；每个sqlSession拥有自己的一级缓存；
</span><span class="cm">	 * 
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="c1">//1、第一个会话
</span><span class="c1"></span>		<span class="n">TeacherDao</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">Teacher</span> <span class="n">teacher1</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;============================&#34;</span><span class="o">);</span>
		<span class="c1">//执行任何一个增删改操作
</span><span class="c1"></span>		<span class="cm">/*Teacher teacher = new Teacher();
</span><span class="cm">		teacher.setId(3);
</span><span class="cm">		teacher.setName(&#34;3333&#34;);
</span><span class="cm">		mapper.updateTeacher(teacher);*/</span>
		
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;手动清空缓存&#34;</span><span class="o">);</span>
		<span class="c1">//清空当前sqlSession的以及缓存
</span><span class="c1"></span>		<span class="c1">//openSession.clearCache();
</span><span class="c1"></span>		
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;============================&#34;</span><span class="o">);</span>
		<span class="n">Teacher</span> <span class="n">teacher2</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher2</span><span class="o">);</span>
		
		<span class="c1">//2、第二个会话
</span><span class="c1"></span>		<span class="cm">/*SqlSession openSession2 = sqlSessionFactory.openSession();
</span><span class="cm">		TeacherDao mapper2 = openSession2.getMapper(TeacherDao.class);
</span><span class="cm">		Teacher teacher2 = mapper2.getTeacherById(1);
</span><span class="cm">		System.out.println(teacher2);*/</span>
		
		<span class="n">openSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
		<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="c1">//openSession2.close();
</span><span class="c1"></span>	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 体验二级缓存
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test03</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">SqlSession</span> <span class="n">openSession2</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">TeacherDao</span> <span class="n">mapper1</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">TeacherDao</span> <span class="n">mapper2</span> <span class="o">=</span> <span class="n">openSession2</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		
		<span class="c1">//1、第一个dao查询1号teacher
</span><span class="c1"></span>		<span class="n">Teacher</span> <span class="n">teacher1</span> <span class="o">=</span> <span class="n">mapper1</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher1</span><span class="o">);</span>
		<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		
		<span class="c1">//1、第二个dao查询1号teacher
</span><span class="c1"></span>		<span class="n">Teacher</span> <span class="n">teacher2</span> <span class="o">=</span> <span class="n">mapper2</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher2</span><span class="o">);</span>
		<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
	
	<span class="cm">/**
</span><span class="cm">	 * 
</span><span class="cm">	 * 1、不会出现一级缓存和二级缓存中有同一个数据：
</span><span class="cm">	 * 		二级缓存中，一级缓存关闭了就有了；
</span><span class="cm">	 * 		一级缓存中，二级缓存中没有此数据，就会看一级缓存，一级缓存没有就去查询数据库
</span><span class="cm">	 * 2、任何时候都是先看二级缓存，再看一级缓存，如果大家都没有就去查询数据库；
</span><span class="cm">	 * 二-----》一====》库
</span><span class="cm">	 */</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">test04</span><span class="o">()</span> <span class="o">{</span>
		<span class="n">SqlSession</span> <span class="n">openSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">TeacherDao</span> <span class="n">teacherDao</span> <span class="o">=</span> <span class="n">openSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">Teacher</span> <span class="n">teacher</span> <span class="o">=</span> <span class="n">teacherDao</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher</span><span class="o">);</span>
		<span class="n">openSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;===============&#34;</span><span class="o">);</span>
		
		<span class="n">SqlSession</span> <span class="n">openSession2</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
		<span class="n">TeacherDao</span> <span class="n">teacherDao2</span> <span class="o">=</span> <span class="n">openSession2</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">Teacher</span> <span class="n">teacherById</span> <span class="o">=</span> <span class="n">teacherDao2</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById</span><span class="o">);</span>
		
		<span class="n">Teacher</span> <span class="n">teacherById2</span> <span class="o">=</span> <span class="n">teacherDao2</span><span class="o">.</span><span class="na">getTeacherById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacherById2</span><span class="o">);</span>
		
		
		<span class="cm">/*Teacher teacherById2 = teacherDao2.getTeacherById(1);
</span><span class="cm">		System.out.println(teacherById2);
</span><span class="cm">		
</span><span class="cm">		System.out.println(&#34;以下是查询二号teacher：&#34;);
</span><span class="cm">		Teacher teacherById3 = teacherDao2.getTeacherById(2);
</span><span class="cm">		System.out.println(teacherById3);
</span><span class="cm">		Teacher teacherById4 = teacherDao2.getTeacherById(2);
</span><span class="cm">		System.out.println(teacherById4);
</span><span class="cm">		*/</span>
		<span class="n">openSession2</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
	
	
<span class="o">}</span>
</code></pre></div><hr>
<hr>
<h1 id="七ssm整合">七、SSM整合</h1>
<ul>
<li><strong>SSM</strong>
<ul>
<li><strong>Spring</strong>+<strong>SpringMVC</strong>+<strong>MyBatis</strong></li>
</ul>
</li>
</ul>
<h2 id="1导包-1">1、导包</h2>
<h3 id="1spring">1.Spring</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="err">【</span><span class="n">aop核心</span><span class="err">】</span>
<span class="n">com</span><span class="o">.</span><span class="na">springsource</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">sf</span><span class="o">.</span><span class="na">cglib</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">com</span><span class="o">.</span><span class="na">springsource</span><span class="o">.</span><span class="na">org</span><span class="o">.</span><span class="na">aopalliance</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">com</span><span class="o">.</span><span class="na">springsource</span><span class="o">.</span><span class="na">org</span><span class="o">.</span><span class="na">aspectj</span><span class="o">.</span><span class="na">weaver</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">6</span><span class="o">.</span><span class="na">8</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">aspects</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">【</span><span class="n">ioc核心</span><span class="err">】</span>
<span class="n">commons</span><span class="o">-</span><span class="n">logging</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">3</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">aop</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">beans</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">context</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">expression</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">【</span><span class="n">jdbc核心</span><span class="err">】</span>
<span class="n">spring</span><span class="o">-</span><span class="n">jdbc</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">orm</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">tx</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>

<span class="err">【</span><span class="n">测试</span><span class="err">】</span>
<span class="n">spring</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
   
</code></pre></div><hr>
<h3 id="2springmvc">2.SpringMVC</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="err">【</span><span class="n">Ajax</span><span class="err">】</span>
<span class="n">jackson</span><span class="o">-</span><span class="n">annotations</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">12</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">jackson</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">12</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">jackson</span><span class="o">-</span><span class="n">databind</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">12</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>

<span class="err">【</span><span class="n">数据校验</span><span class="err">】</span>
<span class="n">hibernate</span><span class="o">-</span><span class="n">validator</span><span class="o">-</span><span class="n">6</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">7</span><span class="o">.</span><span class="na">Final</span><span class="o">.</span><span class="na">jar</span>
<span class="n">hibernate</span><span class="o">-</span><span class="n">validator</span><span class="o">-</span><span class="n">annotation</span><span class="o">-</span><span class="n">processor</span><span class="o">-</span><span class="n">6</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">7</span><span class="o">.</span><span class="na">Final</span><span class="o">.</span><span class="na">jar</span>
<span class="n">classmate</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">5</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">jar</span>
<span class="n">jboss</span><span class="o">-</span><span class="n">logging</span><span class="o">-</span><span class="n">3</span><span class="o">.</span><span class="na">4</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">Final</span><span class="o">.</span><span class="na">jar</span>
<span class="n">validation</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">Final</span><span class="o">.</span><span class="na">jar</span>

<span class="err">【</span><span class="n">上传下载</span><span class="err">】</span>
<span class="n">commons</span><span class="o">-</span><span class="n">fileupload</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">4</span><span class="o">.</span><span class="na">jar</span>
<span class="n">commons</span><span class="o">-</span><span class="n">io</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">8</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">【</span><span class="n">jstl</span><span class="o">-</span><span class="n">jsp标准标签库</span><span class="err">】</span>
<span class="n">jstl</span><span class="o">.</span><span class="na">jar</span>
<span class="n">standard</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">【</span><span class="n">验证码</span><span class="err">】</span>   
<span class="n">kaptcha</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">3</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">jar</span>  
    
<span class="err">【</span><span class="n">SpringMVC核心</span><span class="err">】</span>
<span class="n">spring</span><span class="o">-</span><span class="n">web</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
<span class="n">spring</span><span class="o">-</span><span class="n">webmvc</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">RELEASE</span><span class="o">.</span><span class="na">jar</span>
</code></pre></div><hr>
<h3 id="3mybatis">3.MyBatis</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="err">【</span><span class="n">mybatis核心</span><span class="err">】</span>
<span class="n">mybatis</span><span class="o">-</span><span class="n">3</span><span class="o">.</span><span class="na">5</span><span class="o">.</span><span class="na">6</span><span class="o">.</span><span class="na">jar</span>

<span class="err">【</span><span class="n">和spring的整合包</span><span class="err">】</span>
<span class="n">mybatis</span><span class="o">-</span><span class="n">spring</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">6</span><span class="o">.</span><span class="na">jar</span>
    
<span class="err">【</span><span class="n">ehcache整合</span><span class="err">】</span>
<span class="n">ehcache</span><span class="o">-</span><span class="n">core</span><span class="o">-</span><span class="n">2</span><span class="o">.</span><span class="na">6</span><span class="o">.</span><span class="na">11</span><span class="o">.</span><span class="na">jar</span>
<span class="n">mybatis</span><span class="o">-</span><span class="n">ehcache</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">jar</span>
<span class="n">log4j</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">17</span><span class="o">.</span><span class="na">jar</span>
<span class="n">slf4j</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">7</span><span class="o">.</span><span class="na">30</span><span class="o">.</span><span class="na">jar</span>
<span class="n">slf4j</span><span class="o">-</span><span class="n">log4j12</span><span class="o">-</span><span class="n">1</span><span class="o">.</span><span class="na">7</span><span class="o">.</span><span class="na">30</span><span class="o">.</span><span class="na">jar</span>
</code></pre></div><hr>
<h3 id="4其他的">4.其他的</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="c1">//数据源，驱动
</span><span class="c1"></span><span class="n">mysql</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="n">java</span><span class="o">-</span><span class="n">8</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">22</span><span class="o">.</span><span class="na">jar</span>
<span class="n">c3p0</span><span class="o">-</span><span class="n">0</span><span class="o">.</span><span class="na">9</span><span class="o">.</span><span class="na">5</span><span class="o">.</span><span class="na">5</span><span class="o">.</span><span class="na">jar</span>
<span class="n">mchange</span><span class="o">-</span><span class="n">commons</span><span class="o">-</span><span class="n">java</span><span class="o">-</span><span class="n">0</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">20</span><span class="o">.</span><span class="na">jar</span>
<span class="c1">//分页插件
</span><span class="c1"></span><span class="n">pagehelper</span><span class="o">-</span><span class="n">5</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">0</span><span class="o">.</span><span class="na">jar</span>
<span class="n">jsqlparser</span><span class="o">-</span><span class="n">3</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">jar</span>
</code></pre></div><hr>
<h3 id="5总览">5.总览：</h3>
<p><img src="https://i.loli.net/2020/12/21/8P1X24gnHdcoNf3.png" alt="image-20201221101143992"></p>
<hr>
<h2 id="2写配置-1">2、写配置</h2>
<h3 id="0webxml">0.web.xml</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;web-app</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span class="na">xmlns=</span><span class="s">&#34;http://xmlns.jcp.org/xml/ns/javaee&#34;</span> <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&#34;</span> <span class="na">id=</span><span class="s">&#34;WebApp_ID&#34;</span> <span class="na">version=</span><span class="s">&#34;3.1&#34;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;display-name&gt;</span>7.SSM<span class="nt">&lt;/display-name&gt;</span>
  <span class="nt">&lt;welcome-file-list&gt;</span>
    <span class="nt">&lt;welcome-file&gt;</span>index.jsp<span class="nt">&lt;/welcome-file&gt;</span>
  <span class="nt">&lt;/welcome-file-list&gt;</span>
  
  <span class="c">&lt;!-- 配置Spring容器启动 --&gt;</span>
  <span class="c">&lt;!-- needed for ContextLoaderListener --&gt;</span>
	<span class="nt">&lt;context-param&gt;</span>
		<span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
		<span class="c">&lt;!-- 指定Spring配置文件位置 --&gt;</span>
		<span class="nt">&lt;param-value&gt;</span>classpath:spring/applicationContext.xml<span class="nt">&lt;/param-value&gt;</span>
	<span class="nt">&lt;/context-param&gt;</span>

	<span class="c">&lt;!-- Bootstraps the root web application context before servlet initialization --&gt;</span>
	<span class="nt">&lt;listener&gt;</span>
		<span class="nt">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="nt">&lt;/listener-class&gt;</span>
	<span class="nt">&lt;/listener&gt;</span>
	
	<span class="c">&lt;!-- 配置springmvc的前端控制器 --&gt;</span>
	<span class="c">&lt;!-- The front controller of this Spring Web application, responsible for handling all application requests --&gt;</span>
	<span class="nt">&lt;servlet&gt;</span>
		<span class="nt">&lt;servlet-name&gt;</span>springDispatcherServlet<span class="nt">&lt;/servlet-name&gt;</span>
		<span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
		<span class="nt">&lt;init-param&gt;</span>
			<span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
			<span class="nt">&lt;param-value&gt;</span>classpath:spring/applicationContext-mvc.xml<span class="nt">&lt;/param-value&gt;</span>
		<span class="nt">&lt;/init-param&gt;</span>
		<span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
	<span class="nt">&lt;/servlet&gt;</span>

	<span class="c">&lt;!-- Map all requests to the DispatcherServlet for handling --&gt;</span>
	<span class="nt">&lt;servlet-mapping&gt;</span>
		<span class="nt">&lt;servlet-name&gt;</span>springDispatcherServlet<span class="nt">&lt;/servlet-name&gt;</span>
		<span class="nt">&lt;url-pattern&gt;</span>/<span class="nt">&lt;/url-pattern&gt;</span>
	<span class="nt">&lt;/servlet-mapping&gt;</span>
	
	<span class="c">&lt;!-- 两个标准配置 --&gt;</span>
	<span class="c">&lt;!-- 字符编码 --&gt;</span>
	<span class="c">&lt;!-- &lt;filter&gt;
</span><span class="c">		&lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt;
</span><span class="c">		&lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
</span><span class="c">		&lt;init-param&gt;
</span><span class="c">			&lt;param-name&gt;encoding&lt;/param-name&gt;
</span><span class="c">			&lt;param-value&gt;utf-8&lt;/param-value&gt;
</span><span class="c">		&lt;/init-param&gt;
</span><span class="c">		&lt;init-param&gt;
</span><span class="c">			&lt;param-name&gt;forceRequestEncoding&lt;/param-name&gt;
</span><span class="c">			&lt;param-value&gt;true&lt;/param-value&gt;
</span><span class="c">		&lt;/init-param&gt;
</span><span class="c">		&lt;init-param&gt;
</span><span class="c">			&lt;param-name&gt;forceResponseEncoding&lt;/param-name&gt;
</span><span class="c">			&lt;param-value&gt;true&lt;/param-value&gt;
</span><span class="c">		&lt;/init-param&gt;
</span><span class="c">	&lt;/filter&gt;
</span><span class="c">	&lt;filter-mapping&gt;
</span><span class="c">		&lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt;
</span><span class="c">		&lt;url-pattern&gt;/*&lt;/url-pattern&gt;
</span><span class="c">	&lt;/filter-mapping&gt; --&gt;</span>
	
	<span class="c">&lt;!-- 支持Rest风格的过滤器 --&gt;</span>
	<span class="nt">&lt;filter&gt;</span>
		<span class="nt">&lt;filter-name&gt;</span>HiddenHttpMethodFilter<span class="nt">&lt;/filter-name&gt;</span>
		<span class="nt">&lt;filter-class&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="nt">&lt;/filter-class&gt;</span>
	<span class="nt">&lt;/filter&gt;</span>
	<span class="nt">&lt;filter-mapping&gt;</span>
		<span class="nt">&lt;filter-name&gt;</span>HiddenHttpMethodFilter<span class="nt">&lt;/filter-name&gt;</span>
		<span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
	<span class="nt">&lt;/filter-mapping&gt;</span>
<span class="nt">&lt;/web-app&gt;</span>
</code></pre></div><hr>
<h3 id="1spring的配置">1.spring的配置</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
	<span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
	<span class="na">xmlns:aop=</span><span class="s">&#34;http://www.springframework.org/schema/aop&#34;</span>
	<span class="na">xmlns:tx=</span><span class="s">&#34;http://www.springframework.org/schema/tx&#34;</span>
	<span class="na">xmlns:context=</span><span class="s">&#34;http://www.springframework.org/schema/context&#34;</span>
	<span class="na">xmlns:mybatis-spring=</span><span class="s">&#34;http://mybatis.org/schema/mybatis-spring&#34;</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://mybatis.org/schema/mybatis-spring http://mybatis.org/schema/mybatis-spring-1.2.xsd
</span><span class="s">		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class="s">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd
</span><span class="s">		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.3.xsd
</span><span class="s">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.3.xsd&#34;</span><span class="nt">&gt;</span>

	<span class="c">&lt;!-- Spring除过控制器不要，剩下的业务逻辑组件都要（包括dao，service。。） --&gt;</span>
	<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.lql&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- 扫描排除不写use-default-filters=&#34;false&#34; --&gt;</span>
		<span class="nt">&lt;context:exclude-filter</span> <span class="na">type=</span><span class="s">&#34;annotation&#34;</span> <span class="na">expression=</span><span class="s">&#34;org.springframework.stereotype.Controller&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/context:component-scan&gt;</span>
	
	<span class="c">&lt;!-- 0、导入外部配置文件 --&gt;</span>
	<span class="nt">&lt;context:property-placeholder</span> <span class="na">location=</span><span class="s">&#34;classpath:dbconfig.properties&#34;</span><span class="nt">/&gt;</span>
	<span class="c">&lt;!-- 1、配数据源 --&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;ds&#34;</span> <span class="na">class=</span><span class="s">&#34;com.mchange.v2.c3p0.ComboPooledDataSource&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;user&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.user}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.password}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driverClass&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.driverClass}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;jdbcUrl&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.jdbcUrl}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;maxPoolSize&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.maxPoolSize}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;minPoolSize&#34;</span> <span class="na">value=</span><span class="s">&#34;${jdbc.minPoolSize}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="c">&lt;!-- 2、配置JdbcTemplate操作数据库（pass） --&gt;</span>
	<span class="c">&lt;!-- 3、配置使用mybatis操作数据库 --&gt;</span>
	<span class="c">&lt;!-- 可以根据配置文件得到SqlSessionFactory --&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;sqlSessionFactoryBean&#34;</span> <span class="na">class=</span><span class="s">&#34;org.mybatis.spring.SqlSessionFactoryBean&#34;</span><span class="nt">&gt;</span>
		
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;ds&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="c">&lt;!-- 指定xml映射文件的位置 --&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;mapperLocations&#34;</span> <span class="na">value=</span><span class="s">&#34;classpath:mybatis/mapper/*.xml&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		
		<span class="c">&lt;!-- 指定配置文件位置 --&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;configLocation&#34;</span> <span class="na">value=</span><span class="s">&#34;classpath:mybatis/mybatis-config.xml&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	<span class="c">&lt;!-- 我们要把每一个dao接口的实现加入到ioc容器 --&gt;</span>
	<span class="c">&lt;!-- &lt;bean class=&#34;org.mybatis.spring.mapper.MapperScannerConfigurer&#34;&gt;
</span><span class="c">		指定dao接口所在的包
</span><span class="c">		&lt;property name=&#34;basePackage&#34; value=&#34;com.lql.dao&#34;&gt;&lt;/property&gt;
</span><span class="c">	&lt;/bean&gt; --&gt;</span>
	<span class="c">&lt;!-- 替换上面的简单写法 --&gt;</span>
	<span class="nt">&lt;mybatis-spring:scan</span> <span class="na">base-package=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">/&gt;</span>
	
	<span class="c">&lt;!-- 4、配置事务控制（配置事务管理器，让他控制住数据源里面的连接的关闭和提交） --&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;tm&#34;</span> <span class="na">class=</span><span class="s">&#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;ds&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="c">&lt;!-- 5、基于xml配置，配置事务（哪些方法切入事务，还要写切入点表达式） --&gt;</span>
	<span class="nt">&lt;aop:config&gt;</span>
		<span class="c">&lt;!-- 配置切入点表达式 --&gt;</span>
		<span class="nt">&lt;aop:pointcut</span> <span class="na">expression=</span><span class="s">&#34;execution(* com.lql.service.*.*(..))&#34;</span> <span class="na">id=</span><span class="s">&#34;txPoint&#34;</span><span class="nt">/&gt;</span>
		<span class="nt">&lt;aop:advisor</span> <span class="na">advice-ref=</span><span class="s">&#34;myTx&#34;</span> <span class="na">pointcut-ref=</span><span class="s">&#34;txPoint&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/aop:config&gt;</span>
	
	<span class="c">&lt;!-- 6、配置事务增强、事务属性、事务建议
</span><span class="c">	transaction-manager=&#34;tm&#34;：指定要配置的事务管理器的id
</span><span class="c">	 --&gt;</span>
	<span class="nt">&lt;tx:advice</span> <span class="na">id=</span><span class="s">&#34;myTx&#34;</span> <span class="na">transaction-manager=</span><span class="s">&#34;tm&#34;</span><span class="nt">&gt;</span>
		<span class="c">&lt;!-- 配置事务属性 --&gt;</span>
		<span class="nt">&lt;tx:attributes&gt;</span>
			<span class="nt">&lt;tx:method</span> <span class="na">name=</span><span class="s">&#34;*&#34;</span> <span class="na">rollback-for=</span><span class="s">&#34;java.lang.Exception&#34;</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;tx:method</span> <span class="na">name=</span><span class="s">&#34;get*&#34;</span> <span class="na">read-only=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
			<span class="c">&lt;!-- &lt;tx:method name=&#34;insertEmp&#34; isolation=&#34;READ_UNCOMMITTED&#34;/&gt; --&gt;</span>
		<span class="nt">&lt;/tx:attributes&gt;</span>
	<span class="nt">&lt;/tx:advice&gt;</span>

<span class="nt">&lt;/beans&gt;</span>

</code></pre></div><hr>
<h3 id="2springmvc的配置">2.springmvc的配置</h3>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
	<span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
	<span class="na">xmlns:context=</span><span class="s">&#34;http://www.springframework.org/schema/context&#34;</span>
	<span class="na">xmlns:mvc=</span><span class="s">&#34;http://www.springframework.org/schema/mvc&#34;</span>
	<span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd
</span><span class="s">		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span class="s">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd&#34;</span><span class="nt">&gt;</span>
		
	<span class="c">&lt;!-- SpringMVC只扫描控制器;禁用默认的规则 --&gt;</span>
	<span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">&#34;com.lql&#34;</span> <span class="na">use-default-filters=</span><span class="s">&#34;false&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;context:include-filter</span> <span class="na">type=</span><span class="s">&#34;annotation&#34;</span> <span class="na">expression=</span><span class="s">&#34;org.springframework.stereotype.Controller&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/context:component-scan&gt;</span>
	
	<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;org.springframework.web.servlet.view.InternalResourceViewResolver&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;prefix&#34;</span> <span class="na">value=</span><span class="s">&#34;/WEB-INF/pages&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;suffix&#34;</span> <span class="na">value=</span><span class="s">&#34;.jsp&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="c">&lt;!-- 配置文件上传解析器 --&gt;</span>
	<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;multipartResolver&#34;</span> <span class="na">class=</span><span class="s">&#34;org.springframework.web.multipart.commons.CommonsMultipartResolver&#34;</span><span class="nt">&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;defaultEncoding&#34;</span> <span class="na">value=</span><span class="s">&#34;utf-8&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
		<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;maxUploadSize&#34;</span> <span class="na">value=</span><span class="s">&#34;#{1024*1024*20}&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
	<span class="nt">&lt;/bean&gt;</span>
	
	<span class="c">&lt;!-- 扫描静态资源 --&gt;</span>
	<span class="nt">&lt;mvc:default-servlet-handler/&gt;</span>
	<span class="c">&lt;!-- 扫描动态资源 --&gt;</span>
	<span class="nt">&lt;mvc:annotation-driven&gt;&lt;/mvc:annotation-driven&gt;</span>
<span class="nt">&lt;/beans&gt;</span>

</code></pre></div><hr>
<h3 id="3mybatis的配置">3.mybatis的配置</h3>
<ul>
<li><a href="#1.spring%E7%9A%84%E9%85%8D%E7%BD%AE">整合的关键配置</a></li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 2、配置JdbcTemplate操作数据库（pass） --&gt;</span>
<span class="c">&lt;!-- 3、配置使用mybatis操作数据库 --&gt;</span>
<span class="c">&lt;!-- 可以根据配置文件得到SqlSessionFactory --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;sqlSessionFactoryBean&#34;</span> <span class="na">class=</span><span class="s">&#34;org.mybatis.spring.SqlSessionFactoryBean&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- 指定配置文件位置 --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;configLocation&#34;</span> <span class="na">value=</span><span class="s">&#34;classpath:mybatis/mybatis-config.xml&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;dataSource&#34;</span> <span class="na">ref=</span><span class="s">&#34;ds&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
    <span class="c">&lt;!-- 指定xml映射文件的位置 --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;mapperLocations&#34;</span> <span class="na">value=</span><span class="s">&#34;classpath:mybatis/mapper/*.xml&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
<span class="c">&lt;!-- 我们要把每一个dao接口的实现加入到ioc容器 --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;org.mybatis.spring.mapper.MapperScannerConfigurer&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- 指定dao接口所在的包 --&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;basePackage&#34;</span> <span class="na">value=</span><span class="s">&#34;com.lql.dao&#34;</span><span class="nt">&gt;&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div><h4 id="mybatis-configxml">mybatis-config.xml</h4>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

	<span class="nt">&lt;settings&gt;</span>
		<span class="c">&lt;!-- 开启延迟加载开关 --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;lazyLoadingEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
		<span class="c">&lt;!-- 开启属性按需加载(默认开启) --&gt;</span>
		<span class="c">&lt;!-- &lt;setting name=&#34;aggressiveLazyLoading&#34; value=&#34;false&#34;/&gt; --&gt;</span>
		<span class="c">&lt;!-- 开启全局缓存开关(默认开启) --&gt;</span>
		<span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/settings&gt;</span>
	
    <span class="c">&lt;!-- 配置分页插件 --&gt;</span>
	<span class="nt">&lt;plugins&gt;</span>
		<span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">&#34;com.github.pagehelper.PageInterceptor&#34;</span><span class="nt">&gt;&lt;/plugin&gt;</span>
	<span class="nt">&lt;/plugins&gt;</span>
  
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></div><hr>
<hr>
<h2 id="3测试分页功能">3、测试（分页功能）</h2>
<h3 id="1controller">1.controller</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.controller</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.github.pagehelper.PageHelper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.github.pagehelper.PageInfo</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.bean.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.lql.service.TeacherService</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TeacherController</span> <span class="o">{</span>

	<span class="nd">@Autowired</span>
	<span class="n">TeacherService</span> <span class="n">teacherService</span><span class="o">;</span>
	
	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/getTea&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getTeacher</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">&#34;id&#34;</span><span class="o">,</span><span class="n">defaultValue</span><span class="o">=</span><span class="s">&#34;1&#34;</span><span class="o">)</span><span class="n">Integer</span> <span class="n">id</span><span class="o">,</span><span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
		<span class="n">Teacher</span> <span class="n">t</span> <span class="o">=</span> <span class="n">teacherService</span><span class="o">.</span><span class="na">getTeacher</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
		<span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;teacher&#34;</span><span class="o">,</span> <span class="n">t</span><span class="o">);</span>
		<span class="k">return</span> <span class="s">&#34;success&#34;</span><span class="o">;</span>
	<span class="o">}</span>
	
	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/getAll&#34;</span><span class="o">)</span>
	<span class="kd">public</span> <span class="n">String</span> <span class="nf">getAll</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">&#34;pn&#34;</span><span class="o">,</span><span class="n">defaultValue</span><span class="o">=</span><span class="s">&#34;1&#34;</span><span class="o">)</span><span class="n">Integer</span> <span class="n">pn</span><span class="o">,</span><span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
		<span class="c1">//紧跟他的查询就是一个分页查询
</span><span class="c1"></span>		<span class="n">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="n">pn</span><span class="o">,</span> <span class="n">5</span><span class="o">);</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">teacherService</span><span class="o">.</span><span class="na">getAll</span><span class="o">();</span>
		
		<span class="c1">//将查询的结果放在pageinfo中这个pageInfo就有非常多能够用的
</span><span class="c1"></span>		<span class="c1">//第二份传入连续要显示的页码
</span><span class="c1"></span>		<span class="n">PageInfo</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="n">pageInfo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PageInfo</span><span class="o">&lt;&gt;(</span><span class="n">list</span><span class="o">,</span><span class="n">6</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;当前页码：&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPageNum</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;总页码：&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPages</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;总记录数：&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getTotal</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;当前页有几条记录：&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getSize</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;当前页的pageSize：&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPageSize</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;前一页：&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPrePage</span><span class="o">());</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;结果：&#34;</span><span class="o">+</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getList</span><span class="o">());</span><span class="c1">//查询结果
</span><span class="c1"></span>		<span class="kt">int</span><span class="o">[]</span> <span class="n">nums</span> <span class="o">=</span> <span class="n">pageInfo</span><span class="o">.</span><span class="na">getNavigatepageNums</span><span class="o">();</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">nums</span><span class="o">);</span>
		<span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&#34;pageInfo&#34;</span><span class="o">,</span><span class="n">pageInfo</span><span class="o">);</span>
		<span class="k">return</span> <span class="s">&#34;success&#34;</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div><hr>
<h3 id="2successjsp">2.success.jsp</h3>
<pre><code class="language-jsp" data-lang="jsp">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;
    pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%@taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;成功！&lt;/h1&gt;
${teacher }
&lt;table cellpadding=&quot;5&quot; cellspacing=&quot;0&quot; border=&quot;1&quot;&gt;
	&lt;tr&gt;
		&lt;th&gt;id&lt;/th&gt;
		&lt;th&gt;name&lt;/th&gt;
		&lt;th&gt;course&lt;/th&gt;
		&lt;th&gt;address&lt;/th&gt;
	&lt;/tr&gt;
	&lt;c:forEach items=&quot;${pageInfo.list}&quot; var=&quot;tea&quot;&gt;
		&lt;tr&gt;
			&lt;td&gt;${tea.id}&lt;/td&gt;
			&lt;td&gt;${tea.name}&lt;/td&gt;
			&lt;td&gt;${tea.course}&lt;/td&gt;
			&lt;td&gt;新城区&lt;/td&gt;
		&lt;/tr&gt;
	&lt;/c:forEach&gt;
	&lt;tr&gt;
		&lt;td colspan=&quot;4&quot;&gt;
			&lt;a href=&quot;getAll?pn=1&quot;&gt;首页&lt;/a&gt;&lt;a href=&quot;getAll?pn=${pageInfo.prePage }&quot;&gt;上一页&lt;/a&gt;  
			
			&lt;c:forEach items=&quot;${pageInfo.navigatepageNums}&quot; var=&quot;num&quot;&gt;
				&lt;c:if test=&quot;${num == pageInfo.pageNum}&quot;&gt;
					【${num}】
				&lt;/c:if&gt;
				
				&lt;c:if test=&quot;${num != pageInfo.pageNum}&quot;&gt;
					&lt;a href=&quot;getAll?pn=${num}&quot;&gt;${num}&lt;/a&gt;
				&lt;/c:if&gt;
				
				
			&lt;/c:forEach&gt;
			
			&lt;a href=&quot;getAll?pn=${pageInfo.nextPage}&quot;&gt;下一页&lt;/a&gt;&lt;a href=&quot;getAll?pn=${pageInfo.pages}&quot;&gt;末页&lt;/a&gt;
		&lt;/td&gt;
	&lt;/tr&gt;
&lt;/table&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><hr>
<h2 id="4工程结构">4、工程结构：</h2>
<p><img src="https://i.loli.net/2020/12/21/WE1bhfmy5GInYp7.png" alt="image-20201221134106225"></p>
<hr>
<h1 id="八mbg">八、MBG</h1>
<ul>
<li><strong>MyBatis Generator</strong>（代码生成器）</li>
<li><strong>MyBatis</strong>官方提供</li>
<li>帮我们逆向生成</li>
</ul>
<h2 id="1正向">1、正向</h2>
<ul>
<li>table&mdash;》JavaBean&mdash;-》BookDao&mdash;-》dao.xml&mdash;-》xxx</li>
</ul>
<h2 id="2逆向工程">2、逆向工程</h2>
<ul>
<li>根据数据表table，逆向分析数据表，自动生成 JavaBean&mdash;-》BookDao&mdash;-》dao.xml&mdash;-》xxx</li>
</ul>
<hr>
<h2 id="3配置步骤">3、配置步骤</h2>
<h3 id="1导包-2">1.导包</h3>
<ul>
<li>mbg的核心包</li>
</ul>
<blockquote>
<p>mybatis-generator-core-1.4.0.jar</p>
<hr>
</blockquote>
<h3 id="2配置">2.配置</h3>
<ul>
<li>新建<strong>xml</strong>配置文件</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="cp">&lt;!DOCTYPE generatorConfiguration
</span><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&#34;
</span><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&#34;&gt;</span>

<span class="nt">&lt;generatorConfiguration&gt;</span>

  <span class="c">&lt;!-- MyBatis3Simple：简单版 --&gt;</span>
  <span class="nt">&lt;context</span> <span class="na">id=</span><span class="s">&#34;DB2Tables&#34;</span> <span class="na">targetRuntime=</span><span class="s">&#34;MyBatis3&#34;</span><span class="nt">&gt;</span>
 	 <span class="c">&lt;!-- jdbcConnection：指导连接到哪个数据库 --&gt;</span>
    <span class="nt">&lt;jdbcConnection</span> <span class="na">driverClass=</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span>
        <span class="na">connectionURL=</span><span class="s">&#34;jdbc:mysql://localhost:3306/test?serverTimezone=UTC&#34;</span>
        <span class="na">userId=</span><span class="s">&#34;root&#34;</span>
        <span class="na">password=</span><span class="s">&#34;123456&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/jdbcConnection&gt;</span>

    <span class="nt">&lt;javaTypeResolver</span> <span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;forceBigDecimals&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/javaTypeResolver&gt;</span>
	
	<span class="c">&lt;!-- javaModelGenerator：生成pojo
</span><span class="c">	targetPackage：生成的pojo放在哪个包
</span><span class="c">	targetProject：放在哪个工程下
</span><span class="c">	 --&gt;</span>
    <span class="nt">&lt;javaModelGenerator</span> <span class="na">targetPackage=</span><span class="s">&#34;com.lql.bean&#34;</span> <span class="na">targetProject=</span><span class="s">&#34;.\src&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;trimStrings&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/javaModelGenerator&gt;</span>
	
	<span class="c">&lt;!-- sqlMapGenerator：sql映射文件生成器（指定xml生成的地方） --&gt;</span>
    <span class="nt">&lt;sqlMapGenerator</span> <span class="na">targetPackage=</span><span class="s">&#34;com.lql.dao&#34;</span>  <span class="na">targetProject=</span><span class="s">&#34;.\conf&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/sqlMapGenerator&gt;</span>
	
	<span class="c">&lt;!-- javaClientGenerator：生成dao接口 --&gt;</span>
    <span class="nt">&lt;javaClientGenerator</span> <span class="na">type=</span><span class="s">&#34;XMLMAPPER&#34;</span> <span class="na">targetPackage=</span><span class="s">&#34;com.lql.dao&#34;</span>  <span class="na">targetProject=</span><span class="s">&#34;.\src&#34;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/javaClientGenerator&gt;</span>
	
	<span class="c">&lt;!-- table：指定要逆向生成哪个数据表
</span><span class="c">	tableName=&#34;t_cat&#34;：表名
</span><span class="c">	domainObjectName=&#34;Cat&#34;：这个表对应的对象名
</span><span class="c">	 --&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;t_cat&#34;</span> <span class="na">domainObjectName=</span><span class="s">&#34;Cat&#34;</span> <span class="nt">&gt;&lt;/table&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;employee&#34;</span> <span class="na">domainObjectName=</span><span class="s">&#34;Employee&#34;</span> <span class="nt">&gt;&lt;/table&gt;</span>
    <span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;t_teacher&#34;</span> <span class="na">domainObjectName=</span><span class="s">&#34;Teacher&#34;</span> <span class="nt">&gt;&lt;/table&gt;</span>

  <span class="nt">&lt;/context&gt;</span>
<span class="nt">&lt;/generatorConfiguration&gt;</span>
</code></pre></div><h3 id="3mbg生成代码">3.mbg生成代码</h3>
<div class="highlight"><pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.lql.test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.mybatis.generator.api.MyBatisGenerator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mybatis.generator.config.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mybatis.generator.config.xml.ConfigurationParser</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mybatis.generator.exception.XMLParserException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.mybatis.generator.internal.DefaultShellCallback</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MBGTest</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">warnings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
		<span class="kt">boolean</span> <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
		<span class="n">File</span> <span class="n">configFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&#34;mbg.xml&#34;</span><span class="o">);</span>
		<span class="n">ConfigurationParser</span> <span class="n">cp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConfigurationParser</span><span class="o">(</span><span class="n">warnings</span><span class="o">);</span>
		<span class="n">Configuration</span> <span class="n">config</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="na">parseConfiguration</span><span class="o">(</span><span class="n">configFile</span><span class="o">);</span>
		<span class="n">DefaultShellCallback</span> <span class="n">callback</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultShellCallback</span><span class="o">(</span><span class="n">overwrite</span><span class="o">);</span>
		<span class="n">MyBatisGenerator</span> <span class="n">myBatisGenerator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyBatisGenerator</span><span class="o">(</span><span class="n">config</span><span class="o">,</span> <span class="n">callback</span><span class="o">,</span> <span class="n">warnings</span><span class="o">);</span>
		<span class="c1">//代码生成
</span><span class="c1"></span>		<span class="n">myBatisGenerator</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;生成🆗了！&#34;</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div><hr>
<hr>
<h1 id="注与mybatis相关的配置jar包官方文档等都可以到githubhttpsgithubcommybatis中查找"><strong>==注：与mybatis相关的配置jar包，官方文档等都可以到<a href="https://github.com/mybatis/">GitHub</a>中查找==</strong></h1>

    
	</div>
  <footer class="article-footer clearfix">
  

<div class="article-tags">
  <span></span>
  
  <a href="https://qianlong98.github.io/tags/mybatis">MyBatis</a>
  
  <a href="https://qianlong98.github.io/tags/%E7%AC%94%E8%AE%B0">笔记</a>
  
</div>





<div class="article-categories">
  <span></span>
  
  <a class="article-category-link" href="https://qianlong98.github.io/categories/%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0">个人学习笔记</a>
  
</div>



  <div class="article-share" id="share">
    <div data-url="https://qianlong98.github.io/post/mybatis%E5%AD%A6%E4%B9%A0/" data-title="MyBatis学习" data-tsina="1816308191" class="share clearfix">
    </div>
  </div>
</footer>

	</article>
  


<section class="comment">
<div id="disqus_thread"></div>
</section>
<script>
  
  var xhr = new XMLHttpRequest();
  xhr.open('GET', '//disqus.com/next/config.json?' + new Date().getTime(), true);
  xhr.timeout = 3000; 

  xhr.onload = function() { 


var disqus_config = function () {
this.page.url = "https:\/\/qianlong98.github.io\/post\/mybatis%E5%AD%A6%E4%B9%A0\/"
this.page.identifier = "https:\/\/qianlong98.github.io\/post\/mybatis%E5%AD%A6%E4%B9%A0\/"
};
(function() { 
var d = document, s = d.createElement('script');

s.src = '//qianlong98.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
}
  xhr.ontimeout = function() {
  
  return;
}
xhr.send(null);
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</div>

    <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>
<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">
  

<div class="categorieslist">
  <p class="asidetitle">分类</p>
  <ul>
    
    <li><a href="https://qianlong98.github.io/categories/%e4%b8%aa%e4%ba%ba%e5%ad%a6%e4%b9%a0%e7%ac%94%e8%ae%b0" title="个人学习笔记">个人学习笔记<sup>7</sup></a></li>
    
    <li><a href="https://qianlong98.github.io/categories/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0-%e5%8e%9f%e5%88%9b" title="技术文章-原创">技术文章-原创<sup>1</sup></a></li>
    
    <li><a href="https://qianlong98.github.io/categories/%e6%8a%80%e6%9c%af%e6%96%87%e7%ab%a0-%e8%bd%ac%e8%bd%bd" title="技术文章-转载">技术文章-转载<sup>2</sup></a></li>
    
  </ul>
</div>



  

<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
      
			<li><a href="https://qianlong98.github.io/tags/blog" title="blog">blog<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/git" title="git">git<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/hibernate" title="hibernate">hibernate<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/javascript" title="javascript">javascript<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/maven" title="maven">maven<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/mybatis" title="mybatis">mybatis<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/mysql" title="mysql">mysql<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/spring" title="spring">spring<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/spring-boot" title="spring-boot">spring-boot<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/spring-mvc" title="spring-mvc">spring-mvc<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/web" title="web">web<sup>1</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/%e6%95%b0%e6%8d%ae%e5%ba%93" title="数据库">数据库<sup>2</sup></a></li>
      
			<li><a href="https://qianlong98.github.io/tags/%e7%ac%94%e8%ae%b0" title="笔记">笔记<sup>5</sup></a></li>
      
		</ul>
</div>



  
  <div class="archiveslist">
    <p class="asidetitle">归档</p>
    <ul class="archive-list">
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://qianlong98.github.io/post/#2020-12">2020年12月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://qianlong98.github.io/post/#2020-11">2020年11月</a><span class="archive-list-count">5</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://qianlong98.github.io/post/#2020-10">2020年10月</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="https://qianlong98.github.io/post/#2020-09">2020年09月</a><span class="archive-list-count">2</span>
      </li>
      
    </ul>

  </div>


  

<div class="tagcloudlist">
  <p class="asidetitle">标签云</p>
  <div class="tagcloudlist clearfix">
    
    <a href="https://qianlong98.github.io/tags/blog" style="font-size: 12px;">blog</a>
    
    <a href="https://qianlong98.github.io/tags/git" style="font-size: 12px;">git</a>
    
    <a href="https://qianlong98.github.io/tags/hibernate" style="font-size: 12px;">hibernate</a>
    
    <a href="https://qianlong98.github.io/tags/javascript" style="font-size: 12px;">javascript</a>
    
    <a href="https://qianlong98.github.io/tags/maven" style="font-size: 12px;">maven</a>
    
    <a href="https://qianlong98.github.io/tags/mybatis" style="font-size: 12px;">mybatis</a>
    
    <a href="https://qianlong98.github.io/tags/mysql" style="font-size: 12px;">mysql</a>
    
    <a href="https://qianlong98.github.io/tags/spring" style="font-size: 12px;">spring</a>
    
    <a href="https://qianlong98.github.io/tags/spring-boot" style="font-size: 12px;">spring-boot</a>
    
    <a href="https://qianlong98.github.io/tags/spring-mvc" style="font-size: 12px;">spring-mvc</a>
    
    <a href="https://qianlong98.github.io/tags/web" style="font-size: 12px;">web</a>
    
    <a href="https://qianlong98.github.io/tags/%e6%95%b0%e6%8d%ae%e5%ba%93" style="font-size: 12px;">数据库</a>
    
    <a href="https://qianlong98.github.io/tags/%e7%ac%94%e8%ae%b0" style="font-size: 12px;">笔记</a>
    
  </div>
</div>



  

</aside>
</div>

  </div>
  <footer><div id="footer" >
  <div class="line">
    <span></span>
    
    <div style='background:no-repeat url("https://qianlong98.github.io/img/author.jpg") left top;-webkit-background-size:6.875em 6.875em;-moz-background-size:6.875em 6.875em;background-size:6.875em 6.875em;' class="author" ></div>
  </div>
  <section class="info">
    <p>不要再甘于平庸 <br/> 做人上人要有野心</p>
  </section>
  <div class="social-font clearfix">
    <a href='http://weibo.com/qianlong98' target="_blank" title="weibo"></a>
    
    <a href='https://github.com/qianlong98' target="_blank" title="github"></a>
    
  
  </div>
  <p class="copyright">Powered by <a href="http://gohugo.io" target="_blank" title="hugo">hugo</a> and Name by <a href="https://weibo.com/u/6969049127?refer_flag=1005050005_&is_all=1" target="_blank" title="花生帆">花生帆小姐姐</a> © 2021
    
    <a href="https://qianlong98.github.io/" title="代码L">代码L</a>
    
  </p>
</div>

</footer>
  <script src="https://qianlong98.github.io/js/jquery-2.1.0.min.js"></script>

<script src="https://qianlong98.github.io/js/qrcode.js"></script>
<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:https:\/\/qianlong98.github.io\/ ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="https://b.bshare.cn/barCode?site=weixin&url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});
</script>


<link rel="stylesheet" href="https://qianlong98.github.io/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="https://qianlong98.github.io/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>




</body>
</html>
